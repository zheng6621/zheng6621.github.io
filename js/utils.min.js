/*! For license information please see utils.min.js.LICENSE.txt */
var utils;utils=(()=>{var t={742:(t,e)=>{"use strict";e.byteLength=function(t){var e=l(t),r=e[0],n=e[1];return 3*(r+n)/4-n},e.toByteArray=function(t){var e,r,s=l(t),i=s[0],o=s[1],f=new a(function(t,e,r){return 3*(e+r)/4-r}(0,i,o)),_=0,u=o>0?i-4:i;for(r=0;r<u;r+=4)e=n[t.charCodeAt(r)]<<18|n[t.charCodeAt(r+1)]<<12|n[t.charCodeAt(r+2)]<<6|n[t.charCodeAt(r+3)],f[_++]=e>>16&255,f[_++]=e>>8&255,f[_++]=255&e;return 2===o&&(e=n[t.charCodeAt(r)]<<2|n[t.charCodeAt(r+1)]>>4,f[_++]=255&e),1===o&&(e=n[t.charCodeAt(r)]<<10|n[t.charCodeAt(r+1)]<<4|n[t.charCodeAt(r+2)]>>2,f[_++]=e>>8&255,f[_++]=255&e),f},e.fromByteArray=function(t){for(var e,n=t.length,a=n%3,s=[],i=16383,o=0,l=n-a;o<l;o+=i)s.push(f(t,o,o+i>l?l:o+i));return 1===a?(e=t[n-1],s.push(r[e>>2]+r[e<<4&63]+"==")):2===a&&(e=(t[n-2]<<8)+t[n-1],s.push(r[e>>10]+r[e>>4&63]+r[e<<2&63]+"=")),s.join("")};for(var r=[],n=[],a="undefined"!=typeof Uint8Array?Uint8Array:Array,s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",i=0,o=s.length;i<o;++i)r[i]=s[i],n[s.charCodeAt(i)]=i;function l(t){var e=t.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var r=t.indexOf("=");return-1===r&&(r=e),[r,r===e?0:4-r%4]}function f(t,e,n){for(var a,s,i=[],o=e;o<n;o+=3)a=(t[o]<<16&16711680)+(t[o+1]<<8&65280)+(255&t[o+2]),i.push(r[(s=a)>>18&63]+r[s>>12&63]+r[s>>6&63]+r[63&s]);return i.join("")}n["-".charCodeAt(0)]=62,n["_".charCodeAt(0)]=63},764:(t,e,r)=>{"use strict";var n=r(742),a=r(645),s="function"==typeof Symbol&&"function"==typeof Symbol.for?Symbol.for("nodejs.util.inspect.custom"):null;e.lW=l,e.h2=50;var i=2147483647;function o(t){if(t>i)throw new RangeError('The value "'+t+'" is invalid for option "size"');var e=new Uint8Array(t);return Object.setPrototypeOf(e,l.prototype),e}function l(t,e,r){if("number"==typeof t){if("string"==typeof e)throw new TypeError('The "string" argument must be of type string. Received type number');return u(t)}return f(t,e,r)}function f(t,e,r){if("string"==typeof t)return function(t,e){if("string"==typeof e&&""!==e||(e="utf8"),!l.isEncoding(e))throw new TypeError("Unknown encoding: "+e);var r=0|m(t,e),n=o(r),a=n.write(t,e);return a!==r&&(n=n.slice(0,a)),n}(t,e);if(ArrayBuffer.isView(t))return function(t){if(U(t,Uint8Array)){var e=new Uint8Array(t);return c(e.buffer,e.byteOffset,e.byteLength)}return h(t)}(t);if(null==t)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof t);if(U(t,ArrayBuffer)||t&&U(t.buffer,ArrayBuffer))return c(t,e,r);if("undefined"!=typeof SharedArrayBuffer&&(U(t,SharedArrayBuffer)||t&&U(t.buffer,SharedArrayBuffer)))return c(t,e,r);if("number"==typeof t)throw new TypeError('The "value" argument must not be of type number. Received type number');var n=t.valueOf&&t.valueOf();if(null!=n&&n!==t)return l.from(n,e,r);var a=function(t){if(l.isBuffer(t)){var e=0|p(t.length),r=o(e);return 0===r.length||t.copy(r,0,0,e),r}return void 0!==t.length?"number"!=typeof t.length||F(t.length)?o(0):h(t):"Buffer"===t.type&&Array.isArray(t.data)?h(t.data):void 0}(t);if(a)return a;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof t[Symbol.toPrimitive])return l.from(t[Symbol.toPrimitive]("string"),e,r);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof t)}function _(t){if("number"!=typeof t)throw new TypeError('"size" argument must be of type number');if(t<0)throw new RangeError('The value "'+t+'" is invalid for option "size"')}function u(t){return _(t),o(t<0?0:0|p(t))}function h(t){for(var e=t.length<0?0:0|p(t.length),r=o(e),n=0;n<e;n+=1)r[n]=255&t[n];return r}function c(t,e,r){if(e<0||t.byteLength<e)throw new RangeError('"offset" is outside of buffer bounds');if(t.byteLength<e+(r||0))throw new RangeError('"length" is outside of buffer bounds');var n;return n=void 0===e&&void 0===r?new Uint8Array(t):void 0===r?new Uint8Array(t,e):new Uint8Array(t,e,r),Object.setPrototypeOf(n,l.prototype),n}function p(t){if(t>=i)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+i.toString(16)+" bytes");return 0|t}function m(t,e){if(l.isBuffer(t))return t.length;if(ArrayBuffer.isView(t)||U(t,ArrayBuffer))return t.byteLength;if("string"!=typeof t)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof t);var r=t.length,n=arguments.length>2&&!0===arguments[2];if(!n&&0===r)return 0;for(var a=!1;;)switch(e){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":return V(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*r;case"hex":return r>>>1;case"base64":return D(t).length;default:if(a)return n?-1:V(t).length;e=(""+e).toLowerCase(),a=!0}}function b(t,e,r){var n=!1;if((void 0===e||e<0)&&(e=0),e>this.length)return"";if((void 0===r||r>this.length)&&(r=this.length),r<=0)return"";if((r>>>=0)<=(e>>>=0))return"";for(t||(t="utf8");;)switch(t){case"hex":return k(this,e,r);case"utf8":case"utf-8":return R(this,e,r);case"ascii":return T(this,e,r);case"latin1":case"binary":return x(this,e,r);case"base64":return M(this,e,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return P(this,e,r);default:if(n)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),n=!0}}function d(t,e,r){var n=t[e];t[e]=t[r],t[r]=n}function v(t,e,r,n,a){if(0===t.length)return-1;if("string"==typeof r?(n=r,r=0):r>2147483647?r=2147483647:r<-2147483648&&(r=-2147483648),F(r=+r)&&(r=a?0:t.length-1),r<0&&(r=t.length+r),r>=t.length){if(a)return-1;r=t.length-1}else if(r<0){if(!a)return-1;r=0}if("string"==typeof e&&(e=l.from(e,n)),l.isBuffer(e))return 0===e.length?-1:g(t,e,r,n,a);if("number"==typeof e)return e&=255,"function"==typeof Uint8Array.prototype.indexOf?a?Uint8Array.prototype.indexOf.call(t,e,r):Uint8Array.prototype.lastIndexOf.call(t,e,r):g(t,[e],r,n,a);throw new TypeError("val must be string, number or Buffer")}function g(t,e,r,n,a){var s,i=1,o=t.length,l=e.length;if(void 0!==n&&("ucs2"===(n=String(n).toLowerCase())||"ucs-2"===n||"utf16le"===n||"utf-16le"===n)){if(t.length<2||e.length<2)return-1;i=2,o/=2,l/=2,r/=2}function f(t,e){return 1===i?t[e]:t.readUInt16BE(e*i)}if(a){var _=-1;for(s=r;s<o;s++)if(f(t,s)===f(e,-1===_?0:s-_)){if(-1===_&&(_=s),s-_+1===l)return _*i}else-1!==_&&(s-=s-_),_=-1}else for(r+l>o&&(r=o-l),s=r;s>=0;s--){for(var u=!0,h=0;h<l;h++)if(f(t,s+h)!==f(e,h)){u=!1;break}if(u)return s}return-1}function w(t,e,r,n){r=Number(r)||0;var a=t.length-r;n?(n=Number(n))>a&&(n=a):n=a;var s=e.length;n>s/2&&(n=s/2);for(var i=0;i<n;++i){var o=parseInt(e.substr(2*i,2),16);if(F(o))return i;t[r+i]=o}return i}function y(t,e,r,n){return Y(V(e,t.length-r),t,r,n)}function S(t,e,r,n){return Y(function(t){for(var e=[],r=0;r<t.length;++r)e.push(255&t.charCodeAt(r));return e}(e),t,r,n)}function A(t,e,r,n){return Y(D(e),t,r,n)}function B(t,e,r,n){return Y(function(t,e){for(var r,n,a,s=[],i=0;i<t.length&&!((e-=2)<0);++i)n=(r=t.charCodeAt(i))>>8,a=r%256,s.push(a),s.push(n);return s}(e,t.length-r),t,r,n)}function M(t,e,r){return 0===e&&r===t.length?n.fromByteArray(t):n.fromByteArray(t.slice(e,r))}function R(t,e,r){r=Math.min(t.length,r);for(var n=[],a=e;a<r;){var s,i,o,l,f=t[a],_=null,u=f>239?4:f>223?3:f>191?2:1;if(a+u<=r)switch(u){case 1:f<128&&(_=f);break;case 2:128==(192&(s=t[a+1]))&&(l=(31&f)<<6|63&s)>127&&(_=l);break;case 3:s=t[a+1],i=t[a+2],128==(192&s)&&128==(192&i)&&(l=(15&f)<<12|(63&s)<<6|63&i)>2047&&(l<55296||l>57343)&&(_=l);break;case 4:s=t[a+1],i=t[a+2],o=t[a+3],128==(192&s)&&128==(192&i)&&128==(192&o)&&(l=(15&f)<<18|(63&s)<<12|(63&i)<<6|63&o)>65535&&l<1114112&&(_=l)}null===_?(_=65533,u=1):_>65535&&(_-=65536,n.push(_>>>10&1023|55296),_=56320|1023&_),n.push(_),a+=u}return function(t){var e=t.length;if(e<=E)return String.fromCharCode.apply(String,t);for(var r="",n=0;n<e;)r+=String.fromCharCode.apply(String,t.slice(n,n+=E));return r}(n)}l.TYPED_ARRAY_SUPPORT=function(){try{var t=new Uint8Array(1),e={foo:function(){return 42}};return Object.setPrototypeOf(e,Uint8Array.prototype),Object.setPrototypeOf(t,e),42===t.foo()}catch(t){return!1}}(),l.TYPED_ARRAY_SUPPORT||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(l.prototype,"parent",{enumerable:!0,get:function(){if(l.isBuffer(this))return this.buffer}}),Object.defineProperty(l.prototype,"offset",{enumerable:!0,get:function(){if(l.isBuffer(this))return this.byteOffset}}),l.poolSize=8192,l.from=function(t,e,r){return f(t,e,r)},Object.setPrototypeOf(l.prototype,Uint8Array.prototype),Object.setPrototypeOf(l,Uint8Array),l.alloc=function(t,e,r){return function(t,e,r){return _(t),t<=0?o(t):void 0!==e?"string"==typeof r?o(t).fill(e,r):o(t).fill(e):o(t)}(t,e,r)},l.allocUnsafe=function(t){return u(t)},l.allocUnsafeSlow=function(t){return u(t)},l.isBuffer=function(t){return null!=t&&!0===t._isBuffer&&t!==l.prototype},l.compare=function(t,e){if(U(t,Uint8Array)&&(t=l.from(t,t.offset,t.byteLength)),U(e,Uint8Array)&&(e=l.from(e,e.offset,e.byteLength)),!l.isBuffer(t)||!l.isBuffer(e))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(t===e)return 0;for(var r=t.length,n=e.length,a=0,s=Math.min(r,n);a<s;++a)if(t[a]!==e[a]){r=t[a],n=e[a];break}return r<n?-1:n<r?1:0},l.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},l.concat=function(t,e){if(!Array.isArray(t))throw new TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return l.alloc(0);var r;if(void 0===e)for(e=0,r=0;r<t.length;++r)e+=t[r].length;var n=l.allocUnsafe(e),a=0;for(r=0;r<t.length;++r){var s=t[r];if(U(s,Uint8Array))a+s.length>n.length?l.from(s).copy(n,a):Uint8Array.prototype.set.call(n,s,a);else{if(!l.isBuffer(s))throw new TypeError('"list" argument must be an Array of Buffers');s.copy(n,a)}a+=s.length}return n},l.byteLength=m,l.prototype._isBuffer=!0,l.prototype.swap16=function(){var t=this.length;if(t%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var e=0;e<t;e+=2)d(this,e,e+1);return this},l.prototype.swap32=function(){var t=this.length;if(t%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var e=0;e<t;e+=4)d(this,e,e+3),d(this,e+1,e+2);return this},l.prototype.swap64=function(){var t=this.length;if(t%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var e=0;e<t;e+=8)d(this,e,e+7),d(this,e+1,e+6),d(this,e+2,e+5),d(this,e+3,e+4);return this},l.prototype.toString=function(){var t=this.length;return 0===t?"":0===arguments.length?R(this,0,t):b.apply(this,arguments)},l.prototype.toLocaleString=l.prototype.toString,l.prototype.equals=function(t){if(!l.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t||0===l.compare(this,t)},l.prototype.inspect=function(){var t="",r=e.h2;return t=this.toString("hex",0,r).replace(/(.{2})/g,"$1 ").trim(),this.length>r&&(t+=" ... "),"<Buffer "+t+">"},s&&(l.prototype[s]=l.prototype.inspect),l.prototype.compare=function(t,e,r,n,a){if(U(t,Uint8Array)&&(t=l.from(t,t.offset,t.byteLength)),!l.isBuffer(t))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof t);if(void 0===e&&(e=0),void 0===r&&(r=t?t.length:0),void 0===n&&(n=0),void 0===a&&(a=this.length),e<0||r>t.length||n<0||a>this.length)throw new RangeError("out of range index");if(n>=a&&e>=r)return 0;if(n>=a)return-1;if(e>=r)return 1;if(this===t)return 0;for(var s=(a>>>=0)-(n>>>=0),i=(r>>>=0)-(e>>>=0),o=Math.min(s,i),f=this.slice(n,a),_=t.slice(e,r),u=0;u<o;++u)if(f[u]!==_[u]){s=f[u],i=_[u];break}return s<i?-1:i<s?1:0},l.prototype.includes=function(t,e,r){return-1!==this.indexOf(t,e,r)},l.prototype.indexOf=function(t,e,r){return v(this,t,e,r,!0)},l.prototype.lastIndexOf=function(t,e,r){return v(this,t,e,r,!1)},l.prototype.write=function(t,e,r,n){if(void 0===e)n="utf8",r=this.length,e=0;else if(void 0===r&&"string"==typeof e)n=e,r=this.length,e=0;else{if(!isFinite(e))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");e>>>=0,isFinite(r)?(r>>>=0,void 0===n&&(n="utf8")):(n=r,r=void 0)}var a=this.length-e;if((void 0===r||r>a)&&(r=a),t.length>0&&(r<0||e<0)||e>this.length)throw new RangeError("Attempt to write outside buffer bounds");n||(n="utf8");for(var s=!1;;)switch(n){case"hex":return w(this,t,e,r);case"utf8":case"utf-8":return y(this,t,e,r);case"ascii":case"latin1":case"binary":return S(this,t,e,r);case"base64":return A(this,t,e,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return B(this,t,e,r);default:if(s)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),s=!0}},l.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var E=4096;function T(t,e,r){var n="";r=Math.min(t.length,r);for(var a=e;a<r;++a)n+=String.fromCharCode(127&t[a]);return n}function x(t,e,r){var n="";r=Math.min(t.length,r);for(var a=e;a<r;++a)n+=String.fromCharCode(t[a]);return n}function k(t,e,r){var n=t.length;(!e||e<0)&&(e=0),(!r||r<0||r>n)&&(r=n);for(var a="",s=e;s<r;++s)a+=j[t[s]];return a}function P(t,e,r){for(var n=t.slice(e,r),a="",s=0;s<n.length-1;s+=2)a+=String.fromCharCode(n[s]+256*n[s+1]);return a}function I(t,e,r){if(t%1!=0||t<0)throw new RangeError("offset is not uint");if(t+e>r)throw new RangeError("Trying to access beyond buffer length")}function L(t,e,r,n,a,s){if(!l.isBuffer(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(e>a||e<s)throw new RangeError('"value" argument is out of bounds');if(r+n>t.length)throw new RangeError("Index out of range")}function H(t,e,r,n,a,s){if(r+n>t.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("Index out of range")}function C(t,e,r,n,s){return e=+e,r>>>=0,s||H(t,0,r,4),a.write(t,e,r,n,23,4),r+4}function N(t,e,r,n,s){return e=+e,r>>>=0,s||H(t,0,r,8),a.write(t,e,r,n,52,8),r+8}l.prototype.slice=function(t,e){var r=this.length;(t=~~t)<0?(t+=r)<0&&(t=0):t>r&&(t=r),(e=void 0===e?r:~~e)<0?(e+=r)<0&&(e=0):e>r&&(e=r),e<t&&(e=t);var n=this.subarray(t,e);return Object.setPrototypeOf(n,l.prototype),n},l.prototype.readUintLE=l.prototype.readUIntLE=function(t,e,r){t>>>=0,e>>>=0,r||I(t,e,this.length);for(var n=this[t],a=1,s=0;++s<e&&(a*=256);)n+=this[t+s]*a;return n},l.prototype.readUintBE=l.prototype.readUIntBE=function(t,e,r){t>>>=0,e>>>=0,r||I(t,e,this.length);for(var n=this[t+--e],a=1;e>0&&(a*=256);)n+=this[t+--e]*a;return n},l.prototype.readUint8=l.prototype.readUInt8=function(t,e){return t>>>=0,e||I(t,1,this.length),this[t]},l.prototype.readUint16LE=l.prototype.readUInt16LE=function(t,e){return t>>>=0,e||I(t,2,this.length),this[t]|this[t+1]<<8},l.prototype.readUint16BE=l.prototype.readUInt16BE=function(t,e){return t>>>=0,e||I(t,2,this.length),this[t]<<8|this[t+1]},l.prototype.readUint32LE=l.prototype.readUInt32LE=function(t,e){return t>>>=0,e||I(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},l.prototype.readUint32BE=l.prototype.readUInt32BE=function(t,e){return t>>>=0,e||I(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},l.prototype.readIntLE=function(t,e,r){t>>>=0,e>>>=0,r||I(t,e,this.length);for(var n=this[t],a=1,s=0;++s<e&&(a*=256);)n+=this[t+s]*a;return n>=(a*=128)&&(n-=Math.pow(2,8*e)),n},l.prototype.readIntBE=function(t,e,r){t>>>=0,e>>>=0,r||I(t,e,this.length);for(var n=e,a=1,s=this[t+--n];n>0&&(a*=256);)s+=this[t+--n]*a;return s>=(a*=128)&&(s-=Math.pow(2,8*e)),s},l.prototype.readInt8=function(t,e){return t>>>=0,e||I(t,1,this.length),128&this[t]?-1*(255-this[t]+1):this[t]},l.prototype.readInt16LE=function(t,e){t>>>=0,e||I(t,2,this.length);var r=this[t]|this[t+1]<<8;return 32768&r?4294901760|r:r},l.prototype.readInt16BE=function(t,e){t>>>=0,e||I(t,2,this.length);var r=this[t+1]|this[t]<<8;return 32768&r?4294901760|r:r},l.prototype.readInt32LE=function(t,e){return t>>>=0,e||I(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},l.prototype.readInt32BE=function(t,e){return t>>>=0,e||I(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},l.prototype.readFloatLE=function(t,e){return t>>>=0,e||I(t,4,this.length),a.read(this,t,!0,23,4)},l.prototype.readFloatBE=function(t,e){return t>>>=0,e||I(t,4,this.length),a.read(this,t,!1,23,4)},l.prototype.readDoubleLE=function(t,e){return t>>>=0,e||I(t,8,this.length),a.read(this,t,!0,52,8)},l.prototype.readDoubleBE=function(t,e){return t>>>=0,e||I(t,8,this.length),a.read(this,t,!1,52,8)},l.prototype.writeUintLE=l.prototype.writeUIntLE=function(t,e,r,n){t=+t,e>>>=0,r>>>=0,n||L(this,t,e,r,Math.pow(2,8*r)-1,0);var a=1,s=0;for(this[e]=255&t;++s<r&&(a*=256);)this[e+s]=t/a&255;return e+r},l.prototype.writeUintBE=l.prototype.writeUIntBE=function(t,e,r,n){t=+t,e>>>=0,r>>>=0,n||L(this,t,e,r,Math.pow(2,8*r)-1,0);var a=r-1,s=1;for(this[e+a]=255&t;--a>=0&&(s*=256);)this[e+a]=t/s&255;return e+r},l.prototype.writeUint8=l.prototype.writeUInt8=function(t,e,r){return t=+t,e>>>=0,r||L(this,t,e,1,255,0),this[e]=255&t,e+1},l.prototype.writeUint16LE=l.prototype.writeUInt16LE=function(t,e,r){return t=+t,e>>>=0,r||L(this,t,e,2,65535,0),this[e]=255&t,this[e+1]=t>>>8,e+2},l.prototype.writeUint16BE=l.prototype.writeUInt16BE=function(t,e,r){return t=+t,e>>>=0,r||L(this,t,e,2,65535,0),this[e]=t>>>8,this[e+1]=255&t,e+2},l.prototype.writeUint32LE=l.prototype.writeUInt32LE=function(t,e,r){return t=+t,e>>>=0,r||L(this,t,e,4,4294967295,0),this[e+3]=t>>>24,this[e+2]=t>>>16,this[e+1]=t>>>8,this[e]=255&t,e+4},l.prototype.writeUint32BE=l.prototype.writeUInt32BE=function(t,e,r){return t=+t,e>>>=0,r||L(this,t,e,4,4294967295,0),this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t,e+4},l.prototype.writeIntLE=function(t,e,r,n){if(t=+t,e>>>=0,!n){var a=Math.pow(2,8*r-1);L(this,t,e,r,a-1,-a)}var s=0,i=1,o=0;for(this[e]=255&t;++s<r&&(i*=256);)t<0&&0===o&&0!==this[e+s-1]&&(o=1),this[e+s]=(t/i>>0)-o&255;return e+r},l.prototype.writeIntBE=function(t,e,r,n){if(t=+t,e>>>=0,!n){var a=Math.pow(2,8*r-1);L(this,t,e,r,a-1,-a)}var s=r-1,i=1,o=0;for(this[e+s]=255&t;--s>=0&&(i*=256);)t<0&&0===o&&0!==this[e+s+1]&&(o=1),this[e+s]=(t/i>>0)-o&255;return e+r},l.prototype.writeInt8=function(t,e,r){return t=+t,e>>>=0,r||L(this,t,e,1,127,-128),t<0&&(t=255+t+1),this[e]=255&t,e+1},l.prototype.writeInt16LE=function(t,e,r){return t=+t,e>>>=0,r||L(this,t,e,2,32767,-32768),this[e]=255&t,this[e+1]=t>>>8,e+2},l.prototype.writeInt16BE=function(t,e,r){return t=+t,e>>>=0,r||L(this,t,e,2,32767,-32768),this[e]=t>>>8,this[e+1]=255&t,e+2},l.prototype.writeInt32LE=function(t,e,r){return t=+t,e>>>=0,r||L(this,t,e,4,2147483647,-2147483648),this[e]=255&t,this[e+1]=t>>>8,this[e+2]=t>>>16,this[e+3]=t>>>24,e+4},l.prototype.writeInt32BE=function(t,e,r){return t=+t,e>>>=0,r||L(this,t,e,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t,e+4},l.prototype.writeFloatLE=function(t,e,r){return C(this,t,e,!0,r)},l.prototype.writeFloatBE=function(t,e,r){return C(this,t,e,!1,r)},l.prototype.writeDoubleLE=function(t,e,r){return N(this,t,e,!0,r)},l.prototype.writeDoubleBE=function(t,e,r){return N(this,t,e,!1,r)},l.prototype.copy=function(t,e,r,n){if(!l.isBuffer(t))throw new TypeError("argument should be a Buffer");if(r||(r=0),n||0===n||(n=this.length),e>=t.length&&(e=t.length),e||(e=0),n>0&&n<r&&(n=r),n===r)return 0;if(0===t.length||0===this.length)return 0;if(e<0)throw new RangeError("targetStart out of bounds");if(r<0||r>=this.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),t.length-e<n-r&&(n=t.length-e+r);var a=n-r;return this===t&&"function"==typeof Uint8Array.prototype.copyWithin?this.copyWithin(e,r,n):Uint8Array.prototype.set.call(t,this.subarray(r,n),e),a},l.prototype.fill=function(t,e,r,n){if("string"==typeof t){if("string"==typeof e?(n=e,e=0,r=this.length):"string"==typeof r&&(n=r,r=this.length),void 0!==n&&"string"!=typeof n)throw new TypeError("encoding must be a string");if("string"==typeof n&&!l.isEncoding(n))throw new TypeError("Unknown encoding: "+n);if(1===t.length){var a=t.charCodeAt(0);("utf8"===n&&a<128||"latin1"===n)&&(t=a)}}else"number"==typeof t?t&=255:"boolean"==typeof t&&(t=Number(t));if(e<0||this.length<e||this.length<r)throw new RangeError("Out of range index");if(r<=e)return this;var s;if(e>>>=0,r=void 0===r?this.length:r>>>0,t||(t=0),"number"==typeof t)for(s=e;s<r;++s)this[s]=t;else{var i=l.isBuffer(t)?t:l.from(t,n),o=i.length;if(0===o)throw new TypeError('The value "'+t+'" is invalid for argument "value"');for(s=0;s<r-e;++s)this[s+e]=i[s%o]}return this};var O=/[^+/0-9A-Za-z-_]/g;function V(t,e){var r;e=e||1/0;for(var n=t.length,a=null,s=[],i=0;i<n;++i){if((r=t.charCodeAt(i))>55295&&r<57344){if(!a){if(r>56319){(e-=3)>-1&&s.push(239,191,189);continue}if(i+1===n){(e-=3)>-1&&s.push(239,191,189);continue}a=r;continue}if(r<56320){(e-=3)>-1&&s.push(239,191,189),a=r;continue}r=65536+(a-55296<<10|r-56320)}else a&&(e-=3)>-1&&s.push(239,191,189);if(a=null,r<128){if((e-=1)<0)break;s.push(r)}else if(r<2048){if((e-=2)<0)break;s.push(r>>6|192,63&r|128)}else if(r<65536){if((e-=3)<0)break;s.push(r>>12|224,r>>6&63|128,63&r|128)}else{if(!(r<1114112))throw new Error("Invalid code point");if((e-=4)<0)break;s.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}}return s}function D(t){return n.toByteArray(function(t){if((t=(t=t.split("=")[0]).trim().replace(O,"")).length<2)return"";for(;t.length%4!=0;)t+="=";return t}(t))}function Y(t,e,r,n){for(var a=0;a<n&&!(a+r>=e.length||a>=t.length);++a)e[a+r]=t[a];return a}function U(t,e){return t instanceof e||null!=t&&null!=t.constructor&&null!=t.constructor.name&&t.constructor.name===e.name}function F(t){return t!=t}var j=function(){for(var t="0123456789abcdef",e=new Array(256),r=0;r<16;++r)for(var n=16*r,a=0;a<16;++a)e[n+a]=t[r]+t[a];return e}()},987:t=>{"use strict";var e={single_source_shortest_paths:function(t,r,n){var a={},s={};s[r]=0;var i,o,l,f,_,u,h,c=e.PriorityQueue.make();for(c.push(r,0);!c.empty();)for(l in o=(i=c.pop()).value,f=i.cost,_=t[o]||{})_.hasOwnProperty(l)&&(u=f+_[l],h=s[l],(void 0===s[l]||h>u)&&(s[l]=u,c.push(l,u),a[l]=o));if(void 0!==n&&void 0===s[n]){var p=["Could not find a path from ",r," to ",n,"."].join("");throw new Error(p)}return a},extract_shortest_path_from_predecessor_list:function(t,e){for(var r=[],n=e;n;)r.push(n),t[n],n=t[n];return r.reverse(),r},find_path:function(t,r,n){var a=e.single_source_shortest_paths(t,r,n);return e.extract_shortest_path_from_predecessor_list(a,n)},PriorityQueue:{make:function(t){var r,n=e.PriorityQueue,a={};for(r in t=t||{},n)n.hasOwnProperty(r)&&(a[r]=n[r]);return a.queue=[],a.sorter=t.sorter||n.default_sorter,a},default_sorter:function(t,e){return t.cost-e.cost},push:function(t,e){var r={value:t,cost:e};this.queue.push(r),this.queue.sort(this.sorter)},pop:function(){return this.queue.shift()},empty:function(){return 0===this.queue.length}}};t.exports=e},645:(t,e)=>{e.read=function(t,e,r,n,a){var s,i,o=8*a-n-1,l=(1<<o)-1,f=l>>1,_=-7,u=r?a-1:0,h=r?-1:1,c=t[e+u];for(u+=h,s=c&(1<<-_)-1,c>>=-_,_+=o;_>0;s=256*s+t[e+u],u+=h,_-=8);for(i=s&(1<<-_)-1,s>>=-_,_+=n;_>0;i=256*i+t[e+u],u+=h,_-=8);if(0===s)s=1-f;else{if(s===l)return i?NaN:1/0*(c?-1:1);i+=Math.pow(2,n),s-=f}return(c?-1:1)*i*Math.pow(2,s-n)},e.write=function(t,e,r,n,a,s){var i,o,l,f=8*s-a-1,_=(1<<f)-1,u=_>>1,h=23===a?Math.pow(2,-24)-Math.pow(2,-77):0,c=n?0:s-1,p=n?1:-1,m=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(o=isNaN(e)?1:0,i=_):(i=Math.floor(Math.log(e)/Math.LN2),e*(l=Math.pow(2,-i))<1&&(i--,l*=2),(e+=i+u>=1?h/l:h*Math.pow(2,1-u))*l>=2&&(i++,l/=2),i+u>=_?(o=0,i=_):i+u>=1?(o=(e*l-1)*Math.pow(2,a),i+=u):(o=e*Math.pow(2,u-1)*Math.pow(2,a),i=0));a>=8;t[r+c]=255&o,c+=p,o/=256,a-=8);for(i=i<<a|o,f+=a;f>0;t[r+c]=255&i,c+=p,i/=256,f-=8);t[r+c-p]|=128*m}},592:(t,e,r)=>{var n=r(138),a=r(115),s=r(907),i=r(776);function o(t,e,r,s,i){var o=[].slice.call(arguments,1),l=o.length,f="function"==typeof o[l-1];if(!f&&!n())throw new Error("Callback required as last argument");if(!f){if(l<1)throw new Error("Too few arguments provided");return 1===l?(r=e,e=s=void 0):2!==l||e.getContext||(s=r,r=e,e=void 0),new Promise((function(n,i){try{var o=a.create(r,s);n(t(o,e,s))}catch(t){i(t)}}))}if(l<2)throw new Error("Too few arguments provided");2===l?(i=r,r=e,e=s=void 0):3===l&&(e.getContext&&void 0===i?(i=s,s=void 0):(i=s,s=r,r=e,e=void 0));try{var _=a.create(r,s);i(null,t(_,e,s))}catch(t){i(t)}}a.create,o.bind(null,s.render),e.hz=o.bind(null,s.renderToDataURL),o.bind(null,(function(t,e,r){return i.render(t,r)}))},138:t=>{t.exports=function(){return"function"==typeof Promise&&Promise.prototype&&Promise.prototype.then}},845:(t,e,r)=>{var n=r(242).getSymbolSize;e.getRowColCoords=function(t){if(1===t)return[];for(var e=Math.floor(t/7)+2,r=n(t),a=145===r?26:2*Math.ceil((r-13)/(2*e-2)),s=[r-7],i=1;i<e-1;i++)s[i]=s[i-1]-a;return s.push(6),s.reverse()},e.getPositions=function(t){for(var r=[],n=e.getRowColCoords(t),a=n.length,s=0;s<a;s++)for(var i=0;i<a;i++)0===s&&0===i||0===s&&i===a-1||s===a-1&&0===i||r.push([n[s],n[i]]);return r}},260:(t,e,r)=>{var n=r(910),a=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"," ","$","%","*","+","-",".","/",":"];function s(t){this.mode=n.ALPHANUMERIC,this.data=t}s.getBitsLength=function(t){return 11*Math.floor(t/2)+t%2*6},s.prototype.getLength=function(){return this.data.length},s.prototype.getBitsLength=function(){return s.getBitsLength(this.data.length)},s.prototype.write=function(t){var e;for(e=0;e+2<=this.data.length;e+=2){var r=45*a.indexOf(this.data[e]);r+=a.indexOf(this.data[e+1]),t.put(r,11)}this.data.length%2&&t.put(a.indexOf(this.data[e]),6)},t.exports=s},245:t=>{function e(){this.buffer=[],this.length=0}e.prototype={get:function(t){var e=Math.floor(t/8);return 1==(this.buffer[e]>>>7-t%8&1)},put:function(t,e){for(var r=0;r<e;r++)this.putBit(1==(t>>>e-r-1&1))},getLengthInBits:function(){return this.length},putBit:function(t){var e=Math.floor(this.length/8);this.buffer.length<=e&&this.buffer.push(0),t&&(this.buffer[e]|=128>>>this.length%8),this.length++}},t.exports=e},280:(t,e,r)=>{var n=r(131);function a(t){if(!t||t<1)throw new Error("BitMatrix size must be defined and greater than 0");this.size=t,this.data=n.alloc(t*t),this.reservedBit=n.alloc(t*t)}a.prototype.set=function(t,e,r,n){var a=t*this.size+e;this.data[a]=r,n&&(this.reservedBit[a]=!0)},a.prototype.get=function(t,e){return this.data[t*this.size+e]},a.prototype.xor=function(t,e,r){this.data[t*this.size+e]^=r},a.prototype.isReserved=function(t,e){return this.reservedBit[t*this.size+e]},t.exports=a},424:(t,e,r)=>{var n=r(131),a=r(910);function s(t){this.mode=a.BYTE,this.data=n.from(t)}s.getBitsLength=function(t){return 8*t},s.prototype.getLength=function(){return this.data.length},s.prototype.getBitsLength=function(){return s.getBitsLength(this.data.length)},s.prototype.write=function(t){for(var e=0,r=this.data.length;e<r;e++)t.put(this.data[e],8)},t.exports=s},393:(t,e,r)=>{var n=r(908),a=[1,1,1,1,1,1,1,1,1,1,2,2,1,2,2,4,1,2,4,4,2,4,4,4,2,4,6,5,2,4,6,6,2,5,8,8,4,5,8,8,4,5,8,11,4,8,10,11,4,9,12,16,4,9,16,16,6,10,12,18,6,10,17,16,6,11,16,19,6,13,18,21,7,14,21,25,8,16,20,25,8,17,23,25,9,17,23,34,9,18,25,30,10,20,27,32,12,21,29,35,12,23,34,37,12,25,34,40,13,26,35,42,14,28,38,45,15,29,40,48,16,31,43,51,17,33,45,54,18,35,48,57,19,37,51,60,19,38,53,63,20,40,56,66,21,43,59,70,22,45,62,74,24,47,65,77,25,49,68,81],s=[7,10,13,17,10,16,22,28,15,26,36,44,20,36,52,64,26,48,72,88,36,64,96,112,40,72,108,130,48,88,132,156,60,110,160,192,72,130,192,224,80,150,224,264,96,176,260,308,104,198,288,352,120,216,320,384,132,240,360,432,144,280,408,480,168,308,448,532,180,338,504,588,196,364,546,650,224,416,600,700,224,442,644,750,252,476,690,816,270,504,750,900,300,560,810,960,312,588,870,1050,336,644,952,1110,360,700,1020,1200,390,728,1050,1260,420,784,1140,1350,450,812,1200,1440,480,868,1290,1530,510,924,1350,1620,540,980,1440,1710,570,1036,1530,1800,570,1064,1590,1890,600,1120,1680,1980,630,1204,1770,2100,660,1260,1860,2220,720,1316,1950,2310,750,1372,2040,2430];e.getBlocksCount=function(t,e){switch(e){case n.L:return a[4*(t-1)+0];case n.M:return a[4*(t-1)+1];case n.Q:return a[4*(t-1)+2];case n.H:return a[4*(t-1)+3];default:return}},e.getTotalCodewordsCount=function(t,e){switch(e){case n.L:return s[4*(t-1)+0];case n.M:return s[4*(t-1)+1];case n.Q:return s[4*(t-1)+2];case n.H:return s[4*(t-1)+3];default:return}}},908:(t,e)=>{e.L={bit:1},e.M={bit:0},e.Q={bit:3},e.H={bit:2},e.isValid=function(t){return t&&void 0!==t.bit&&t.bit>=0&&t.bit<4},e.from=function(t,r){if(e.isValid(t))return t;try{return function(t){if("string"!=typeof t)throw new Error("Param is not a string");switch(t.toLowerCase()){case"l":case"low":return e.L;case"m":case"medium":return e.M;case"q":case"quartile":return e.Q;case"h":case"high":return e.H;default:throw new Error("Unknown EC Level: "+t)}}(t)}catch(t){return r}}},526:(t,e,r)=>{var n=r(242).getSymbolSize;e.getPositions=function(t){var e=n(t);return[[0,0],[e-7,0],[0,e-7]]}},642:(t,e,r)=>{var n=r(242),a=n.getBCHDigit(1335);e.getEncodedBits=function(t,e){for(var r=t.bit<<3|e,s=r<<10;n.getBCHDigit(s)-a>=0;)s^=1335<<n.getBCHDigit(s)-a;return 21522^(r<<10|s)}},729:(t,e,r)=>{var n=r(131),a=n.alloc(512),s=n.alloc(256);!function(){for(var t=1,e=0;e<255;e++)a[e]=t,s[t]=e,256&(t<<=1)&&(t^=285);for(e=255;e<512;e++)a[e]=a[e-255]}(),e.log=function(t){if(t<1)throw new Error("log("+t+")");return s[t]},e.exp=function(t){return a[t]},e.mul=function(t,e){return 0===t||0===e?0:a[s[t]+s[e]]}},442:(t,e,r)=>{var n=r(910),a=r(242);function s(t){this.mode=n.KANJI,this.data=t}s.getBitsLength=function(t){return 13*t},s.prototype.getLength=function(){return this.data.length},s.prototype.getBitsLength=function(){return s.getBitsLength(this.data.length)},s.prototype.write=function(t){var e;for(e=0;e<this.data.length;e++){var r=a.toSJIS(this.data[e]);if(r>=33088&&r<=40956)r-=33088;else{if(!(r>=57408&&r<=60351))throw new Error("Invalid SJIS character: "+this.data[e]+"\nMake sure your charset is UTF-8");r-=49472}r=192*(r>>>8&255)+(255&r),t.put(r,13)}},t.exports=s},126:(t,e)=>{e.Patterns={PATTERN000:0,PATTERN001:1,PATTERN010:2,PATTERN011:3,PATTERN100:4,PATTERN101:5,PATTERN110:6,PATTERN111:7};function r(t,r,n){switch(t){case e.Patterns.PATTERN000:return(r+n)%2==0;case e.Patterns.PATTERN001:return r%2==0;case e.Patterns.PATTERN010:return n%3==0;case e.Patterns.PATTERN011:return(r+n)%3==0;case e.Patterns.PATTERN100:return(Math.floor(r/2)+Math.floor(n/3))%2==0;case e.Patterns.PATTERN101:return r*n%2+r*n%3==0;case e.Patterns.PATTERN110:return(r*n%2+r*n%3)%2==0;case e.Patterns.PATTERN111:return(r*n%3+(r+n)%2)%2==0;default:throw new Error("bad maskPattern:"+t)}}e.isValid=function(t){return null!=t&&""!==t&&!isNaN(t)&&t>=0&&t<=7},e.from=function(t){return e.isValid(t)?parseInt(t,10):void 0},e.getPenaltyN1=function(t){for(var e=t.size,r=0,n=0,a=0,s=null,i=null,o=0;o<e;o++){n=a=0,s=i=null;for(var l=0;l<e;l++){var f=t.get(o,l);f===s?n++:(n>=5&&(r+=n-5+3),s=f,n=1),(f=t.get(l,o))===i?a++:(a>=5&&(r+=a-5+3),i=f,a=1)}n>=5&&(r+=n-5+3),a>=5&&(r+=a-5+3)}return r},e.getPenaltyN2=function(t){for(var e=t.size,r=0,n=0;n<e-1;n++)for(var a=0;a<e-1;a++){var s=t.get(n,a)+t.get(n,a+1)+t.get(n+1,a)+t.get(n+1,a+1);4!==s&&0!==s||r++}return 3*r},e.getPenaltyN3=function(t){for(var e=t.size,r=0,n=0,a=0,s=0;s<e;s++){n=a=0;for(var i=0;i<e;i++)n=n<<1&2047|t.get(s,i),i>=10&&(1488===n||93===n)&&r++,a=a<<1&2047|t.get(i,s),i>=10&&(1488===a||93===a)&&r++}return 40*r},e.getPenaltyN4=function(t){for(var e=0,r=t.data.length,n=0;n<r;n++)e+=t.data[n];return 10*Math.abs(Math.ceil(100*e/r/5)-10)},e.applyMask=function(t,e){for(var n=e.size,a=0;a<n;a++)for(var s=0;s<n;s++)e.isReserved(s,a)||e.xor(s,a,r(t,s,a))},e.getBestMask=function(t,r){for(var n=Object.keys(e.Patterns).length,a=0,s=1/0,i=0;i<n;i++){r(i),e.applyMask(i,t);var o=e.getPenaltyN1(t)+e.getPenaltyN2(t)+e.getPenaltyN3(t)+e.getPenaltyN4(t);e.applyMask(i,t),o<s&&(s=o,a=i)}return a}},910:(t,e,r)=>{var n=r(114),a=r(7);e.NUMERIC={id:"Numeric",bit:1,ccBits:[10,12,14]},e.ALPHANUMERIC={id:"Alphanumeric",bit:2,ccBits:[9,11,13]},e.BYTE={id:"Byte",bit:4,ccBits:[8,16,16]},e.KANJI={id:"Kanji",bit:8,ccBits:[8,10,12]},e.MIXED={bit:-1},e.getCharCountIndicator=function(t,e){if(!t.ccBits)throw new Error("Invalid mode: "+t);if(!n.isValid(e))throw new Error("Invalid version: "+e);return e>=1&&e<10?t.ccBits[0]:e<27?t.ccBits[1]:t.ccBits[2]},e.getBestModeForData=function(t){return a.testNumeric(t)?e.NUMERIC:a.testAlphanumeric(t)?e.ALPHANUMERIC:a.testKanji(t)?e.KANJI:e.BYTE},e.toString=function(t){if(t&&t.id)return t.id;throw new Error("Invalid mode")},e.isValid=function(t){return t&&t.bit&&t.ccBits},e.from=function(t,r){if(e.isValid(t))return t;try{return function(t){if("string"!=typeof t)throw new Error("Param is not a string");switch(t.toLowerCase()){case"numeric":return e.NUMERIC;case"alphanumeric":return e.ALPHANUMERIC;case"kanji":return e.KANJI;case"byte":return e.BYTE;default:throw new Error("Unknown mode: "+t)}}(t)}catch(t){return r}}},85:(t,e,r)=>{var n=r(910);function a(t){this.mode=n.NUMERIC,this.data=t.toString()}a.getBitsLength=function(t){return 10*Math.floor(t/3)+(t%3?t%3*3+1:0)},a.prototype.getLength=function(){return this.data.length},a.prototype.getBitsLength=function(){return a.getBitsLength(this.data.length)},a.prototype.write=function(t){var e,r,n;for(e=0;e+3<=this.data.length;e+=3)r=this.data.substr(e,3),n=parseInt(r,10),t.put(n,10);var a=this.data.length-e;a>0&&(r=this.data.substr(e),n=parseInt(r,10),t.put(n,3*a+1))},t.exports=a},143:(t,e,r)=>{var n=r(131),a=r(729);e.mul=function(t,e){for(var r=n.alloc(t.length+e.length-1),s=0;s<t.length;s++)for(var i=0;i<e.length;i++)r[s+i]^=a.mul(t[s],e[i]);return r},e.mod=function(t,e){for(var r=n.from(t);r.length-e.length>=0;){for(var s=r[0],i=0;i<e.length;i++)r[i]^=a.mul(e[i],s);for(var o=0;o<r.length&&0===r[o];)o++;r=r.slice(o)}return r},e.generateECPolynomial=function(t){for(var r=n.from([1]),s=0;s<t;s++)r=e.mul(r,[1,a.exp(s)]);return r}},115:(t,e,r)=>{var n=r(131),a=r(242),s=r(908),i=r(245),o=r(280),l=r(845),f=r(526),_=r(126),u=r(393),h=r(882),c=r(103),p=r(642),m=r(910),b=r(130),d=r(147);function v(t,e,r){var n,a,s=t.size,i=p.getEncodedBits(e,r);for(n=0;n<15;n++)a=1==(i>>n&1),n<6?t.set(n,8,a,!0):n<8?t.set(n+1,8,a,!0):t.set(s-15+n,8,a,!0),n<8?t.set(8,s-n-1,a,!0):n<9?t.set(8,15-n-1+1,a,!0):t.set(8,15-n-1,a,!0);t.set(s-8,8,1,!0)}function g(t,e,r,s){var p;if(d(t))p=b.fromArray(t);else{if("string"!=typeof t)throw new Error("Invalid data");var g=e;if(!g){var w=b.rawSplit(t);g=c.getBestVersionForData(w,r)}p=b.fromString(t,g||40)}var y=c.getBestVersionForData(p,r);if(!y)throw new Error("The amount of data is too big to be stored in a QR Code");if(e){if(e<y)throw new Error("\nThe chosen QR Code version cannot contain this amount of data.\nMinimum version required to store current data is: "+y+".\n")}else e=y;var S=function(t,e,r){var s=new i;r.forEach((function(e){s.put(e.mode.bit,4),s.put(e.getLength(),m.getCharCountIndicator(e.mode,t)),e.write(s)}));var o=8*(a.getSymbolTotalCodewords(t)-u.getTotalCodewordsCount(t,e));for(s.getLengthInBits()+4<=o&&s.put(0,4);s.getLengthInBits()%8!=0;)s.putBit(0);for(var l=(o-s.getLengthInBits())/8,f=0;f<l;f++)s.put(f%2?17:236,8);return function(t,e,r){for(var s=a.getSymbolTotalCodewords(e),i=s-u.getTotalCodewordsCount(e,r),o=u.getBlocksCount(e,r),l=o-s%o,f=Math.floor(s/o),_=Math.floor(i/o),c=_+1,p=f-_,m=new h(p),b=0,d=new Array(o),v=new Array(o),g=0,w=n.from(t.buffer),y=0;y<o;y++){var S=y<l?_:c;d[y]=w.slice(b,b+S),v[y]=m.encode(d[y]),b+=S,g=Math.max(g,S)}var A,B,M=n.alloc(s),R=0;for(A=0;A<g;A++)for(B=0;B<o;B++)A<d[B].length&&(M[R++]=d[B][A]);for(A=0;A<p;A++)for(B=0;B<o;B++)M[R++]=v[B][A];return M}(s,t,e)}(e,r,p),A=a.getSymbolSize(e),B=new o(A);return function(t,e){for(var r=t.size,n=f.getPositions(e),a=0;a<n.length;a++)for(var s=n[a][0],i=n[a][1],o=-1;o<=7;o++)if(!(s+o<=-1||r<=s+o))for(var l=-1;l<=7;l++)i+l<=-1||r<=i+l||(o>=0&&o<=6&&(0===l||6===l)||l>=0&&l<=6&&(0===o||6===o)||o>=2&&o<=4&&l>=2&&l<=4?t.set(s+o,i+l,!0,!0):t.set(s+o,i+l,!1,!0))}(B,e),function(t){for(var e=t.size,r=8;r<e-8;r++){var n=r%2==0;t.set(r,6,n,!0),t.set(6,r,n,!0)}}(B),function(t,e){for(var r=l.getPositions(e),n=0;n<r.length;n++)for(var a=r[n][0],s=r[n][1],i=-2;i<=2;i++)for(var o=-2;o<=2;o++)-2===i||2===i||-2===o||2===o||0===i&&0===o?t.set(a+i,s+o,!0,!0):t.set(a+i,s+o,!1,!0)}(B,e),v(B,r,0),e>=7&&function(t,e){for(var r,n,a,s=t.size,i=c.getEncodedBits(e),o=0;o<18;o++)r=Math.floor(o/3),n=o%3+s-8-3,a=1==(i>>o&1),t.set(r,n,a,!0),t.set(n,r,a,!0)}(B,e),function(t,e){for(var r=t.size,n=-1,a=r-1,s=7,i=0,o=r-1;o>0;o-=2)for(6===o&&o--;;){for(var l=0;l<2;l++)if(!t.isReserved(a,o-l)){var f=!1;i<e.length&&(f=1==(e[i]>>>s&1)),t.set(a,o-l,f),-1==--s&&(i++,s=7)}if((a+=n)<0||r<=a){a-=n,n=-n;break}}}(B,S),isNaN(s)&&(s=_.getBestMask(B,v.bind(null,B,r))),_.applyMask(s,B),v(B,r,s),{modules:B,version:e,errorCorrectionLevel:r,maskPattern:s,segments:p}}e.create=function(t,e){if(void 0===t||""===t)throw new Error("No input text");var r,n,i=s.M;return void 0!==e&&(i=s.from(e.errorCorrectionLevel,s.M),r=c.from(e.version),n=_.from(e.maskPattern),e.toSJISFunc&&a.setToSJISFunction(e.toSJISFunc)),g(t,r,i,n)}},882:(t,e,r)=>{var n=r(131),a=r(143),s=r(764).lW;function i(t){this.genPoly=void 0,this.degree=t,this.degree&&this.initialize(this.degree)}i.prototype.initialize=function(t){this.degree=t,this.genPoly=a.generateECPolynomial(this.degree)},i.prototype.encode=function(t){if(!this.genPoly)throw new Error("Encoder not initialized");var e=n.alloc(this.degree),r=s.concat([t,e],t.length+this.degree),i=a.mod(r,this.genPoly),o=this.degree-i.length;if(o>0){var l=n.alloc(this.degree);return i.copy(l,o),l}return i},t.exports=i},7:(t,e)=>{var r="(?:[u3000-u303F]|[u3040-u309F]|[u30A0-u30FF]|[uFF00-uFFEF]|[u4E00-u9FAF]|[u2605-u2606]|[u2190-u2195]|u203B|[u2010u2015u2018u2019u2025u2026u201Cu201Du2225u2260]|[u0391-u0451]|[u00A7u00A8u00B1u00B4u00D7u00F7])+",n="(?:(?![A-Z0-9 $%*+\\-./:]|"+(r=r.replace(/u/g,"\\u"))+")(?:.|[\r\n]))+";e.KANJI=new RegExp(r,"g"),e.BYTE_KANJI=new RegExp("[^A-Z0-9 $%*+\\-./:]+","g"),e.BYTE=new RegExp(n,"g"),e.NUMERIC=new RegExp("[0-9]+","g"),e.ALPHANUMERIC=new RegExp("[A-Z $%*+\\-./:]+","g");var a=new RegExp("^"+r+"$"),s=new RegExp("^[0-9]+$"),i=new RegExp("^[A-Z0-9 $%*+\\-./:]+$");e.testKanji=function(t){return a.test(t)},e.testNumeric=function(t){return s.test(t)},e.testAlphanumeric=function(t){return i.test(t)}},130:(t,e,r)=>{var n=r(910),a=r(85),s=r(260),i=r(424),o=r(442),l=r(7),f=r(242),_=r(987);function u(t){return unescape(encodeURIComponent(t)).length}function h(t,e,r){for(var n,a=[];null!==(n=t.exec(r));)a.push({data:n[0],index:n.index,mode:e,length:n[0].length});return a}function c(t){var e,r,a=h(l.NUMERIC,n.NUMERIC,t),s=h(l.ALPHANUMERIC,n.ALPHANUMERIC,t);return f.isKanjiModeEnabled()?(e=h(l.BYTE,n.BYTE,t),r=h(l.KANJI,n.KANJI,t)):(e=h(l.BYTE_KANJI,n.BYTE,t),r=[]),a.concat(s,e,r).sort((function(t,e){return t.index-e.index})).map((function(t){return{data:t.data,mode:t.mode,length:t.length}}))}function p(t,e){switch(e){case n.NUMERIC:return a.getBitsLength(t);case n.ALPHANUMERIC:return s.getBitsLength(t);case n.KANJI:return o.getBitsLength(t);case n.BYTE:return i.getBitsLength(t)}}function m(t,e){var r,l=n.getBestModeForData(t);if((r=n.from(e,l))!==n.BYTE&&r.bit<l.bit)throw new Error('"'+t+'" cannot be encoded with mode '+n.toString(r)+".\n Suggested mode is: "+n.toString(l));switch(r!==n.KANJI||f.isKanjiModeEnabled()||(r=n.BYTE),r){case n.NUMERIC:return new a(t);case n.ALPHANUMERIC:return new s(t);case n.KANJI:return new o(t);case n.BYTE:return new i(t)}}e.fromArray=function(t){return t.reduce((function(t,e){return"string"==typeof e?t.push(m(e,null)):e.data&&t.push(m(e.data,e.mode)),t}),[])},e.fromString=function(t,r){for(var a=function(t,e){for(var r={},a={start:{}},s=["start"],i=0;i<t.length;i++){for(var o=t[i],l=[],f=0;f<o.length;f++){var _=o[f],u=""+i+f;l.push(u),r[u]={node:_,lastCount:0},a[u]={};for(var h=0;h<s.length;h++){var c=s[h];r[c]&&r[c].node.mode===_.mode?(a[c][u]=p(r[c].lastCount+_.length,_.mode)-p(r[c].lastCount,_.mode),r[c].lastCount+=_.length):(r[c]&&(r[c].lastCount=_.length),a[c][u]=p(_.length,_.mode)+4+n.getCharCountIndicator(_.mode,e))}}s=l}for(h=0;h<s.length;h++)a[s[h]].end=0;return{map:a,table:r}}(function(t){for(var e=[],r=0;r<t.length;r++){var a=t[r];switch(a.mode){case n.NUMERIC:e.push([a,{data:a.data,mode:n.ALPHANUMERIC,length:a.length},{data:a.data,mode:n.BYTE,length:a.length}]);break;case n.ALPHANUMERIC:e.push([a,{data:a.data,mode:n.BYTE,length:a.length}]);break;case n.KANJI:e.push([a,{data:a.data,mode:n.BYTE,length:u(a.data)}]);break;case n.BYTE:e.push([{data:a.data,mode:n.BYTE,length:u(a.data)}])}}return e}(c(t,f.isKanjiModeEnabled())),r),s=_.find_path(a.map,"start","end"),i=[],o=1;o<s.length-1;o++)i.push(a.table[s[o]].node);return e.fromArray(i.reduce((function(t,e){var r=t.length-1>=0?t[t.length-1]:null;return r&&r.mode===e.mode?(t[t.length-1].data+=e.data,t):(t.push(e),t)}),[]))},e.rawSplit=function(t){return e.fromArray(c(t,f.isKanjiModeEnabled()))}},242:(t,e)=>{var r,n=[0,26,44,70,100,134,172,196,242,292,346,404,466,532,581,655,733,815,901,991,1085,1156,1258,1364,1474,1588,1706,1828,1921,2051,2185,2323,2465,2611,2761,2876,3034,3196,3362,3532,3706];e.getSymbolSize=function(t){if(!t)throw new Error('"version" cannot be null or undefined');if(t<1||t>40)throw new Error('"version" should be in range from 1 to 40');return 4*t+17},e.getSymbolTotalCodewords=function(t){return n[t]},e.getBCHDigit=function(t){for(var e=0;0!==t;)e++,t>>>=1;return e},e.setToSJISFunction=function(t){if("function"!=typeof t)throw new Error('"toSJISFunc" is not a valid function.');r=t},e.isKanjiModeEnabled=function(){return void 0!==r},e.toSJIS=function(t){return r(t)}},114:(t,e)=>{e.isValid=function(t){return!isNaN(t)&&t>=1&&t<=40}},103:(t,e,r)=>{var n=r(242),a=r(393),s=r(908),i=r(910),o=r(114),l=r(147),f=n.getBCHDigit(7973);function _(t,e){return i.getCharCountIndicator(t,e)+4}function u(t,e){var r=0;return t.forEach((function(t){var n=_(t.mode,e);r+=n+t.getBitsLength()})),r}e.from=function(t,e){return o.isValid(t)?parseInt(t,10):e},e.getCapacity=function(t,e,r){if(!o.isValid(t))throw new Error("Invalid QR Code version");void 0===r&&(r=i.BYTE);var s=8*(n.getSymbolTotalCodewords(t)-a.getTotalCodewordsCount(t,e));if(r===i.MIXED)return s;var l=s-_(r,t);switch(r){case i.NUMERIC:return Math.floor(l/10*3);case i.ALPHANUMERIC:return Math.floor(l/11*2);case i.KANJI:return Math.floor(l/13);case i.BYTE:default:return Math.floor(l/8)}},e.getBestVersionForData=function(t,r){var n,a=s.from(r,s.M);if(l(t)){if(t.length>1)return function(t,r){for(var n=1;n<=40;n++)if(u(t,n)<=e.getCapacity(n,r,i.MIXED))return n}(t,a);if(0===t.length)return 1;n=t[0]}else n=t;return function(t,r,n){for(var a=1;a<=40;a++)if(r<=e.getCapacity(a,n,t))return a}(n.mode,n.getLength(),a)},e.getEncodedBits=function(t){if(!o.isValid(t)||t<7)throw new Error("Invalid QR Code version");for(var e=t<<12;n.getBCHDigit(e)-f>=0;)e^=7973<<n.getBCHDigit(e)-f;return t<<12|e}},907:(t,e,r)=>{var n=r(653);e.render=function(t,e,r){var a=r,s=e;void 0!==a||e&&e.getContext||(a=e,e=void 0),e||(s=function(){try{return document.createElement("canvas")}catch(t){throw new Error("You need to specify a canvas element")}}()),a=n.getOptions(a);var i=n.getImageWidth(t.modules.size,a),o=s.getContext("2d"),l=o.createImageData(i,i);return n.qrToImageData(l.data,t,a),function(t,e,r){t.clearRect(0,0,e.width,e.height),e.style||(e.style={}),e.height=r,e.width=r,e.style.height=r+"px",e.style.width=r+"px"}(o,s,i),o.putImageData(l,0,0),s},e.renderToDataURL=function(t,r,n){var a=n;void 0!==a||r&&r.getContext||(a=r,r=void 0),a||(a={});var s=e.render(t,r,a),i=a.type||"image/png",o=a.rendererOpts||{};return s.toDataURL(i,o.quality)}},776:(t,e,r)=>{var n=r(653);function a(t,e){var r=t.a/255,n=e+'="'+t.hex+'"';return r<1?n+" "+e+'-opacity="'+r.toFixed(2).slice(1)+'"':n}function s(t,e,r){var n=t+e;return void 0!==r&&(n+=" "+r),n}e.render=function(t,e,r){var i=n.getOptions(e),o=t.modules.size,l=t.modules.data,f=o+2*i.margin,_=i.color.light.a?"<path "+a(i.color.light,"fill")+' d="M0 0h'+f+"v"+f+'H0z"/>':"",u="<path "+a(i.color.dark,"stroke")+' d="'+function(t,e,r){for(var n="",a=0,i=!1,o=0,l=0;l<t.length;l++){var f=Math.floor(l%e),_=Math.floor(l/e);f||i||(i=!0),t[l]?(o++,l>0&&f>0&&t[l-1]||(n+=i?s("M",f+r,.5+_+r):s("m",a,0),a=0,i=!1),f+1<e&&t[l+1]||(n+=s("h",o),o=0)):a++}return n}(l,o,i.margin)+'"/>',h='viewBox="0 0 '+f+" "+f+'"',c='<svg xmlns="http://www.w3.org/2000/svg" '+(i.width?'width="'+i.width+'" height="'+i.width+'" ':"")+h+' shape-rendering="crispEdges">'+_+u+"</svg>\n";return"function"==typeof r&&r(null,c),c}},653:(t,e)=>{function r(t){if("number"==typeof t&&(t=t.toString()),"string"!=typeof t)throw new Error("Color should be defined as hex string");var e=t.slice().replace("#","").split("");if(e.length<3||5===e.length||e.length>8)throw new Error("Invalid hex color: "+t);3!==e.length&&4!==e.length||(e=Array.prototype.concat.apply([],e.map((function(t){return[t,t]})))),6===e.length&&e.push("F","F");var r=parseInt(e.join(""),16);return{r:r>>24&255,g:r>>16&255,b:r>>8&255,a:255&r,hex:"#"+e.slice(0,6).join("")}}e.getOptions=function(t){t||(t={}),t.color||(t.color={});var e=void 0===t.margin||null===t.margin||t.margin<0?4:t.margin,n=t.width&&t.width>=21?t.width:void 0,a=t.scale||4;return{width:n,scale:n?4:a,margin:e,color:{dark:r(t.color.dark||"#000000ff"),light:r(t.color.light||"#ffffffff")},type:t.type,rendererOpts:t.rendererOpts||{}}},e.getScale=function(t,e){return e.width&&e.width>=t+2*e.margin?e.width/(t+2*e.margin):e.scale},e.getImageWidth=function(t,r){var n=e.getScale(t,r);return Math.floor((t+2*r.margin)*n)},e.qrToImageData=function(t,r,n){for(var a=r.modules.size,s=r.modules.data,i=e.getScale(a,n),o=Math.floor((a+2*n.margin)*i),l=n.margin*i,f=[n.color.light,n.color.dark],_=0;_<o;_++)for(var u=0;u<o;u++){var h=4*(_*o+u),c=n.color.light;_>=l&&u>=l&&_<o-l&&u<o-l&&(c=f[s[Math.floor((_-l)/i)*a+Math.floor((u-l)/i)]?1:0]),t[h++]=c.r,t[h++]=c.g,t[h++]=c.b,t[h]=c.a}}},131:(t,e,r)=>{"use strict";var n=r(147);s.TYPED_ARRAY_SUPPORT=function(){try{var t=new Uint8Array(1);return t.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===t.foo()}catch(t){return!1}}();var a=s.TYPED_ARRAY_SUPPORT?2147483647:1073741823;function s(t,e,r){return s.TYPED_ARRAY_SUPPORT||this instanceof s?"number"==typeof t?l(this,t):function(t,e,r,n){if("number"==typeof e)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&e instanceof ArrayBuffer?function(t,e,r,n){if(r<0||e.byteLength<r)throw new RangeError("'offset' is out of bounds");if(e.byteLength<r+(n||0))throw new RangeError("'length' is out of bounds");var a;return a=void 0===r&&void 0===n?new Uint8Array(e):void 0===n?new Uint8Array(e,r):new Uint8Array(e,r,n),s.TYPED_ARRAY_SUPPORT?a.__proto__=s.prototype:a=f(t,a),a}(t,e,r,n):"string"==typeof e?function(t,e){var r=0|u(e),n=o(t,r),a=n.write(e);return a!==r&&(n=n.slice(0,a)),n}(t,e):function(t,e){if(s.isBuffer(e)){var r=0|i(e.length),n=o(t,r);return 0===n.length||e.copy(n,0,0,r),n}if(e){if("undefined"!=typeof ArrayBuffer&&e.buffer instanceof ArrayBuffer||"length"in e)return"number"!=typeof e.length||(a=e.length)!=a?o(t,0):f(t,e);if("Buffer"===e.type&&Array.isArray(e.data))return f(t,e.data)}var a;throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(t,e)}(this,t,e,r):new s(t,e,r)}function i(t){if(t>=a)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+a.toString(16)+" bytes");return 0|t}function o(t,e){var r;return s.TYPED_ARRAY_SUPPORT?(r=new Uint8Array(e)).__proto__=s.prototype:(null===(r=t)&&(r=new s(e)),r.length=e),r}function l(t,e){var r=o(t,e<0?0:0|i(e));if(!s.TYPED_ARRAY_SUPPORT)for(var n=0;n<e;++n)r[n]=0;return r}function f(t,e){for(var r=e.length<0?0:0|i(e.length),n=o(t,r),a=0;a<r;a+=1)n[a]=255&e[a];return n}function _(t,e){var r;e=e||1/0;for(var n=t.length,a=null,s=[],i=0;i<n;++i){if((r=t.charCodeAt(i))>55295&&r<57344){if(!a){if(r>56319){(e-=3)>-1&&s.push(239,191,189);continue}if(i+1===n){(e-=3)>-1&&s.push(239,191,189);continue}a=r;continue}if(r<56320){(e-=3)>-1&&s.push(239,191,189),a=r;continue}r=65536+(a-55296<<10|r-56320)}else a&&(e-=3)>-1&&s.push(239,191,189);if(a=null,r<128){if((e-=1)<0)break;s.push(r)}else if(r<2048){if((e-=2)<0)break;s.push(r>>6|192,63&r|128)}else if(r<65536){if((e-=3)<0)break;s.push(r>>12|224,r>>6&63|128,63&r|128)}else{if(!(r<1114112))throw new Error("Invalid code point");if((e-=4)<0)break;s.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}}return s}function u(t){return s.isBuffer(t)?t.length:"undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(t)||t instanceof ArrayBuffer)?t.byteLength:("string"!=typeof t&&(t=""+t),0===t.length?0:_(t).length)}s.TYPED_ARRAY_SUPPORT&&(s.prototype.__proto__=Uint8Array.prototype,s.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&s[Symbol.species]===s&&Object.defineProperty(s,Symbol.species,{value:null,configurable:!0,enumerable:!1,writable:!1})),s.prototype.write=function(t,e,r){void 0===e||void 0===r&&"string"==typeof e?(r=this.length,e=0):isFinite(e)&&(e|=0,isFinite(r)?r|=0:r=void 0);var n=this.length-e;if((void 0===r||r>n)&&(r=n),t.length>0&&(r<0||e<0)||e>this.length)throw new RangeError("Attempt to write outside buffer bounds");return function(t,e,r,n){return function(t,e,r,n){for(var a=0;a<n&&!(a+r>=e.length||a>=t.length);++a)e[a+r]=t[a];return a}(_(e,t.length-r),t,r,n)}(this,t,e,r)},s.prototype.slice=function(t,e){var r,n=this.length;if((t=~~t)<0?(t+=n)<0&&(t=0):t>n&&(t=n),(e=void 0===e?n:~~e)<0?(e+=n)<0&&(e=0):e>n&&(e=n),e<t&&(e=t),s.TYPED_ARRAY_SUPPORT)(r=this.subarray(t,e)).__proto__=s.prototype;else{var a=e-t;r=new s(a,void 0);for(var i=0;i<a;++i)r[i]=this[i+t]}return r},s.prototype.copy=function(t,e,r,n){if(r||(r=0),n||0===n||(n=this.length),e>=t.length&&(e=t.length),e||(e=0),n>0&&n<r&&(n=r),n===r)return 0;if(0===t.length||0===this.length)return 0;if(e<0)throw new RangeError("targetStart out of bounds");if(r<0||r>=this.length)throw new RangeError("sourceStart out of bounds");if(n<0)throw new RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),t.length-e<n-r&&(n=t.length-e+r);var a,i=n-r;if(this===t&&r<e&&e<n)for(a=i-1;a>=0;--a)t[a+e]=this[a+r];else if(i<1e3||!s.TYPED_ARRAY_SUPPORT)for(a=0;a<i;++a)t[a+e]=this[a+r];else Uint8Array.prototype.set.call(t,this.subarray(r,r+i),e);return i},s.prototype.fill=function(t,e,r){if("string"==typeof t){if("string"==typeof e?(e=0,r=this.length):"string"==typeof r&&(r=this.length),1===t.length){var n=t.charCodeAt(0);n<256&&(t=n)}}else"number"==typeof t&&(t&=255);if(e<0||this.length<e||this.length<r)throw new RangeError("Out of range index");if(r<=e)return this;var a;if(e>>>=0,r=void 0===r?this.length:r>>>0,t||(t=0),"number"==typeof t)for(a=e;a<r;++a)this[a]=t;else{var i=s.isBuffer(t)?t:new s(t),o=i.length;for(a=0;a<r-e;++a)this[a+e]=i[a%o]}return this},s.concat=function(t,e){if(!n(t))throw new TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return o(null,0);var r;if(void 0===e)for(e=0,r=0;r<t.length;++r)e+=t[r].length;var a=l(null,e),i=0;for(r=0;r<t.length;++r){var f=t[r];if(!s.isBuffer(f))throw new TypeError('"list" argument must be an Array of Buffers');f.copy(a,i),i+=f.length}return a},s.byteLength=u,s.prototype._isBuffer=!0,s.isBuffer=function(t){return!(null==t||!t._isBuffer)},t.exports.alloc=function(t){var e=new s(t);return e.fill(0),e},t.exports.from=function(t){return new s(t)}},147:t=>{var e={}.toString;t.exports=Array.isArray||function(t){return"[object Array]"==e.call(t)}},129:()=>{!function(){"use strict";function t(){var e=function(t){return Math.log(t)/Math.log(10)};function r(t){return new Int8Array(t)}function n(t){return new Int32Array(t)}function a(t){return new Float32Array(t)}function s(t){if(1==t.length)return a(t[0]);var e=t[0];t=t.slice(1);for(var r=[],n=0;n<e;n++)r.push(s(t));return r}function i(t){if(1==t.length)return n(t[0]);var e=t[0];t=t.slice(1);for(var r=[],a=0;a<e;a++)r.push(i(t));return r}function o(t){if(1==t.length)return e=t[0],new Int16Array(e);var e,r=t[0];t=t.slice(1);for(var n=[],a=0;a<r;a++)n.push(o(t));return n}function l(t){if(1==t.length)return new Array(t[0]);var e=t[0];t=t.slice(1);for(var r=[],n=0;n<e;n++)r.push(l(t));return r}var f={fill:function(t,e,r,n){if(2==arguments.length)for(var a=0;a<t.length;a++)t[a]=arguments[1];else for(a=e;a<r;a++)t[a]=n}},_={arraycopy:function(t,e,r,n,a){for(var s=e+a;e<s;)r[n++]=t[e++]}},u={};function h(t){this.ordinal=t}u.SQRT2=1.4142135623730951,u.FAST_LOG10=function(t){return e(t)},u.FAST_LOG10_X=function(t,r){return e(t)*r},h.short_block_allowed=new h(0),h.short_block_coupled=new h(1),h.short_block_dispensed=new h(2),h.short_block_forced=new h(3);var c={};function p(t){this.ordinal=t}function m(t){var e=t;this.ordinal=function(){return e}}function b(){this.getLameVersion=function(){return"3.98.4"},this.getLameShortVersion=function(){return"3.98.4"},this.getLameVeryShortVersion=function(){return"LAME3.98r"},this.getPsyVersion=function(){return"0.93"},this.getLameUrl=function(){return"http://www.mp3dev.org/"},this.getLameOsBitness=function(){return"32bits"}}function d(){var t=null;function e(t){this.bits=0|t}this.qupvt=null,this.setModules=function(e){this.qupvt=e,t=e};var r=[[0,0],[0,0],[0,0],[0,0],[0,0],[0,1],[1,1],[1,1],[1,2],[2,2],[2,3],[2,3],[3,4],[3,4],[3,4],[4,5],[4,5],[4,6],[5,6],[5,6],[5,7],[6,7],[6,7]];function a(t,e,r,n,a,s){var i=.5946/e;for(t>>=1;0!=t--;)a[s++]=i>r[n++]?0:1,a[s++]=i>r[n++]?0:1}function s(e,r,n,a,s,i){var o=(e>>=1)%2;for(e>>=1;0!=e--;){var l,f,_,u,h,c,p,m;l=n[a++]*r,f=n[a++]*r,h=0|l,_=n[a++]*r,c=0|f,u=n[a++]*r,p=0|_,l+=t.adj43[h],m=0|u,f+=t.adj43[c],s[i++]=0|l,_+=t.adj43[p],s[i++]=0|f,u+=t.adj43[m],s[i++]=0|_,s[i++]=0|u}0!=o&&(h=0|(l=n[a++]*r),c=0|(f=n[a++]*r),l+=t.adj43[h],f+=t.adj43[c],s[i++]=0|l,s[i++]=0|f)}var i=[1,2,5,7,7,10,10,13,13,13,13,13,13,13,13];function o(t,e,r,n){var a=function(t,e,r){var n=0,a=0;do{var s=t[e++],i=t[e++];n<s&&(n=s),a<i&&(a=i)}while(e<r);return n<a&&(n=a),n}(t,e,r);switch(a){case 0:return a;case 1:return function(t,e,r,n){var a=0,s=B.ht[1].hlen;do{var i=2*t[e+0]+t[e+1];e+=2,a+=s[i]}while(e<r);return n.bits+=a,1}(t,e,r,n);case 2:case 3:return function(t,e,r,n,a){var s,i,o=0,l=B.ht[n].xlen;i=2==n?B.table23:B.table56;do{var f=t[e+0]*l+t[e+1];e+=2,o+=i[f]}while(e<r);return s=65535&o,(o>>=16)>s&&(o=s,n++),a.bits+=o,n}(t,e,r,i[a-1],n);case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 12:case 13:case 14:case 15:return function(t,e,r,n,a){var s=0,i=0,o=0,l=B.ht[n].xlen,f=B.ht[n].hlen,_=B.ht[n+1].hlen,u=B.ht[n+2].hlen;do{var h=t[e+0]*l+t[e+1];e+=2,s+=f[h],i+=_[h],o+=u[h]}while(e<r);var c=n;return s>i&&(s=i,c++),s>o&&(s=o,c=n+2),a.bits+=s,c}(t,e,r,i[a-1],n);default:if(a>L.IXMAX_VAL)return n.bits=L.LARGE_BITS,-1;var s,o;for(a-=15,s=24;s<32&&!(B.ht[s].linmax>=a);s++);for(o=s-8;o<24&&!(B.ht[o].linmax>=a);o++);return function(t,e,r,n,a,s){var i,o=65536*B.ht[n].xlen+B.ht[a].xlen,l=0;do{var f=t[e++],_=t[e++];0!=f&&(f>14&&(f=15,l+=o),f*=16),0!=_&&(_>14&&(_=15,l+=o),f+=_),l+=B.largetbl[f]}while(e<r);return i=65535&l,(l>>=16)>i&&(l=i,n=a),s.bits+=l,n}(t,e,r,o,s,n)}}function l(t,r,n,a,s,i,l,f){for(var _=r.big_values,u=2;u<Y.SBMAX_l+1;u++){var h=t.scalefac_band.l[u];if(h>=_)break;var c=s[u-2]+r.count1bits;if(n.part2_3_length<=c)break;var p=new e(c),m=o(a,h,_,p);c=p.bits,n.part2_3_length<=c||(n.assign(r),n.part2_3_length=c,n.region0_count=i[u-2],n.region1_count=u-2-i[u-2],n.table_select[0]=l[u-2],n.table_select[1]=f[u-2],n.table_select[2]=m)}}this.noquant_count_bits=function(t,r,n){var a=r.l3_enc,s=Math.min(576,r.max_nonzero_coeff+2>>1<<1);for(null!=n&&(n.sfb_count1=0);s>1&&0==(a[s-1]|a[s-2]);s-=2);r.count1=s;for(var i=0,l=0;s>3;s-=4){var f;if((2147483647&(a[s-1]|a[s-2]|a[s-3]|a[s-4]))>1)break;f=2*(2*(2*a[s-4]+a[s-3])+a[s-2])+a[s-1],i+=B.t32l[f],l+=B.t33l[f]}var _=i;if(r.count1table_select=0,i>l&&(_=l,r.count1table_select=1),r.count1bits=_,r.big_values=s,0==s)return _;if(r.block_type==Y.SHORT_TYPE)(i=3*t.scalefac_band.s[3])>r.big_values&&(i=r.big_values),l=r.big_values;else if(r.block_type==Y.NORM_TYPE){if(i=r.region0_count=t.bv_scf[s-2],l=r.region1_count=t.bv_scf[s-1],l=t.scalefac_band.l[i+l+2],i=t.scalefac_band.l[i+1],l<s){var u=new e(_);r.table_select[2]=o(a,l,s,u),_=u.bits}}else r.region0_count=7,r.region1_count=Y.SBMAX_l-1-7-1,(i=t.scalefac_band.l[8])>(l=s)&&(i=l);if(i=Math.min(i,s),l=Math.min(l,s),0<i&&(u=new e(_),r.table_select[0]=o(a,0,i,u),_=u.bits),i<l&&(u=new e(_),r.table_select[1]=o(a,i,l,u),_=u.bits),2==t.use_best_huffman&&(r.part2_3_length=_,best_huffman_divide(t,r),_=r.part2_3_length),null!=n&&r.block_type==Y.NORM_TYPE){for(var h=0;t.scalefac_band.l[h]<r.big_values;)h++;n.sfb_count1=h}return _},this.count_bits=function(e,r,n,i){var o=n.l3_enc,l=L.IXMAX_VAL/t.IPOW20(n.global_gain);if(n.xrpow_max>l)return L.LARGE_BITS;if(function(e,r,n,i,o){var l,_,u,h=0,c=0,p=0,m=0,b=r,d=0,v=b,g=0,w=e,y=0;for(u=null!=o&&i.global_gain==o.global_gain,_=i.block_type==Y.SHORT_TYPE?38:21,l=0;l<=_;l++){var S=-1;if((u||i.block_type==Y.NORM_TYPE)&&(S=i.global_gain-(i.scalefac[l]+(0!=i.preflag?t.pretab[l]:0)<<i.scalefac_scale+1)-8*i.subblock_gain[i.window[l]]),u&&o.step[l]==S)0!=c&&(s(c,n,w,y,v,g),c=0),0!=p&&(a(p,n,w,y,v,g),p=0);else{var A,B=i.width[l];if(h+i.width[l]>i.max_nonzero_coeff&&(A=i.max_nonzero_coeff-h+1,f.fill(r,i.max_nonzero_coeff,576,0),(B=A)<0&&(B=0),l=_+1),0==c&&0==p&&(v=b,g=d,w=e,y=m),null!=o&&o.sfb_count1>0&&l>=o.sfb_count1&&o.step[l]>0&&S>=o.step[l]?(0!=c&&(s(c,n,w,y,v,g),c=0,v=b,g=d,w=e,y=m),p+=B):(0!=p&&(a(p,n,w,y,v,g),p=0,v=b,g=d,w=e,y=m),c+=B),B<=0){0!=p&&(a(p,n,w,y,v,g),p=0),0!=c&&(s(c,n,w,y,v,g),c=0);break}}l<=_&&(d+=i.width[l],m+=i.width[l],h+=i.width[l])}0!=c&&(s(c,n,w,y,v,g),c=0),0!=p&&(a(p,n,w,y,v,g),p=0)}(r,o,t.IPOW20(n.global_gain),n,i),0!=(2&e.substep_shaping))for(var _=0,u=n.global_gain+n.scalefac_scale,h=.634521682242439/t.IPOW20(u),c=0;c<n.sfbmax;c++){var p,m=n.width[c];if(0==e.pseudohalf[c])_+=m;else for(p=_,_+=m;p<_;++p)o[p]=r[p]>=h?o[p]:0}return this.noquant_count_bits(e,n,i)},this.best_huffman_divide=function(t,r){var a=new C,s=r.l3_enc,i=n(23),f=n(23),_=n(23),u=n(23);if(r.block_type!=Y.SHORT_TYPE||1!=t.mode_gr){a.assign(r),r.block_type==Y.NORM_TYPE&&(function(t,r,n,a,s,i,l){for(var f=r.big_values,_=0;_<=22;_++)a[_]=L.LARGE_BITS;for(_=0;_<16;_++){var u=t.scalefac_band.l[_+1];if(u>=f)break;var h=0,c=new e(h),p=o(n,0,u,c);h=c.bits;for(var m=0;m<8;m++){var b=t.scalefac_band.l[_+m+2];if(b>=f)break;var d=h,v=o(n,u,b,c=new e(d));d=c.bits,a[_+m]>d&&(a[_+m]=d,s[_+m]=_,i[_+m]=p,l[_+m]=v)}}}(t,r,s,i,f,_,u),l(t,a,r,s,i,f,_,u));var h=a.big_values;if(!(0==h||(s[h-2]|s[h-1])>1||(h=r.count1+2)>576)){a.assign(r),a.count1=h;for(var c=0,p=0;h>a.big_values;h-=4){var m=2*(2*(2*s[h-4]+s[h-3])+s[h-2])+s[h-1];c+=B.t32l[m],p+=B.t33l[m]}if(a.big_values=h,a.count1table_select=0,c>p&&(c=p,a.count1table_select=1),a.count1bits=c,a.block_type==Y.NORM_TYPE)l(t,a,r,s,i,f,_,u);else{if(a.part2_3_length=c,(c=t.scalefac_band.l[8])>h&&(c=h),c>0){var b=new e(a.part2_3_length);a.table_select[0]=o(s,0,c,b),a.part2_3_length=b.bits}h>c&&(b=new e(a.part2_3_length),a.table_select[1]=o(s,c,h,b),a.part2_3_length=b.bits),r.part2_3_length>a.part2_3_length&&r.assign(a)}}}};var u=[1,1,1,1,8,2,2,2,4,4,4,8,8,8,16,16],h=[1,2,4,8,1,2,4,8,2,4,8,2,4,8,4,8],c=[0,0,0,0,3,1,1,1,2,2,2,3,3,3,4,4],p=[0,1,2,3,0,1,2,3,1,2,3,1,2,3,2,3];d.slen1_tab=c,d.slen2_tab=p,this.best_scalefac_store=function(e,r,n,a){var s,i,o,l,f=a.tt[r][n],_=0;for(o=0,s=0;s<f.sfbmax;s++){var m=f.width[s];for(o+=m,l=-m;l<0&&0==f.l3_enc[l+o];l++);0==l&&(f.scalefac[s]=_=-2)}if(0==f.scalefac_scale&&0==f.preflag){var b=0;for(s=0;s<f.sfbmax;s++)f.scalefac[s]>0&&(b|=f.scalefac[s]);if(0==(1&b)&&0!=b){for(s=0;s<f.sfbmax;s++)f.scalefac[s]>0&&(f.scalefac[s]>>=1);f.scalefac_scale=_=1}}if(0==f.preflag&&f.block_type!=Y.SHORT_TYPE&&2==e.mode_gr){for(s=11;s<Y.SBPSY_l&&!(f.scalefac[s]<t.pretab[s]&&-2!=f.scalefac[s]);s++);if(s==Y.SBPSY_l){for(s=11;s<Y.SBPSY_l;s++)f.scalefac[s]>0&&(f.scalefac[s]-=t.pretab[s]);f.preflag=_=1}}for(i=0;i<4;i++)a.scfsi[n][i]=0;for(2==e.mode_gr&&1==r&&a.tt[0][n].block_type!=Y.SHORT_TYPE&&a.tt[1][n].block_type!=Y.SHORT_TYPE&&(function(t,e){for(var r,n=e.tt[1][t],a=e.tt[0][t],s=0;s<B.scfsi_band.length-1;s++){for(r=B.scfsi_band[s];r<B.scfsi_band[s+1]&&!(a.scalefac[r]!=n.scalefac[r]&&n.scalefac[r]>=0);r++);if(r==B.scfsi_band[s+1]){for(r=B.scfsi_band[s];r<B.scfsi_band[s+1];r++)n.scalefac[r]=-1;e.scfsi[t][s]=1}}var i=0,o=0;for(r=0;r<11;r++)-1!=n.scalefac[r]&&(o++,i<n.scalefac[r]&&(i=n.scalefac[r]));for(var l=0,f=0;r<Y.SBPSY_l;r++)-1!=n.scalefac[r]&&(f++,l<n.scalefac[r]&&(l=n.scalefac[r]));for(s=0;s<16;s++)if(i<u[s]&&l<h[s]){var _=c[s]*o+p[s]*f;n.part2_length>_&&(n.part2_length=_,n.scalefac_compress=s)}}(n,a),_=0),s=0;s<f.sfbmax;s++)-2==f.scalefac[s]&&(f.scalefac[s]=0);0!=_&&(2==e.mode_gr?this.scale_bitcount(f):this.scale_bitcount_lsf(e,f))};var m=[0,18,36,54,54,36,54,72,54,72,90,72,90,108,108,126],b=[0,18,36,54,51,35,53,71,52,70,88,69,87,105,104,122],v=[0,10,20,30,33,21,31,41,32,42,52,43,53,63,64,74];this.scale_bitcount=function(e){var r,n,a,s=0,i=0,o=e.scalefac;if(e.block_type==Y.SHORT_TYPE)a=m,0!=e.mixed_block_flag&&(a=b);else if(a=v,0==e.preflag){for(n=11;n<Y.SBPSY_l&&!(o[n]<t.pretab[n]);n++);if(n==Y.SBPSY_l)for(e.preflag=1,n=11;n<Y.SBPSY_l;n++)o[n]-=t.pretab[n]}for(n=0;n<e.sfbdivide;n++)s<o[n]&&(s=o[n]);for(;n<e.sfbmax;n++)i<o[n]&&(i=o[n]);for(e.part2_length=L.LARGE_BITS,r=0;r<16;r++)s<u[r]&&i<h[r]&&e.part2_length>a[r]&&(e.part2_length=a[r],e.scalefac_compress=r);return e.part2_length==L.LARGE_BITS};var g=[[15,15,7,7],[15,15,7,0],[7,3,0,0],[15,31,31,0],[7,7,7,0],[3,3,0,0]];this.scale_bitcount_lsf=function(e,r){var a,s,i,o,l,f,u,h,c=n(4),p=r.scalefac;for(a=0!=r.preflag?2:0,u=0;u<4;u++)c[u]=0;if(r.block_type==Y.SHORT_TYPE){s=1;var m=t.nr_of_sfb_block[a][s];for(h=0,i=0;i<4;i++)for(o=m[i]/3,u=0;u<o;u++,h++)for(l=0;l<3;l++)p[3*h+l]>c[i]&&(c[i]=p[3*h+l])}else for(s=0,m=t.nr_of_sfb_block[a][s],h=0,i=0;i<4;i++)for(o=m[i],u=0;u<o;u++,h++)p[h]>c[i]&&(c[i]=p[h]);for(f=!1,i=0;i<4;i++)c[i]>g[a][i]&&(f=!0);if(!f){var b,d,v,y;for(r.sfb_partition_table=t.nr_of_sfb_block[a][s],i=0;i<4;i++)r.slen[i]=w[c[i]];switch(b=r.slen[0],d=r.slen[1],v=r.slen[2],y=r.slen[3],a){case 0:r.scalefac_compress=(5*b+d<<4)+(v<<2)+y;break;case 1:r.scalefac_compress=400+(5*b+d<<2)+v;break;case 2:r.scalefac_compress=500+3*b+d;break;default:_.err.printf("intensity stereo not implemented yet\n")}}if(!f)for(r.part2_length=0,i=0;i<4;i++)r.part2_length+=r.slen[i]*r.sfb_partition_table[i];return f};var w=[0,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4];this.huffman_init=function(t){for(var e=2;e<=576;e+=2){for(var n,a=0;t.scalefac_band.l[++a]<e;);for(n=r[a][0];t.scalefac_band.l[n+1]>e;)n--;for(n<0&&(n=r[a][0]),t.bv_scf[e-2]=n,n=r[a][1];t.scalefac_band.l[n+t.bv_scf[e-2]+2]>e;)n--;n<0&&(n=r[a][1]),t.bv_scf[e-1]=n}}}function v(){}function g(){function t(t,e,r,n,a,s,i,o,l,f,_,u,h,c,p){this.vbr_q=t,this.quant_comp=e,this.quant_comp_s=r,this.expY=n,this.st_lrm=a,this.st_s=s,this.masking_adj=i,this.masking_adj_short=o,this.ath_lower=l,this.ath_curve=f,this.ath_sensitivity=_,this.interch=u,this.safejoint=h,this.sfb21mod=c,this.msfix=p}function e(t,e,r,n,a,s,i,o,l,f,_,u,h,c){this.quant_comp=e,this.quant_comp_s=r,this.safejoint=n,this.nsmsfix=a,this.st_lrm=s,this.st_s=i,this.nsbass=o,this.scale=l,this.masking_adj=f,this.ath_lower=_,this.ath_curve=u,this.interch=h,this.sfscale=c}var r;this.setModules=function(t){r=t};var n=[new t(0,9,9,0,5.2,125,-4.2,-6.3,4.8,1,0,0,2,21,.97),new t(1,9,9,0,5.3,125,-3.6,-5.6,4.5,1.5,0,0,2,21,1.35),new t(2,9,9,0,5.6,125,-2.2,-3.5,2.8,2,0,0,2,21,1.49),new t(3,9,9,1,5.8,130,-1.8,-2.8,2.6,3,-4,0,2,20,1.64),new t(4,9,9,1,6,135,-.7,-1.1,1.1,3.5,-8,0,2,0,1.79),new t(5,9,9,1,6.4,140,.5,.4,-7.5,4,-12,2e-4,0,0,1.95),new t(6,9,9,1,6.6,145,.67,.65,-14.7,6.5,-19,4e-4,0,0,2.3),new t(7,9,9,1,6.6,145,.8,.75,-19.7,8,-22,6e-4,0,0,2.7),new t(8,9,9,1,6.6,145,1.2,1.15,-27.5,10,-23,7e-4,0,0,0),new t(9,9,9,1,6.6,145,1.6,1.6,-36,11,-25,8e-4,0,0,0),new t(10,9,9,1,6.6,145,2,2,-36,12,-25,8e-4,0,0,0)],a=[new t(0,9,9,0,4.2,25,-7,-4,7.5,1,0,0,2,26,.97),new t(1,9,9,0,4.2,25,-5.6,-3.6,4.5,1.5,0,0,2,21,1.35),new t(2,9,9,0,4.2,25,-4.4,-1.8,2,2,0,0,2,18,1.49),new t(3,9,9,1,4.2,25,-3.4,-1.25,1.1,3,-4,0,2,15,1.64),new t(4,9,9,1,4.2,25,-2.2,.1,0,3.5,-8,0,2,0,1.79),new t(5,9,9,1,4.2,25,-1,1.65,-7.7,4,-12,2e-4,0,0,1.95),new t(6,9,9,1,4.2,25,-0,2.47,-7.7,6.5,-19,4e-4,0,0,2),new t(7,9,9,1,4.2,25,.5,2,-14.5,8,-22,6e-4,0,0,2),new t(8,9,9,1,4.2,25,1,2.4,-22,10,-23,7e-4,0,0,2),new t(9,9,9,1,4.2,25,1.5,2.95,-30,11,-25,8e-4,0,0,2),new t(10,9,9,1,4.2,25,2,2.95,-36,12,-30,8e-4,0,0,2)];function s(t,e,r){var s=t.VBR==p.vbr_rh?n:a,i=t.VBR_q_frac,o=s[e],l=s[e+1],f=o;o.st_lrm=o.st_lrm+i*(l.st_lrm-o.st_lrm),o.st_s=o.st_s+i*(l.st_s-o.st_s),o.masking_adj=o.masking_adj+i*(l.masking_adj-o.masking_adj),o.masking_adj_short=o.masking_adj_short+i*(l.masking_adj_short-o.masking_adj_short),o.ath_lower=o.ath_lower+i*(l.ath_lower-o.ath_lower),o.ath_curve=o.ath_curve+i*(l.ath_curve-o.ath_curve),o.ath_sensitivity=o.ath_sensitivity+i*(l.ath_sensitivity-o.ath_sensitivity),o.interch=o.interch+i*(l.interch-o.interch),o.msfix=o.msfix+i*(l.msfix-o.msfix),function(t,e){0>e&&(-1,e=0),9<e&&(-1,e=9),t.VBR_q=e,t.VBR_q_frac=0}(t,f.vbr_q),0!=r?t.quant_comp=f.quant_comp:Math.abs(t.quant_comp- -1)>0||(t.quant_comp=f.quant_comp),0!=r?t.quant_comp_short=f.quant_comp_s:Math.abs(t.quant_comp_short- -1)>0||(t.quant_comp_short=f.quant_comp_s),0!=f.expY&&(t.experimentalY=0!=f.expY),0!=r?t.internal_flags.nsPsy.attackthre=f.st_lrm:Math.abs(t.internal_flags.nsPsy.attackthre- -1)>0||(t.internal_flags.nsPsy.attackthre=f.st_lrm),0!=r?t.internal_flags.nsPsy.attackthre_s=f.st_s:Math.abs(t.internal_flags.nsPsy.attackthre_s- -1)>0||(t.internal_flags.nsPsy.attackthre_s=f.st_s),0!=r?t.maskingadjust=f.masking_adj:Math.abs(t.maskingadjust-0)>0||(t.maskingadjust=f.masking_adj),0!=r?t.maskingadjust_short=f.masking_adj_short:Math.abs(t.maskingadjust_short-0)>0||(t.maskingadjust_short=f.masking_adj_short),0!=r?t.ATHlower=-f.ath_lower/10:Math.abs(10*-t.ATHlower-0)>0||(t.ATHlower=-f.ath_lower/10),0!=r?t.ATHcurve=f.ath_curve:Math.abs(t.ATHcurve- -1)>0||(t.ATHcurve=f.ath_curve),0!=r?t.athaa_sensitivity=f.ath_sensitivity:Math.abs(t.athaa_sensitivity- -1)>0||(t.athaa_sensitivity=f.ath_sensitivity),f.interch>0&&(0!=r?t.interChRatio=f.interch:Math.abs(t.interChRatio- -1)>0||(t.interChRatio=f.interch)),f.safejoint>0&&(t.exp_nspsytune=t.exp_nspsytune|f.safejoint),f.sfb21mod>0&&(t.exp_nspsytune=t.exp_nspsytune|f.sfb21mod<<20),0!=r?t.msfix=f.msfix:Math.abs(t.msfix- -1)>0||(t.msfix=f.msfix),0==r&&(t.VBR_q=e,t.VBR_q_frac=i)}var i=[new e(8,9,9,0,0,6.6,145,0,.95,0,-30,11,.0012,1),new e(16,9,9,0,0,6.6,145,0,.95,0,-25,11,.001,1),new e(24,9,9,0,0,6.6,145,0,.95,0,-20,11,.001,1),new e(32,9,9,0,0,6.6,145,0,.95,0,-15,11,.001,1),new e(40,9,9,0,0,6.6,145,0,.95,0,-10,11,9e-4,1),new e(48,9,9,0,0,6.6,145,0,.95,0,-10,11,9e-4,1),new e(56,9,9,0,0,6.6,145,0,.95,0,-6,11,8e-4,1),new e(64,9,9,0,0,6.6,145,0,.95,0,-2,11,8e-4,1),new e(80,9,9,0,0,6.6,145,0,.95,0,0,8,7e-4,1),new e(96,9,9,0,2.5,6.6,145,0,.95,0,1,5.5,6e-4,1),new e(112,9,9,0,2.25,6.6,145,0,.95,0,2,4.5,5e-4,1),new e(128,9,9,0,1.95,6.4,140,0,.95,0,3,4,2e-4,1),new e(160,9,9,1,1.79,6,135,0,.95,-2,5,3.5,0,1),new e(192,9,9,1,1.49,5.6,125,0,.97,-4,7,3,0,0),new e(224,9,9,1,1.25,5.2,125,0,.98,-6,9,2,0,0),new e(256,9,9,1,.97,5.2,125,0,1,-8,10,1,0,0),new e(320,9,9,1,.9,5.2,125,0,1,-10,12,0,0,0)];function o(t,e,n){var a=e,s=r.nearestBitrateFullIndex(e);if(t.VBR=p.vbr_abr,t.VBR_mean_bitrate_kbps=a,t.VBR_mean_bitrate_kbps=Math.min(t.VBR_mean_bitrate_kbps,320),t.VBR_mean_bitrate_kbps=Math.max(t.VBR_mean_bitrate_kbps,8),t.brate=t.VBR_mean_bitrate_kbps,t.VBR_mean_bitrate_kbps>320&&(t.disable_reservoir=!0),i[s].safejoint>0&&(t.exp_nspsytune=2|t.exp_nspsytune),i[s].sfscale>0&&(t.internal_flags.noise_shaping=2),Math.abs(i[s].nsbass)>0){var o=int(4*i[s].nsbass);o<0&&(o+=64),t.exp_nspsytune=t.exp_nspsytune|o<<2}return 0!=n?t.quant_comp=i[s].quant_comp:Math.abs(t.quant_comp- -1)>0||(t.quant_comp=i[s].quant_comp),0!=n?t.quant_comp_short=i[s].quant_comp_s:Math.abs(t.quant_comp_short- -1)>0||(t.quant_comp_short=i[s].quant_comp_s),0!=n?t.msfix=i[s].nsmsfix:Math.abs(t.msfix- -1)>0||(t.msfix=i[s].nsmsfix),0!=n?t.internal_flags.nsPsy.attackthre=i[s].st_lrm:Math.abs(t.internal_flags.nsPsy.attackthre- -1)>0||(t.internal_flags.nsPsy.attackthre=i[s].st_lrm),0!=n?t.internal_flags.nsPsy.attackthre_s=i[s].st_s:Math.abs(t.internal_flags.nsPsy.attackthre_s- -1)>0||(t.internal_flags.nsPsy.attackthre_s=i[s].st_s),0!=n?t.scale=i[s].scale:Math.abs(t.scale- -1)>0||(t.scale=i[s].scale),0!=n?t.maskingadjust=i[s].masking_adj:Math.abs(t.maskingadjust-0)>0||(t.maskingadjust=i[s].masking_adj),i[s].masking_adj>0?0!=n?t.maskingadjust_short=.9*i[s].masking_adj:Math.abs(t.maskingadjust_short-0)>0||(t.maskingadjust_short=.9*i[s].masking_adj):0!=n?t.maskingadjust_short=1.1*i[s].masking_adj:Math.abs(t.maskingadjust_short-0)>0||(t.maskingadjust_short=1.1*i[s].masking_adj),0!=n?t.ATHlower=-i[s].ath_lower/10:Math.abs(10*-t.ATHlower-0)>0||(t.ATHlower=-i[s].ath_lower/10),0!=n?t.ATHcurve=i[s].ath_curve:Math.abs(t.ATHcurve- -1)>0||(t.ATHcurve=i[s].ath_curve),0!=n?t.interChRatio=i[s].interch:Math.abs(t.interChRatio- -1)>0||(t.interChRatio=i[s].interch),e}this.apply_preset=function(t,e,r){switch(e){case Z.R3MIX:e=Z.V3,t.VBR=p.vbr_mtrh;break;case Z.MEDIUM:e=Z.V4,t.VBR=p.vbr_rh;break;case Z.MEDIUM_FAST:e=Z.V4,t.VBR=p.vbr_mtrh;break;case Z.STANDARD:e=Z.V2,t.VBR=p.vbr_rh;break;case Z.STANDARD_FAST:e=Z.V2,t.VBR=p.vbr_mtrh;break;case Z.EXTREME:e=Z.V0,t.VBR=p.vbr_rh;break;case Z.EXTREME_FAST:e=Z.V0,t.VBR=p.vbr_mtrh;break;case Z.INSANE:return e=320,t.preset=e,o(t,e,r),t.VBR=p.vbr_off,e}switch(t.preset=e,e){case Z.V9:return s(t,9,r),e;case Z.V8:return s(t,8,r),e;case Z.V7:return s(t,7,r),e;case Z.V6:return s(t,6,r),e;case Z.V5:return s(t,5,r),e;case Z.V4:return s(t,4,r),e;case Z.V3:return s(t,3,r),e;case Z.V2:return s(t,2,r),e;case Z.V1:return s(t,1,r),e;case Z.V0:return s(t,0,r),e}return 8<=e&&e<=320?o(t,e,r):(t.preset=0,e)}}function w(){var t;this.setModules=function(e){t=e},this.ResvFrameBegin=function(e,r){var n,a=e.internal_flags,s=a.l3_side,i=t.getframebits(e);r.bits=(i-8*a.sideinfo_len)/a.mode_gr;var o=2048*a.mode_gr-8;e.brate>320?n=8*int(1e3*e.brate/(e.out_samplerate/1152)/8+.5):(n=11520,e.strict_ISO&&(n=8*int(32e4/(e.out_samplerate/1152)/8+.5))),a.ResvMax=n-i,a.ResvMax>o&&(a.ResvMax=o),(a.ResvMax<0||e.disable_reservoir)&&(a.ResvMax=0);var l=r.bits*a.mode_gr+Math.min(a.ResvSize,a.ResvMax);return l>n&&(l=n),s.resvDrain_pre=0,null!=a.pinfo&&(a.pinfo.mean_bits=r.bits/2,a.pinfo.resvsize=a.ResvSize),l},this.ResvMaxBits=function(t,e,r,n){var a,s=t.internal_flags,i=s.ResvSize,o=s.ResvMax;0!=n&&(i+=e),0!=(1&s.substep_shaping)&&(o*=.9),r.bits=e,10*i>9*o?(a=i-9*o/10,r.bits+=a,s.substep_shaping|=128):(a=0,s.substep_shaping&=127,t.disable_reservoir||0!=(1&s.substep_shaping)||(r.bits-=.1*e));var l=i<6*s.ResvMax/10?i:6*s.ResvMax/10;return(l-=a)<0&&(l=0),l},this.ResvAdjust=function(t,e){t.ResvSize-=e.part2_3_length+e.part2_length},this.ResvFrameEnd=function(t,e){var r,n=t.l3_side;t.ResvSize+=e*t.mode_gr;var a=0;n.resvDrain_post=0,n.resvDrain_pre=0,0!=(r=t.ResvSize%8)&&(a+=r),(r=t.ResvSize-a-t.ResvMax)>0&&(a+=r);var s=Math.min(8*n.main_data_begin,a)/8;n.resvDrain_pre+=8*s,a-=8*s,t.ResvSize-=8*s,n.main_data_begin-=s,n.resvDrain_post+=a,t.ResvSize-=a}}function y(){this.setModules=function(t,e,r){};var t=[0,49345,49537,320,49921,960,640,49729,50689,1728,1920,51009,1280,50625,50305,1088,52225,3264,3456,52545,3840,53185,52865,3648,2560,51905,52097,2880,51457,2496,2176,51265,55297,6336,6528,55617,6912,56257,55937,6720,7680,57025,57217,8e3,56577,7616,7296,56385,5120,54465,54657,5440,55041,6080,5760,54849,53761,4800,4992,54081,4352,53697,53377,4160,61441,12480,12672,61761,13056,62401,62081,12864,13824,63169,63361,14144,62721,13760,13440,62529,15360,64705,64897,15680,65281,16320,16e3,65089,64001,15040,15232,64321,14592,63937,63617,14400,10240,59585,59777,10560,60161,11200,10880,59969,60929,11968,12160,61249,11520,60865,60545,11328,58369,9408,9600,58689,9984,59329,59009,9792,8704,58049,58241,9024,57601,8640,8320,57409,40961,24768,24960,41281,25344,41921,41601,25152,26112,42689,42881,26432,42241,26048,25728,42049,27648,44225,44417,27968,44801,28608,28288,44609,43521,27328,27520,43841,26880,43457,43137,26688,30720,47297,47489,31040,47873,31680,31360,47681,48641,32448,32640,48961,32e3,48577,48257,31808,46081,29888,30080,46401,30464,47041,46721,30272,29184,45761,45953,29504,45313,29120,28800,45121,20480,37057,37249,20800,37633,21440,21120,37441,38401,22208,22400,38721,21760,38337,38017,21568,39937,23744,23936,40257,24320,40897,40577,24128,23040,39617,39809,23360,39169,22976,22656,38977,34817,18624,18816,35137,19200,35777,35457,19008,19968,36545,36737,20288,36097,19904,19584,35905,17408,33985,34177,17728,34561,18368,18048,34369,33281,17088,17280,33601,16640,33217,32897,16448];function e(e,r){return r>>8^t[255&(r^e)]}this.updateMusicCRC=function(t,r,n,a){for(var s=0;s<a;++s)t[0]=e(r[n+s],t[0])}}function S(){var t=this,a=null,i=null,o=null,l=null;this.setModules=function(t,e,r,n){a=t,i=e,o=r,l=n};var u=null,h=0,c=0,p=0;function m(t){_.arraycopy(t.header[t.w_ptr].buf,0,u,c,t.sideinfo_len),c+=t.sideinfo_len,h+=8*t.sideinfo_len,t.w_ptr=t.w_ptr+1&X.MAX_HEADER_BUF-1}function b(t,e,r){for(;r>0;){var n;0==p&&(p=8,c++,t.header[t.w_ptr].write_timing==h&&m(t),u[c]=0),r-=n=Math.min(r,p),p-=n,u[c]|=e>>r<<p,h+=n}}function g(t,e,r){for(;r>0;){var n;0==p&&(p=8,c++,u[c]=0),r-=n=Math.min(r,p),p-=n,u[c]|=e>>r<<p,h+=n}}function w(t,e){var r,n=t.internal_flags;if(e>=8&&(b(n,76,8),e-=8),e>=8&&(b(n,65,8),e-=8),e>=8&&(b(n,77,8),e-=8),e>=8&&(b(n,69,8),e-=8),e>=32){var a=o.getLameShortVersion();if(e>=32)for(r=0;r<a.length&&e>=8;++r)e-=8,b(n,a.charCodeAt(r),8)}for(;e>=1;e-=1)b(n,n.ancillary_flag,1),n.ancillary_flag^=t.disable_reservoir?0:1}function y(t,e,r){for(var n=t.header[t.h_ptr].ptr;r>0;){var a=Math.min(r,8-(7&n));r-=a,t.header[t.h_ptr].buf[n>>3]|=e>>r<<8-(7&n)-a,n+=a}t.header[t.h_ptr].ptr=n}function S(t,e){t<<=8;for(var r=0;r<8;r++)0!=(65536&((e<<=1)^(t<<=1)))&&(e^=32773);return e}function A(t,e){var r,n=B.ht[e.count1table_select+32],a=0,s=e.big_values,i=e.big_values;for(r=(e.count1-e.big_values)/4;r>0;--r){var o=0,l=0;0!=e.l3_enc[s+0]&&(l+=8,e.xr[i+0]<0&&o++),0!=e.l3_enc[s+1]&&(l+=4,o*=2,e.xr[i+1]<0&&o++),0!=e.l3_enc[s+2]&&(l+=2,o*=2,e.xr[i+2]<0&&o++),0!=e.l3_enc[s+3]&&(l++,o*=2,e.xr[i+3]<0&&o++),s+=4,i+=4,b(t,o+n.table[l],n.hlen[l]),a+=n.hlen[l]}return a}function M(t,e,r,n,a){var s=B.ht[e],i=0;if(0==e)return i;for(var o=r;o<n;o+=2){var l=0,f=0,_=s.xlen,u=s.xlen,h=0,c=a.l3_enc[o],p=a.l3_enc[o+1];0!=c&&(a.xr[o]<0&&h++,l--),e>15&&(c>14&&(h|=c-15<<1,f=_,c=15),p>14&&(h<<=_,h|=p-15,f+=_,p=15),u=16),0!=p&&(h<<=1,a.xr[o+1]<0&&h++,l--),c=c*u+p,f-=l,l+=s.hlen[c],b(t,s.table[c],l),b(t,h,f),i+=l+f}return i}function R(t,e){var r=3*t.scalefac_band.s[3];return r>e.big_values&&(r=e.big_values),M(t,e.table_select[0],0,r,e)+M(t,e.table_select[1],r,e.big_values,e)}function E(t,e){var r,n,a,s;r=e.big_values;var i=e.region0_count+1;return a=t.scalefac_band.l[i],i+=e.region1_count+1,a>r&&(a=r),(s=t.scalefac_band.l[i])>r&&(s=r),n=M(t,e.table_select[0],0,a,e),(n+=M(t,e.table_select[1],a,s,e))+M(t,e.table_select[2],s,r,e)}function T(){this.total=0}function x(e,r){var n,a,s,i,o,l=e.internal_flags;return o=l.w_ptr,-1==(i=l.h_ptr-1)&&(i=X.MAX_HEADER_BUF-1),n=l.header[i].write_timing-h,r.total=n,n>=0&&(a=1+i-o,i<o&&(a=1+i-o+X.MAX_HEADER_BUF),n-=8*a*l.sideinfo_len),n+=s=t.getframebits(e),r.total+=s,r.total%8!=0?r.total=1+r.total/8:r.total=r.total/8,r.total+=c+1,n<0&&_.err.println("strange error flushing buffer ... \n"),n}this.getframebits=function(t){var e,r=t.internal_flags;return e=0!=r.bitrate_index?B.bitrate_table[t.version][r.bitrate_index]:t.brate,8*(0|72e3*(t.version+1)*e/t.out_samplerate+r.padding)},this.CRC_writeheader=function(t,e){var r=65535;r=S(255&e[2],r),r=S(255&e[3],r);for(var n=6;n<t.sideinfo_len;n++)r=S(255&e[n],r);e[4]=byte(r>>8),e[5]=byte(255&r)},this.flush_bitstream=function(t){var r,n,s=t.internal_flags,i=s.h_ptr-1;if(-1==i&&(i=X.MAX_HEADER_BUF-1),r=s.l3_side,!((n=x(t,new T))<0)){if(w(t,n),s.ResvSize=0,r.main_data_begin=0,s.findReplayGain){var o=a.GetTitleGain(s.rgdata);s.RadioGain=0|Math.floor(10*o+.5)}s.findPeakSample&&(s.noclipGainChange=0|Math.ceil(20*e(s.PeakSample/32767)*10),s.noclipGainChange>0&&(EQ(t.scale,1)||EQ(t.scale,0))?s.noclipScale=Math.floor(32767/s.PeakSample*100)/100:s.noclipScale=-1)}},this.add_dummy_byte=function(t,e,r){for(var n,a=t.internal_flags;r-- >0;)for(g(0,e,8),n=0;n<X.MAX_HEADER_BUF;++n)a.header[n].write_timing+=8},this.format_bitstream=function(t){var e,r=t.internal_flags;e=r.l3_side;var n=this.getframebits(t);w(t,e.resvDrain_pre),function(t,e){var r,n,a,s=t.internal_flags;if(r=s.l3_side,s.header[s.h_ptr].ptr=0,f.fill(s.header[s.h_ptr].buf,0,s.sideinfo_len,0),t.out_samplerate<16e3?y(s,4094,12):y(s,4095,12),y(s,t.version,1),y(s,1,2),y(s,t.error_protection?0:1,1),y(s,s.bitrate_index,4),y(s,s.samplerate_index,2),y(s,s.padding,1),y(s,t.extension,1),y(s,t.mode.ordinal(),2),y(s,s.mode_ext,2),y(s,t.copyright,1),y(s,t.original,1),y(s,t.emphasis,2),t.error_protection&&y(s,0,16),1==t.version){for(y(s,r.main_data_begin,9),2==s.channels_out?y(s,r.private_bits,3):y(s,r.private_bits,5),a=0;a<s.channels_out;a++){var i;for(i=0;i<4;i++)y(s,r.scfsi[a][i],1)}for(n=0;n<2;n++)for(a=0;a<s.channels_out;a++)y(s,(o=r.tt[n][a]).part2_3_length+o.part2_length,12),y(s,o.big_values/2,9),y(s,o.global_gain,8),y(s,o.scalefac_compress,4),o.block_type!=Y.NORM_TYPE?(y(s,1,1),y(s,o.block_type,2),y(s,o.mixed_block_flag,1),14==o.table_select[0]&&(o.table_select[0]=16),y(s,o.table_select[0],5),14==o.table_select[1]&&(o.table_select[1]=16),y(s,o.table_select[1],5),y(s,o.subblock_gain[0],3),y(s,o.subblock_gain[1],3),y(s,o.subblock_gain[2],3)):(y(s,0,1),14==o.table_select[0]&&(o.table_select[0]=16),y(s,o.table_select[0],5),14==o.table_select[1]&&(o.table_select[1]=16),y(s,o.table_select[1],5),14==o.table_select[2]&&(o.table_select[2]=16),y(s,o.table_select[2],5),y(s,o.region0_count,4),y(s,o.region1_count,3)),y(s,o.preflag,1),y(s,o.scalefac_scale,1),y(s,o.count1table_select,1)}else for(y(s,r.main_data_begin,8),y(s,r.private_bits,s.channels_out),n=0,a=0;a<s.channels_out;a++){var o;y(s,(o=r.tt[n][a]).part2_3_length+o.part2_length,12),y(s,o.big_values/2,9),y(s,o.global_gain,8),y(s,o.scalefac_compress,9),o.block_type!=Y.NORM_TYPE?(y(s,1,1),y(s,o.block_type,2),y(s,o.mixed_block_flag,1),14==o.table_select[0]&&(o.table_select[0]=16),y(s,o.table_select[0],5),14==o.table_select[1]&&(o.table_select[1]=16),y(s,o.table_select[1],5),y(s,o.subblock_gain[0],3),y(s,o.subblock_gain[1],3),y(s,o.subblock_gain[2],3)):(y(s,0,1),14==o.table_select[0]&&(o.table_select[0]=16),y(s,o.table_select[0],5),14==o.table_select[1]&&(o.table_select[1]=16),y(s,o.table_select[1],5),14==o.table_select[2]&&(o.table_select[2]=16),y(s,o.table_select[2],5),y(s,o.region0_count,4),y(s,o.region1_count,3)),y(s,o.scalefac_scale,1),y(s,o.count1table_select,1)}t.error_protection&&CRC_writeheader(s,s.header[s.h_ptr].buf);var l=s.h_ptr;s.h_ptr=l+1&X.MAX_HEADER_BUF-1,s.header[s.h_ptr].write_timing=s.header[l].write_timing+e,s.h_ptr==s.w_ptr&&_.err.println("Error: MAX_HEADER_BUF too small in bitstream.c \n")}(t,n);var a=8*r.sideinfo_len;if(a+=function(t){var e,r,n,a,s=0,i=t.internal_flags,o=i.l3_side;if(1==t.version)for(e=0;e<2;e++)for(r=0;r<i.channels_out;r++){var l=o.tt[e][r],f=d.slen1_tab[l.scalefac_compress],_=d.slen2_tab[l.scalefac_compress];for(a=0,n=0;n<l.sfbdivide;n++)-1!=l.scalefac[n]&&(b(i,l.scalefac[n],f),a+=f);for(;n<l.sfbmax;n++)-1!=l.scalefac[n]&&(b(i,l.scalefac[n],_),a+=_);l.block_type==Y.SHORT_TYPE?a+=R(i,l):a+=E(i,l),s+=a+=A(i,l)}else for(e=0,r=0;r<i.channels_out;r++){var u,h,c=0;if(a=0,n=0,h=0,(l=o.tt[e][r]).block_type==Y.SHORT_TYPE){for(;h<4;h++){var p=l.sfb_partition_table[h]/3,m=l.slen[h];for(u=0;u<p;u++,n++)b(i,Math.max(l.scalefac[3*n+0],0),m),b(i,Math.max(l.scalefac[3*n+1],0),m),b(i,Math.max(l.scalefac[3*n+2],0),m),c+=3*m}a+=R(i,l)}else{for(;h<4;h++)for(p=l.sfb_partition_table[h],m=l.slen[h],u=0;u<p;u++,n++)b(i,Math.max(l.scalefac[n],0),m),c+=m;a+=E(i,l)}s+=c+(a+=A(i,l))}return s}(t),w(t,e.resvDrain_post),a+=e.resvDrain_post,e.main_data_begin+=(n-a)/8,x(t,new T)!=r.ResvSize&&_.err.println("Internal buffer inconsistency. flushbits <> ResvSize"),8*e.main_data_begin!=r.ResvSize&&(_.err.printf("bit reservoir error: \nl3_side.main_data_begin: %d \nResvoir size:             %d \nresv drain (post)         %d \nresv drain (pre)          %d \nheader and sideinfo:      %d \ndata bits:                %d \ntotal bits:               %d (remainder: %d) \nbitsperframe:             %d \n",8*e.main_data_begin,r.ResvSize,e.resvDrain_post,e.resvDrain_pre,8*r.sideinfo_len,a-e.resvDrain_post-8*r.sideinfo_len,a,a%8,n),_.err.println("This is a fatal error.  It has several possible causes:"),_.err.println("90%%  LAME compiled with buggy version of gcc using advanced optimizations"),_.err.println(" 9%%  Your system is overclocked"),_.err.println(" 1%%  bug in LAME encoding library"),r.ResvSize=8*e.main_data_begin),h>1e9){var s;for(s=0;s<X.MAX_HEADER_BUF;++s)r.header[s].write_timing-=h;h=0}return 0},this.copy_buffer=function(t,e,r,o,f){var h=c+1;if(h<=0)return 0;if(0!=o&&h>o)return-1;if(_.arraycopy(u,0,e,r,h),c=-1,p=0,0!=f){var m=n(1);if(m[0]=t.nMusicCRC,l.updateMusicCRC(m,e,r,h),t.nMusicCRC=m[0],h>0&&(t.VBR_seek_table.nBytesWritten+=h),t.decode_on_the_fly)for(var b,d=s([2,1152]),g=h,w=-1;0!=w;)if(w=i.hip_decode1_unclipped(t.hip,e,r,g,d[0],d[1]),g=0,-1==w&&(w=0),w>0){if(t.findPeakSample){for(b=0;b<w;b++)d[0][b]>t.PeakSample?t.PeakSample=d[0][b]:-d[0][b]>t.PeakSample&&(t.PeakSample=-d[0][b]);if(t.channels_out>1)for(b=0;b<w;b++)d[1][b]>t.PeakSample?t.PeakSample=d[1][b]:-d[1][b]>t.PeakSample&&(t.PeakSample=-d[1][b])}if(t.findReplayGain&&a.AnalyzeSamples(t.rgdata,d[0],0,d[1],0,w,t.channels_out)==v.GAIN_ANALYSIS_ERROR)return-6}}return h},this.init_bit_stream_w=function(t){u=r(Z.LAME_MAXMP3BUFFER),t.h_ptr=t.w_ptr=0,t.header[t.h_ptr].write_timing=0,c=-1,p=0,h=0}}function A(t,e,r,n){this.xlen=t,this.linmax=e,this.table=r,this.hlen=n}c.MAX_VALUE=34028235e31,p.vbr_off=new p(0),p.vbr_mt=new p(1),p.vbr_rh=new p(2),p.vbr_abr=new p(3),p.vbr_mtrh=new p(4),p.vbr_default=p.vbr_mtrh,m.STEREO=new m(0),m.JOINT_STEREO=new m(1),m.DUAL_CHANNEL=new m(2),m.MONO=new m(3),m.NOT_SET=new m(4),v.STEPS_per_dB=100,v.MAX_dB=120,v.GAIN_NOT_ENOUGH_SAMPLES=-24601,v.GAIN_ANALYSIS_ERROR=0,v.GAIN_ANALYSIS_OK=1,v.INIT_GAIN_ANALYSIS_ERROR=0,v.INIT_GAIN_ANALYSIS_OK=1,v.YULE_ORDER=10,v.MAX_ORDER=v.YULE_ORDER,v.MAX_SAMP_FREQ=48e3,v.RMS_WINDOW_TIME_NUMERATOR=1,v.RMS_WINDOW_TIME_DENOMINATOR=20,v.MAX_SAMPLES_PER_WINDOW=v.MAX_SAMP_FREQ*v.RMS_WINDOW_TIME_NUMERATOR/v.RMS_WINDOW_TIME_DENOMINATOR+1,y.NUMTOCENTRIES=100,y.MAXFRAMESIZE=2880,S.EQ=function(t,e){return Math.abs(t)>Math.abs(e)?Math.abs(t-e)<=1e-6*Math.abs(t):Math.abs(t-e)<=1e-6*Math.abs(e)},S.NEQ=function(t,e){return!S.EQ(t,e)};var B={};function M(t){this.bits=t}function R(){this.over_noise=0,this.tot_noise=0,this.max_noise=0,this.over_count=0,this.over_SSD=0,this.bits=0}function E(){this.setModules=function(t,e){}}function T(){this.useAdjust=0,this.aaSensitivityP=0,this.adjust=0,this.adjustLimit=0,this.decay=0,this.floor=0,this.l=a(Y.SBMAX_l),this.s=a(Y.SBMAX_s),this.psfb21=a(Y.PSFB21),this.psfb12=a(Y.PSFB12),this.cb_l=a(Y.CBANDS),this.cb_s=a(Y.CBANDS),this.eql_w=a(Y.BLKSIZE/2)}function x(){this.class_id=0,this.num_samples=0,this.num_channels=0,this.in_samplerate=0,this.out_samplerate=0,this.scale=0,this.scale_left=0,this.scale_right=0,this.analysis=!1,this.bWriteVbrTag=!1,this.decode_only=!1,this.quality=0,this.mode=m.STEREO,this.force_ms=!1,this.free_format=!1,this.findReplayGain=!1,this.decode_on_the_fly=!1,this.write_id3tag_automatic=!1,this.brate=0,this.compression_ratio=0,this.copyright=0,this.original=0,this.extension=0,this.emphasis=0,this.error_protection=0,this.strict_ISO=!1,this.disable_reservoir=!1,this.quant_comp=0,this.quant_comp_short=0,this.experimentalY=!1,this.experimentalZ=0,this.exp_nspsytune=0,this.preset=0,this.VBR=null,this.VBR_q_frac=0,this.VBR_q=0,this.VBR_mean_bitrate_kbps=0,this.VBR_min_bitrate_kbps=0,this.VBR_max_bitrate_kbps=0,this.VBR_hard_min=0,this.lowpassfreq=0,this.highpassfreq=0,this.lowpasswidth=0,this.highpasswidth=0,this.maskingadjust=0,this.maskingadjust_short=0,this.ATHonly=!1,this.ATHshort=!1,this.noATH=!1,this.ATHtype=0,this.ATHcurve=0,this.ATHlower=0,this.athaa_type=0,this.athaa_loudapprox=0,this.athaa_sensitivity=0,this.short_blocks=null,this.useTemporal=!1,this.interChRatio=0,this.msfix=0,this.tune=!1,this.tune_value_a=0,this.version=0,this.encoder_delay=0,this.encoder_padding=0,this.framesize=0,this.frameNum=0,this.lame_allocated_gfp=0,this.internal_flags=null}function k(t){var e=t;this.quantize=e,this.iteration_loop=function(t,e,r,s){var i,o=t.internal_flags,l=a(N.SFBMAX),f=a(576),_=n(2),u=0,h=o.l3_side,c=new M(u);this.quantize.rv.ResvFrameBegin(t,c),u=c.bits;for(var p=0;p<o.mode_gr;p++){i=this.quantize.qupvt.on_pe(t,e,_,u,p,p),o.mode_ext==Y.MPG_MD_MS_LR&&(this.quantize.ms_convert(o.l3_side,p),this.quantize.qupvt.reduce_side(_,r[p],u,i));for(var m=0;m<o.channels_out;m++){var b,d,v=h.tt[p][m];v.block_type!=Y.SHORT_TYPE?(b=0,d=o.PSY.mask_adjust-b):(b=0,d=o.PSY.mask_adjust_short-b),o.masking_lower=Math.pow(10,.1*d),this.quantize.init_outer_loop(o,v),this.quantize.init_xrpow(o,v,f)&&(this.quantize.qupvt.calc_xmin(t,s[p][m],v,l),this.quantize.outer_loop(t,v,l,f,m,_[m])),this.quantize.iteration_finish_one(o,p,m)}}this.quantize.rv.ResvFrameEnd(o,u)}}function P(){}function I(t,e,r,a){this.l=n(1+Y.SBMAX_l),this.s=n(1+Y.SBMAX_s),this.psfb21=n(1+Y.PSFB21),this.psfb12=n(1+Y.PSFB12);var s=this.l,i=this.s;4==arguments.length&&(this.arrL=arguments[0],this.arrS=arguments[1],this.arr21=arguments[2],this.arr12=arguments[3],_.arraycopy(this.arrL,0,s,0,Math.min(this.arrL.length,this.l.length)),_.arraycopy(this.arrS,0,i,0,Math.min(this.arrS.length,this.s.length)),_.arraycopy(this.arr21,0,this.psfb21,0,Math.min(this.arr21.length,this.psfb21.length)),_.arraycopy(this.arr12,0,this.psfb12,0,Math.min(this.arr12.length,this.psfb12.length)))}function L(){var t=null,r=null,s=null;this.setModules=function(e,n,a){t=e,r=n,s=a},this.IPOW20=function(t){return m[t]};var i=2220446049250313e-31,o=L.IXMAX_VAL+2,l=L.Q_MAX,f=L.Q_MAX2;L.LARGE_BITS,this.nr_of_sfb_block=[[[6,5,5,5],[9,9,9,9],[6,9,9,9]],[[6,5,7,3],[9,9,12,6],[6,9,12,6]],[[11,10,0,0],[18,18,0,0],[15,18,0,0]],[[7,7,7,0],[12,12,12,0],[6,15,12,0]],[[6,6,6,3],[12,9,9,6],[6,12,9,6]],[[8,8,5,0],[15,12,9,0],[6,18,9,0]]];var _=[0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,2,2,3,3,3,2,0];this.pretab=_,this.sfBandIndex=[new I([0,6,12,18,24,30,36,44,54,66,80,96,116,140,168,200,238,284,336,396,464,522,576],[0,4,8,12,18,24,32,42,56,74,100,132,174,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new I([0,6,12,18,24,30,36,44,54,66,80,96,114,136,162,194,232,278,332,394,464,540,576],[0,4,8,12,18,26,36,48,62,80,104,136,180,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new I([0,6,12,18,24,30,36,44,54,66,80,96,116,140,168,200,238,284,336,396,464,522,576],[0,4,8,12,18,26,36,48,62,80,104,134,174,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new I([0,4,8,12,16,20,24,30,36,44,52,62,74,90,110,134,162,196,238,288,342,418,576],[0,4,8,12,16,22,30,40,52,66,84,106,136,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new I([0,4,8,12,16,20,24,30,36,42,50,60,72,88,106,128,156,190,230,276,330,384,576],[0,4,8,12,16,22,28,38,50,64,80,100,126,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new I([0,4,8,12,16,20,24,30,36,44,54,66,82,102,126,156,194,240,296,364,448,550,576],[0,4,8,12,16,22,30,42,58,78,104,138,180,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new I([0,6,12,18,24,30,36,44,54,66,80,96,116,140,168,200,238,284,336,396,464,522,576],[0,4,8,12,18,26,36,48,62,80,104,134,174,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new I([0,6,12,18,24,30,36,44,54,66,80,96,116,140,168,200,238,284,336,396,464,522,576],[0,4,8,12,18,26,36,48,62,80,104,134,174,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new I([0,12,24,36,48,60,72,88,108,132,160,192,232,280,336,400,476,566,568,570,572,574,576],[0,8,16,24,36,52,72,96,124,160,162,164,166,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0])];var h=a(l+f+1),m=a(l),b=a(o),d=a(o);function v(t,e){var r=s.ATHformula(e,t);return r-=100,Math.pow(10,r/10+t.ATHlower)}function g(t){this.s=t}this.adj43=d,this.iteration_init=function(r){var n,a=r.internal_flags,s=a.l3_side;if(0==a.iteration_init_init){for(a.iteration_init_init=1,s.main_data_begin=0,function(t){for(var r=t.internal_flags.ATH.l,n=t.internal_flags.ATH.psfb21,a=t.internal_flags.ATH.s,s=t.internal_flags.ATH.psfb12,i=t.internal_flags,o=t.out_samplerate,l=0;l<Y.SBMAX_l;l++){var f=i.scalefac_band.l[l],_=i.scalefac_band.l[l+1];r[l]=c.MAX_VALUE;for(var u=f;u<_;u++){var h=v(t,u*o/1152);r[l]=Math.min(r[l],h)}}for(l=0;l<Y.PSFB21;l++)for(f=i.scalefac_band.psfb21[l],_=i.scalefac_band.psfb21[l+1],n[l]=c.MAX_VALUE,u=f;u<_;u++)h=v(t,u*o/1152),n[l]=Math.min(n[l],h);for(l=0;l<Y.SBMAX_s;l++){for(f=i.scalefac_band.s[l],_=i.scalefac_band.s[l+1],a[l]=c.MAX_VALUE,u=f;u<_;u++)h=v(t,u*o/384),a[l]=Math.min(a[l],h);a[l]*=i.scalefac_band.s[l+1]-i.scalefac_band.s[l]}for(l=0;l<Y.PSFB12;l++){for(f=i.scalefac_band.psfb12[l],_=i.scalefac_band.psfb12[l+1],s[l]=c.MAX_VALUE,u=f;u<_;u++)h=v(t,u*o/384),s[l]=Math.min(s[l],h);s[l]*=i.scalefac_band.s[13]-i.scalefac_band.s[12]}if(t.noATH){for(l=0;l<Y.SBMAX_l;l++)r[l]=1e-20;for(l=0;l<Y.PSFB21;l++)n[l]=1e-20;for(l=0;l<Y.SBMAX_s;l++)a[l]=1e-20;for(l=0;l<Y.PSFB12;l++)s[l]=1e-20}i.ATH.floor=10*e(v(t,-1))}(r),b[0]=0,n=1;n<o;n++)b[n]=Math.pow(n,4/3);for(n=0;n<o-1;n++)d[n]=n+1-Math.pow(.5*(b[n]+b[n+1]),.75);for(d[n]=.5,n=0;n<l;n++)m[n]=Math.pow(2,-.1875*(n-210));for(n=0;n<=l+f;n++)h[n]=Math.pow(2,.25*(n-210-f));var i,_,u,p;for(t.huffman_init(a),(n=r.exp_nspsytune>>2&63)>=32&&(n-=64),i=Math.pow(10,n/4/10),(n=r.exp_nspsytune>>8&63)>=32&&(n-=64),_=Math.pow(10,n/4/10),(n=r.exp_nspsytune>>14&63)>=32&&(n-=64),u=Math.pow(10,n/4/10),(n=r.exp_nspsytune>>20&63)>=32&&(n-=64),p=u*Math.pow(10,n/4/10),n=0;n<Y.SBMAX_l;n++)g=n<=6?i:n<=13?_:n<=20?u:p,a.nsPsy.longfact[n]=g;for(n=0;n<Y.SBMAX_s;n++){var g;g=n<=5?i:n<=10?_:n<=11?u:p,a.nsPsy.shortfact[n]=g}}},this.on_pe=function(t,e,a,s,i,o){var l,f,_=t.internal_flags,u=0,h=n(2),c=new M(u),p=r.ResvMaxBits(t,s,c,o),m=(u=c.bits)+p;for(m>X.MAX_BITS_PER_GRANULE&&(m=X.MAX_BITS_PER_GRANULE),l=0,f=0;f<_.channels_out;++f)a[f]=Math.min(X.MAX_BITS_PER_CHANNEL,u/_.channels_out),h[f]=0|a[f]*e[i][f]/700-a[f],h[f]>3*s/4&&(h[f]=3*s/4),h[f]<0&&(h[f]=0),h[f]+a[f]>X.MAX_BITS_PER_CHANNEL&&(h[f]=Math.max(0,X.MAX_BITS_PER_CHANNEL-a[f])),l+=h[f];if(l>p)for(f=0;f<_.channels_out;++f)h[f]=p*h[f]/l;for(f=0;f<_.channels_out;++f)a[f]+=h[f],p-=h[f];for(l=0,f=0;f<_.channels_out;++f)l+=a[f];if(l>X.MAX_BITS_PER_GRANULE)for(f=0;f<_.channels_out;++f)a[f]*=X.MAX_BITS_PER_GRANULE,a[f]/=l,a[f];return m},this.reduce_side=function(t,e,r,n){var a=.33*(.5-e)/.5;a<0&&(a=0),a>.5&&(a=.5);var s=0|.5*a*(t[0]+t[1]);s>X.MAX_BITS_PER_CHANNEL-t[0]&&(s=X.MAX_BITS_PER_CHANNEL-t[0]),s<0&&(s=0),t[1]>=125&&(t[1]-s>125?(t[0]<r&&(t[0]+=s),t[1]-=s):(t[0]+=t[1]-125,t[1]=125)),(s=t[0]+t[1])>n&&(t[0]=n*t[0]/s,t[1]=n*t[1]/s)},this.athAdjust=function(t,e,r){var n=90.30873362,a=u.FAST_LOG10_X(e,10),s=t*t,i=0;return a-=r,s>1e-20&&(i=1+u.FAST_LOG10_X(s,10/n)),i<0&&(i=0),a*=i,a+=r+n-94.82444863,Math.pow(10,.1*a)},this.calc_xmin=function(t,e,r,n){var a,s=0,o=t.internal_flags,l=0,f=0,_=o.ATH,u=r.xr,h=t.VBR==p.vbr_mtrh?1:0,c=o.masking_lower;for(t.VBR!=p.vbr_mtrh&&t.VBR!=p.vbr_mt||(c=1),a=0;a<r.psy_lmax;a++){A=(y=t.VBR==p.vbr_rh||t.VBR==p.vbr_mtrh?athAdjust(_.adjust,_.l[a],_.floor):_.adjust*_.l[a])/(v=r.width[a]),B=i,T=v>>1,E=0;do{E+=x=u[l]*u[l],B+=x<A?x:A,E+=k=u[++l]*u[l],B+=k<A?k:A,l++}while(--T>0);E>y&&f++,a==Y.SBPSY_l&&B<(R=y*o.nsPsy.longfact[a])&&(B=R),0!=h&&(y=B),t.ATHonly||(M=e.en.l[a])>0&&(R=E*e.thm.l[a]*c/M,0!=h&&(R*=o.nsPsy.longfact[a]),y<R&&(y=R)),n[s++]=0!=h?y:y*o.nsPsy.longfact[a]}var m=575;if(r.block_type!=Y.SHORT_TYPE)for(var b=576;0!=b--&&S.EQ(u[b],0);)m=b;r.max_nonzero_coeff=m;for(var d=r.sfb_smin;a<r.psymax;d++,a+=3){var v,g,w;for(w=t.VBR==p.vbr_rh||t.VBR==p.vbr_mtrh?athAdjust(_.adjust,_.s[d],_.floor):_.adjust*_.s[d],v=r.width[a],g=0;g<3;g++){var y,A,B,M,R,E=0,T=v>>1;A=w/v,B=i;do{var x,k;E+=x=u[l]*u[l],B+=x<A?x:A,E+=k=u[++l]*u[l],B+=k<A?k:A,l++}while(--T>0);E>w&&f++,d==Y.SBPSY_s&&B<(R=w*o.nsPsy.shortfact[d])&&(B=R),y=0!=h?B:w,t.ATHonly||t.ATHshort||(M=e.en.s[d][g])>0&&(R=E*e.thm.s[d][g]*c/M,0!=h&&(R*=o.nsPsy.shortfact[d]),y<R&&(y=R)),n[s++]=0!=h?y:y*o.nsPsy.shortfact[d]}t.useTemporal&&(n[s-3]>n[s-3+1]&&(n[s-3+1]+=(n[s-3]-n[s-3+1])*o.decay),n[s-3+1]>n[s-3+2]&&(n[s-3+2]+=(n[s-3+1]-n[s-3+2])*o.decay))}return f},this.calc_noise_core=function(t,e,r,n){var s=0,i=e.s,o=t.l3_enc;if(i>t.count1)for(;0!=r--;)f=t.xr[i],i++,s+=f*f,f=t.xr[i],i++,s+=f*f;else if(i>t.big_values){var l=a(2);for(l[0]=0,l[1]=n;0!=r--;)f=Math.abs(t.xr[i])-l[o[i]],i++,s+=f*f,f=Math.abs(t.xr[i])-l[o[i]],i++,s+=f*f}else for(;0!=r--;){var f;f=Math.abs(t.xr[i])-b[o[i]]*n,i++,s+=f*f,f=Math.abs(t.xr[i])-b[o[i]]*n,i++,s+=f*f}return e.s=i,s},this.calc_noise=function(t,e,r,n,a){var s,i,o=0,l=0,f=0,c=0,p=0,m=-20,b=0,d=t.scalefac,v=0;for(n.over_SSD=0,s=0;s<t.psymax;s++){var w,y=t.global_gain-(d[v++]+(0!=t.preflag?_[s]:0)<<t.scalefac_scale+1)-8*t.subblock_gain[t.window[s]],S=0;if(null!=a&&a.step[s]==y)S=a.noise[s],b+=t.width[s],r[o++]=S/e[l++],S=a.noise_log[s];else{var A,B=h[y+L.Q_MAX2];i=t.width[s]>>1,b+t.width[s]>t.max_nonzero_coeff&&(i=(A=t.max_nonzero_coeff-b+1)>0?A>>1:0);var M=new g(b);S=this.calc_noise_core(t,M,i,B),b=M.s,null!=a&&(a.step[s]=y,a.noise[s]=S),S=r[o++]=S/e[l++],S=u.FAST_LOG10(Math.max(S,1e-20)),null!=a&&(a.noise_log[s]=S)}null!=a&&(a.global_gain=t.global_gain),p+=S,S>0&&(w=Math.max(0|10*S+.5,1),n.over_SSD+=w*w,f++,c+=S),m=Math.max(m,S)}return n.over_count=f,n.tot_noise=p,n.over_noise=c,n.max_noise=m,f},this.set_pinfo=function(t,e,r,n,s){var i,o,l,f,u,h=t.internal_flags,c=0==e.scalefac_scale?.5:1,p=e.scalefac,m=a(N.SFBMAX),b=a(N.SFBMAX),d=new R;calc_xmin(t,r,e,m),calc_noise(e,m,b,d,null);var v=0;for(o=e.sfb_lmax,e.block_type!=Y.SHORT_TYPE&&0==e.mixed_block_flag&&(o=22),i=0;i<o;i++){var g=h.scalefac_band.l[i],w=(y=h.scalefac_band.l[i+1])-g;for(f=0;v<y;v++)f+=e.xr[v]*e.xr[v];f/=w,u=1e15,h.pinfo.en[n][s][i]=u*f,h.pinfo.xfsf[n][s][i]=u*m[i]*b[i]/w,r.en.l[i]>0&&!t.ATHonly?f/=r.en.l[i]:f=0,h.pinfo.thr[n][s][i]=u*Math.max(f*r.thm.l[i],h.ATH.l[i]),h.pinfo.LAMEsfb[n][s][i]=0,0!=e.preflag&&i>=11&&(h.pinfo.LAMEsfb[n][s][i]=-c*_[i]),i<Y.SBPSY_l&&(h.pinfo.LAMEsfb[n][s][i]-=c*p[i])}if(e.block_type==Y.SHORT_TYPE)for(o=i,i=e.sfb_smin;i<Y.SBMAX_s;i++){g=h.scalefac_band.s[i],w=(y=h.scalefac_band.s[i+1])-g;for(var y,S=0;S<3;S++){for(f=0,l=g;l<y;l++)f+=e.xr[v]*e.xr[v],v++;f=Math.max(f/w,1e-20),u=1e15,h.pinfo.en_s[n][s][3*i+S]=u*f,h.pinfo.xfsf_s[n][s][3*i+S]=u*m[o]*b[o]/w,r.en.s[i][S]>0?f/=r.en.s[i][S]:f=0,(t.ATHonly||t.ATHshort)&&(f=0),h.pinfo.thr_s[n][s][3*i+S]=u*Math.max(f*r.thm.s[i][S],h.ATH.s[i]),h.pinfo.LAMEsfb_s[n][s][3*i+S]=-2*e.subblock_gain[S],i<Y.SBPSY_s&&(h.pinfo.LAMEsfb_s[n][s][3*i+S]-=c*p[o]),o++}}h.pinfo.LAMEqss[n][s]=e.global_gain,h.pinfo.LAMEmainbits[n][s]=e.part2_3_length+e.part2_length,h.pinfo.LAMEsfbits[n][s]=e.part2_length,h.pinfo.over[n][s]=d.over_count,h.pinfo.max_noise[n][s]=10*d.max_noise,h.pinfo.over_noise[n][s]=10*d.over_noise,h.pinfo.tot_noise[n][s]=10*d.tot_noise,h.pinfo.over_SSD[n][s]=d.over_SSD}}function H(){this.global_gain=0,this.sfb_count1=0,this.step=n(39),this.noise=a(39),this.noise_log=a(39)}function C(){this.xr=a(576),this.l3_enc=n(576),this.scalefac=n(N.SFBMAX),this.xrpow_max=0,this.part2_3_length=0,this.big_values=0,this.count1=0,this.global_gain=0,this.scalefac_compress=0,this.block_type=0,this.mixed_block_flag=0,this.table_select=n(3),this.subblock_gain=n(4),this.region0_count=0,this.region1_count=0,this.preflag=0,this.scalefac_scale=0,this.count1table_select=0,this.part2_length=0,this.sfb_lmax=0,this.sfb_smin=0,this.psy_lmax=0,this.sfbmax=0,this.psymax=0,this.sfbdivide=0,this.width=n(N.SFBMAX),this.window=n(N.SFBMAX),this.count1bits=0,this.sfb_partition_table=null,this.slen=n(4),this.max_nonzero_coeff=0;var t=this;function e(t){return new Int32Array(t)}this.assign=function(r){var n;t.xr=(n=r.xr,new Float32Array(n)),t.l3_enc=e(r.l3_enc),t.scalefac=e(r.scalefac),t.xrpow_max=r.xrpow_max,t.part2_3_length=r.part2_3_length,t.big_values=r.big_values,t.count1=r.count1,t.global_gain=r.global_gain,t.scalefac_compress=r.scalefac_compress,t.block_type=r.block_type,t.mixed_block_flag=r.mixed_block_flag,t.table_select=e(r.table_select),t.subblock_gain=e(r.subblock_gain),t.region0_count=r.region0_count,t.region1_count=r.region1_count,t.preflag=r.preflag,t.scalefac_scale=r.scalefac_scale,t.count1table_select=r.count1table_select,t.part2_length=r.part2_length,t.sfb_lmax=r.sfb_lmax,t.sfb_smin=r.sfb_smin,t.psy_lmax=r.psy_lmax,t.sfbmax=r.sfbmax,t.psymax=r.psymax,t.sfbdivide=r.sfbdivide,t.width=e(r.width),t.window=e(r.window),t.count1bits=r.count1bits,t.sfb_partition_table=r.sfb_partition_table.slice(0),t.slen=e(r.slen),t.max_nonzero_coeff=r.max_nonzero_coeff}}B.t1HB=[1,1,1,0],B.t2HB=[1,2,1,3,1,1,3,2,0],B.t3HB=[3,2,1,1,1,1,3,2,0],B.t5HB=[1,2,6,5,3,1,4,4,7,5,7,1,6,1,1,0],B.t6HB=[7,3,5,1,6,2,3,2,5,4,4,1,3,3,2,0],B.t7HB=[1,2,10,19,16,10,3,3,7,10,5,3,11,4,13,17,8,4,12,11,18,15,11,2,7,6,9,14,3,1,6,4,5,3,2,0],B.t8HB=[3,4,6,18,12,5,5,1,2,16,9,3,7,3,5,14,7,3,19,17,15,13,10,4,13,5,8,11,5,1,12,4,4,1,1,0],B.t9HB=[7,5,9,14,15,7,6,4,5,5,6,7,7,6,8,8,8,5,15,6,9,10,5,1,11,7,9,6,4,1,14,4,6,2,6,0],B.t10HB=[1,2,10,23,35,30,12,17,3,3,8,12,18,21,12,7,11,9,15,21,32,40,19,6,14,13,22,34,46,23,18,7,20,19,33,47,27,22,9,3,31,22,41,26,21,20,5,3,14,13,10,11,16,6,5,1,9,8,7,8,4,4,2,0],B.t11HB=[3,4,10,24,34,33,21,15,5,3,4,10,32,17,11,10,11,7,13,18,30,31,20,5,25,11,19,59,27,18,12,5,35,33,31,58,30,16,7,5,28,26,32,19,17,15,8,14,14,12,9,13,14,9,4,1,11,4,6,6,6,3,2,0],B.t12HB=[9,6,16,33,41,39,38,26,7,5,6,9,23,16,26,11,17,7,11,14,21,30,10,7,17,10,15,12,18,28,14,5,32,13,22,19,18,16,9,5,40,17,31,29,17,13,4,2,27,12,11,15,10,7,4,1,27,12,8,12,6,3,1,0],B.t13HB=[1,5,14,21,34,51,46,71,42,52,68,52,67,44,43,19,3,4,12,19,31,26,44,33,31,24,32,24,31,35,22,14,15,13,23,36,59,49,77,65,29,40,30,40,27,33,42,16,22,20,37,61,56,79,73,64,43,76,56,37,26,31,25,14,35,16,60,57,97,75,114,91,54,73,55,41,48,53,23,24,58,27,50,96,76,70,93,84,77,58,79,29,74,49,41,17,47,45,78,74,115,94,90,79,69,83,71,50,59,38,36,15,72,34,56,95,92,85,91,90,86,73,77,65,51,44,43,42,43,20,30,44,55,78,72,87,78,61,46,54,37,30,20,16,53,25,41,37,44,59,54,81,66,76,57,54,37,18,39,11,35,33,31,57,42,82,72,80,47,58,55,21,22,26,38,22,53,25,23,38,70,60,51,36,55,26,34,23,27,14,9,7,34,32,28,39,49,75,30,52,48,40,52,28,18,17,9,5,45,21,34,64,56,50,49,45,31,19,12,15,10,7,6,3,48,23,20,39,36,35,53,21,16,23,13,10,6,1,4,2,16,15,17,27,25,20,29,11,17,12,16,8,1,1,0,1],B.t15HB=[7,12,18,53,47,76,124,108,89,123,108,119,107,81,122,63,13,5,16,27,46,36,61,51,42,70,52,83,65,41,59,36,19,17,15,24,41,34,59,48,40,64,50,78,62,80,56,33,29,28,25,43,39,63,55,93,76,59,93,72,54,75,50,29,52,22,42,40,67,57,95,79,72,57,89,69,49,66,46,27,77,37,35,66,58,52,91,74,62,48,79,63,90,62,40,38,125,32,60,56,50,92,78,65,55,87,71,51,73,51,70,30,109,53,49,94,88,75,66,122,91,73,56,42,64,44,21,25,90,43,41,77,73,63,56,92,77,66,47,67,48,53,36,20,71,34,67,60,58,49,88,76,67,106,71,54,38,39,23,15,109,53,51,47,90,82,58,57,48,72,57,41,23,27,62,9,86,42,40,37,70,64,52,43,70,55,42,25,29,18,11,11,118,68,30,55,50,46,74,65,49,39,24,16,22,13,14,7,91,44,39,38,34,63,52,45,31,52,28,19,14,8,9,3,123,60,58,53,47,43,32,22,37,24,17,12,15,10,2,1,71,37,34,30,28,20,17,26,21,16,10,6,8,6,2,0],B.t16HB=[1,5,14,44,74,63,110,93,172,149,138,242,225,195,376,17,3,4,12,20,35,62,53,47,83,75,68,119,201,107,207,9,15,13,23,38,67,58,103,90,161,72,127,117,110,209,206,16,45,21,39,69,64,114,99,87,158,140,252,212,199,387,365,26,75,36,68,65,115,101,179,164,155,264,246,226,395,382,362,9,66,30,59,56,102,185,173,265,142,253,232,400,388,378,445,16,111,54,52,100,184,178,160,133,257,244,228,217,385,366,715,10,98,48,91,88,165,157,148,261,248,407,397,372,380,889,884,8,85,84,81,159,156,143,260,249,427,401,392,383,727,713,708,7,154,76,73,141,131,256,245,426,406,394,384,735,359,710,352,11,139,129,67,125,247,233,229,219,393,743,737,720,885,882,439,4,243,120,118,115,227,223,396,746,742,736,721,712,706,223,436,6,202,224,222,218,216,389,386,381,364,888,443,707,440,437,1728,4,747,211,210,208,370,379,734,723,714,1735,883,877,876,3459,865,2,377,369,102,187,726,722,358,711,709,866,1734,871,3458,870,434,0,12,10,7,11,10,17,11,9,13,12,10,7,5,3,1,3],B.t24HB=[15,13,46,80,146,262,248,434,426,669,653,649,621,517,1032,88,14,12,21,38,71,130,122,216,209,198,327,345,319,297,279,42,47,22,41,74,68,128,120,221,207,194,182,340,315,295,541,18,81,39,75,70,134,125,116,220,204,190,178,325,311,293,271,16,147,72,69,135,127,118,112,210,200,188,352,323,306,285,540,14,263,66,129,126,119,114,214,202,192,180,341,317,301,281,262,12,249,123,121,117,113,215,206,195,185,347,330,308,291,272,520,10,435,115,111,109,211,203,196,187,353,332,313,298,283,531,381,17,427,212,208,205,201,193,186,177,169,320,303,286,268,514,377,16,335,199,197,191,189,181,174,333,321,305,289,275,521,379,371,11,668,184,183,179,175,344,331,314,304,290,277,530,383,373,366,10,652,346,171,168,164,318,309,299,287,276,263,513,375,368,362,6,648,322,316,312,307,302,292,284,269,261,512,376,370,364,359,4,620,300,296,294,288,282,273,266,515,380,374,369,365,361,357,2,1033,280,278,274,267,264,259,382,378,372,367,363,360,358,356,0,43,20,19,17,15,13,11,9,7,6,4,7,5,3,1,3],B.t32HB=[1,10,8,20,12,20,16,32,14,12,24,0,28,16,24,16],B.t33HB=[15,28,26,48,22,40,36,64,14,24,20,32,12,16,8,0],B.t1l=[1,4,3,5],B.t2l=[1,4,7,4,5,7,6,7,8],B.t3l=[2,3,7,4,4,7,6,7,8],B.t5l=[1,4,7,8,4,5,8,9,7,8,9,10,8,8,9,10],B.t6l=[3,4,6,8,4,4,6,7,5,6,7,8,7,7,8,9],B.t7l=[1,4,7,9,9,10,4,6,8,9,9,10,7,7,9,10,10,11,8,9,10,11,11,11,8,9,10,11,11,12,9,10,11,12,12,12],B.t8l=[2,4,7,9,9,10,4,4,6,10,10,10,7,6,8,10,10,11,9,10,10,11,11,12,9,9,10,11,12,12,10,10,11,11,13,13],B.t9l=[3,4,6,7,9,10,4,5,6,7,8,10,5,6,7,8,9,10,7,7,8,9,9,10,8,8,9,9,10,11,9,9,10,10,11,11],B.t10l=[1,4,7,9,10,10,10,11,4,6,8,9,10,11,10,10,7,8,9,10,11,12,11,11,8,9,10,11,12,12,11,12,9,10,11,12,12,12,12,12,10,11,12,12,13,13,12,13,9,10,11,12,12,12,13,13,10,10,11,12,12,13,13,13],B.t11l=[2,4,6,8,9,10,9,10,4,5,6,8,10,10,9,10,6,7,8,9,10,11,10,10,8,8,9,11,10,12,10,11,9,10,10,11,11,12,11,12,9,10,11,12,12,13,12,13,9,9,9,10,11,12,12,12,9,9,10,11,12,12,12,12],B.t12l=[4,4,6,8,9,10,10,10,4,5,6,7,9,9,10,10,6,6,7,8,9,10,9,10,7,7,8,8,9,10,10,10,8,8,9,9,10,10,10,11,9,9,10,10,10,11,10,11,9,9,9,10,10,11,11,12,10,10,10,11,11,11,11,12],B.t13l=[1,5,7,8,9,10,10,11,10,11,12,12,13,13,14,14,4,6,8,9,10,10,11,11,11,11,12,12,13,14,14,14,7,8,9,10,11,11,12,12,11,12,12,13,13,14,15,15,8,9,10,11,11,12,12,12,12,13,13,13,13,14,15,15,9,9,11,11,12,12,13,13,12,13,13,14,14,15,15,16,10,10,11,12,12,12,13,13,13,13,14,13,15,15,16,16,10,11,12,12,13,13,13,13,13,14,14,14,15,15,16,16,11,11,12,13,13,13,14,14,14,14,15,15,15,16,18,18,10,10,11,12,12,13,13,14,14,14,14,15,15,16,17,17,11,11,12,12,13,13,13,15,14,15,15,16,16,16,18,17,11,12,12,13,13,14,14,15,14,15,16,15,16,17,18,19,12,12,12,13,14,14,14,14,15,15,15,16,17,17,17,18,12,13,13,14,14,15,14,15,16,16,17,17,17,18,18,18,13,13,14,15,15,15,16,16,16,16,16,17,18,17,18,18,14,14,14,15,15,15,17,16,16,19,17,17,17,19,18,18,13,14,15,16,16,16,17,16,17,17,18,18,21,20,21,18],B.t15l=[3,5,6,8,8,9,10,10,10,11,11,12,12,12,13,14,5,5,7,8,9,9,10,10,10,11,11,12,12,12,13,13,6,7,7,8,9,9,10,10,10,11,11,12,12,13,13,13,7,8,8,9,9,10,10,11,11,11,12,12,12,13,13,13,8,8,9,9,10,10,11,11,11,11,12,12,12,13,13,13,9,9,9,10,10,10,11,11,11,11,12,12,13,13,13,14,10,9,10,10,10,11,11,11,11,12,12,12,13,13,14,14,10,10,10,11,11,11,11,12,12,12,12,12,13,13,13,14,10,10,10,11,11,11,11,12,12,12,12,13,13,14,14,14,10,10,11,11,11,11,12,12,12,13,13,13,13,14,14,14,11,11,11,11,12,12,12,12,12,13,13,13,13,14,15,14,11,11,11,11,12,12,12,12,13,13,13,13,14,14,14,15,12,12,11,12,12,12,13,13,13,13,13,13,14,14,15,15,12,12,12,12,12,13,13,13,13,14,14,14,14,14,15,15,13,13,13,13,13,13,13,13,14,14,14,14,15,15,14,15,13,13,13,13,13,13,13,14,14,14,14,14,15,15,15,15],B.t16_5l=[1,5,7,9,10,10,11,11,12,12,12,13,13,13,14,11,4,6,8,9,10,11,11,11,12,12,12,13,14,13,14,11,7,8,9,10,11,11,12,12,13,12,13,13,13,14,14,12,9,9,10,11,11,12,12,12,13,13,14,14,14,15,15,13,10,10,11,11,12,12,13,13,13,14,14,14,15,15,15,12,10,10,11,11,12,13,13,14,13,14,14,15,15,15,16,13,11,11,11,12,13,13,13,13,14,14,14,14,15,15,16,13,11,11,12,12,13,13,13,14,14,15,15,15,15,17,17,13,11,12,12,13,13,13,14,14,15,15,15,15,16,16,16,13,12,12,12,13,13,14,14,15,15,15,15,16,15,16,15,14,12,13,12,13,14,14,14,14,15,16,16,16,17,17,16,13,13,13,13,13,14,14,15,16,16,16,16,16,16,15,16,14,13,14,14,14,14,15,15,15,15,17,16,16,16,16,18,14,15,14,14,14,15,15,16,16,16,18,17,17,17,19,17,14,14,15,13,14,16,16,15,16,16,17,18,17,19,17,16,14,11,11,11,12,12,13,13,13,14,14,14,14,14,14,14,12],B.t16l=[1,5,7,9,10,10,11,11,12,12,12,13,13,13,14,10,4,6,8,9,10,11,11,11,12,12,12,13,14,13,14,10,7,8,9,10,11,11,12,12,13,12,13,13,13,14,14,11,9,9,10,11,11,12,12,12,13,13,14,14,14,15,15,12,10,10,11,11,12,12,13,13,13,14,14,14,15,15,15,11,10,10,11,11,12,13,13,14,13,14,14,15,15,15,16,12,11,11,11,12,13,13,13,13,14,14,14,14,15,15,16,12,11,11,12,12,13,13,13,14,14,15,15,15,15,17,17,12,11,12,12,13,13,13,14,14,15,15,15,15,16,16,16,12,12,12,12,13,13,14,14,15,15,15,15,16,15,16,15,13,12,13,12,13,14,14,14,14,15,16,16,16,17,17,16,12,13,13,13,13,14,14,15,16,16,16,16,16,16,15,16,13,13,14,14,14,14,15,15,15,15,17,16,16,16,16,18,13,15,14,14,14,15,15,16,16,16,18,17,17,17,19,17,13,14,15,13,14,16,16,15,16,16,17,18,17,19,17,16,13,10,10,10,11,11,12,12,12,13,13,13,13,13,13,13,10],B.t24l=[4,5,7,8,9,10,10,11,11,12,12,12,12,12,13,10,5,6,7,8,9,10,10,11,11,11,12,12,12,12,12,10,7,7,8,9,9,10,10,11,11,11,11,12,12,12,13,9,8,8,9,9,10,10,10,11,11,11,11,12,12,12,12,9,9,9,9,10,10,10,10,11,11,11,12,12,12,12,13,9,10,9,10,10,10,10,11,11,11,11,12,12,12,12,12,9,10,10,10,10,10,11,11,11,11,12,12,12,12,12,13,9,11,10,10,10,11,11,11,11,12,12,12,12,12,13,13,10,11,11,11,11,11,11,11,11,11,12,12,12,12,13,13,10,11,11,11,11,11,11,11,12,12,12,12,12,13,13,13,10,12,11,11,11,11,12,12,12,12,12,12,13,13,13,13,10,12,12,11,11,11,12,12,12,12,12,12,13,13,13,13,10,12,12,12,12,12,12,12,12,12,12,13,13,13,13,13,10,12,12,12,12,12,12,12,12,13,13,13,13,13,13,13,10,13,12,12,12,12,12,12,13,13,13,13,13,13,13,13,10,9,9,9,9,9,9,9,9,9,9,9,10,10,10,10,6],B.t32l=[1,5,5,7,5,8,7,9,5,7,7,9,7,9,9,10],B.t33l=[4,5,5,6,5,6,6,7,5,6,6,7,6,7,7,8],B.ht=[new A(0,0,null,null),new A(2,0,B.t1HB,B.t1l),new A(3,0,B.t2HB,B.t2l),new A(3,0,B.t3HB,B.t3l),new A(0,0,null,null),new A(4,0,B.t5HB,B.t5l),new A(4,0,B.t6HB,B.t6l),new A(6,0,B.t7HB,B.t7l),new A(6,0,B.t8HB,B.t8l),new A(6,0,B.t9HB,B.t9l),new A(8,0,B.t10HB,B.t10l),new A(8,0,B.t11HB,B.t11l),new A(8,0,B.t12HB,B.t12l),new A(16,0,B.t13HB,B.t13l),new A(0,0,null,B.t16_5l),new A(16,0,B.t15HB,B.t15l),new A(1,1,B.t16HB,B.t16l),new A(2,3,B.t16HB,B.t16l),new A(3,7,B.t16HB,B.t16l),new A(4,15,B.t16HB,B.t16l),new A(6,63,B.t16HB,B.t16l),new A(8,255,B.t16HB,B.t16l),new A(10,1023,B.t16HB,B.t16l),new A(13,8191,B.t16HB,B.t16l),new A(4,15,B.t24HB,B.t24l),new A(5,31,B.t24HB,B.t24l),new A(6,63,B.t24HB,B.t24l),new A(7,127,B.t24HB,B.t24l),new A(8,255,B.t24HB,B.t24l),new A(9,511,B.t24HB,B.t24l),new A(11,2047,B.t24HB,B.t24l),new A(13,8191,B.t24HB,B.t24l),new A(0,0,B.t32HB,B.t32l),new A(0,0,B.t33HB,B.t33l)],B.largetbl=[65540,327685,458759,589832,655369,655370,720906,720907,786443,786444,786444,851980,851980,851980,917517,655370,262149,393222,524295,589832,655369,720906,720906,720907,786443,786443,786444,851980,917516,851980,917516,655370,458759,524295,589832,655369,720905,720906,786442,786443,851979,786443,851979,851980,851980,917516,917517,720905,589832,589832,655369,720905,720906,786442,786442,786443,851979,851979,917515,917516,917516,983052,983052,786441,655369,655369,720905,720906,786442,786442,851978,851979,851979,917515,917516,917516,983052,983052,983053,720905,655370,655369,720906,720906,786442,851978,851979,917515,851979,917515,917516,983052,983052,983052,1048588,786441,720906,720906,720906,786442,851978,851979,851979,851979,917515,917516,917516,917516,983052,983052,1048589,786441,720907,720906,786442,786442,851979,851979,851979,917515,917516,983052,983052,983052,983052,1114125,1114125,786442,720907,786443,786443,851979,851979,851979,917515,917515,983051,983052,983052,983052,1048588,1048589,1048589,786442,786443,786443,786443,851979,851979,917515,917515,983052,983052,983052,983052,1048588,983053,1048589,983053,851978,786444,851979,786443,851979,917515,917516,917516,917516,983052,1048588,1048588,1048589,1114125,1114125,1048589,786442,851980,851980,851979,851979,917515,917516,983052,1048588,1048588,1048588,1048588,1048589,1048589,983053,1048589,851978,851980,917516,917516,917516,917516,983052,983052,983052,983052,1114124,1048589,1048589,1048589,1048589,1179661,851978,983052,917516,917516,917516,983052,983052,1048588,1048588,1048589,1179661,1114125,1114125,1114125,1245197,1114125,851978,917517,983052,851980,917516,1048588,1048588,983052,1048589,1048589,1114125,1179661,1114125,1245197,1114125,1048589,851978,655369,655369,655369,720905,720905,786441,786441,786441,851977,851977,851977,851978,851978,851978,851978,655366],B.table23=[65538,262147,458759,262148,327684,458759,393222,458759,524296],B.table56=[65539,262148,458758,524296,262148,327684,524294,589831,458757,524294,589831,655368,524295,524295,589832,655369],B.bitrate_table=[[0,8,16,24,32,40,48,56,64,80,96,112,128,144,160,-1],[0,32,40,48,56,64,80,96,112,128,160,192,224,256,320,-1],[0,8,16,24,32,40,48,56,64,-1,-1,-1,-1,-1,-1,-1]],B.samplerate_table=[[22050,24e3,16e3,-1],[44100,48e3,32e3,-1],[11025,12e3,8e3,-1]],B.scfsi_band=[0,6,11,16,21],L.Q_MAX=257,L.Q_MAX2=116,L.LARGE_BITS=1e5,L.IXMAX_VAL=8206;var N={};function O(){var t,e,r;this.rv=null,this.qupvt=null;var n,s=new E;function i(t){this.ordinal=t}function o(t){for(var e=0;e<t.sfbmax;e++)if(t.scalefac[e]+t.subblock_gain[t.window[e]]==0)return!1;return!0}function l(t,e,r,n,a){var s;switch(t){default:case 9:e.over_count>0?(s=r.over_SSD<=e.over_SSD,r.over_SSD==e.over_SSD&&(s=r.bits<e.bits)):s=r.max_noise<0&&10*r.max_noise+r.bits<=10*e.max_noise+e.bits;break;case 0:s=r.over_count<e.over_count||r.over_count==e.over_count&&r.over_noise<e.over_noise||r.over_count==e.over_count&&S.EQ(r.over_noise,e.over_noise)&&r.tot_noise<e.tot_noise;break;case 8:r.max_noise=function(t,e){for(var r,n=1e-37,a=0;a<e.psymax;a++)n+=(r=t[a],u.FAST_LOG10(.368+.632*r*r*r));return Math.max(1e-20,n)}(a,n);case 1:s=r.max_noise<e.max_noise;break;case 2:s=r.tot_noise<e.tot_noise;break;case 3:s=r.tot_noise<e.tot_noise&&r.max_noise<e.max_noise;break;case 4:s=r.max_noise<=0&&e.max_noise>.2||r.max_noise<=0&&e.max_noise<0&&e.max_noise>r.max_noise-.2&&r.tot_noise<e.tot_noise||r.max_noise<=0&&e.max_noise>0&&e.max_noise>r.max_noise-.2&&r.tot_noise<e.tot_noise+e.over_noise||r.max_noise>0&&e.max_noise>-.05&&e.max_noise>r.max_noise-.1&&r.tot_noise+r.over_noise<e.tot_noise+e.over_noise||r.max_noise>0&&e.max_noise>-.1&&e.max_noise>r.max_noise-.15&&r.tot_noise+r.over_noise+r.over_noise<e.tot_noise+e.over_noise+e.over_noise;break;case 5:s=r.over_noise<e.over_noise||S.EQ(r.over_noise,e.over_noise)&&r.tot_noise<e.tot_noise;break;case 6:s=r.over_noise<e.over_noise||S.EQ(r.over_noise,e.over_noise)&&(r.max_noise<e.max_noise||S.EQ(r.max_noise,e.max_noise)&&r.tot_noise<=e.tot_noise);break;case 7:s=r.over_count<e.over_count||r.over_noise<e.over_noise}return 0==e.over_count&&(s=s&&r.bits<e.bits),s}function h(t,e,a,s,i){var l=t.internal_flags;!function(t,e,r,n,a){var s,i=t.internal_flags;s=0==e.scalefac_scale?1.2968395546510096:1.6817928305074292;for(var o=0,l=0;l<e.sfbmax;l++)o<r[l]&&(o=r[l]);var f=i.noise_shaping_amp;switch(3==f&&(f=a?2:1),f){case 2:break;case 1:o>1?o=Math.pow(o,.5):o*=.95;break;case 0:default:o>1?o=1:o*=.95}var _=0;for(l=0;l<e.sfbmax;l++){var u,h=e.width[l];if(_+=h,!(r[l]<o)){if(0!=(2&i.substep_shaping)&&(i.pseudohalf[l]=0==i.pseudohalf[l]?1:0,0==i.pseudohalf[l]&&2==i.noise_shaping_amp))return;for(e.scalefac[l]++,u=-h;u<0;u++)n[_+u]*=s,n[_+u]>e.xrpow_max&&(e.xrpow_max=n[_+u]);if(2==i.noise_shaping_amp)return}}}(t,e,a,s,i);var _=o(e);return!(_||(_=2==l.mode_gr?n.scale_bitcount(e):n.scale_bitcount_lsf(l,e))&&(l.noise_shaping>1&&(f.fill(l.pseudohalf,0),0==e.scalefac_scale?(function(t,e){for(var n=0,a=0;a<t.sfbmax;a++){var s=t.width[a],i=t.scalefac[a];if(0!=t.preflag&&(i+=r.pretab[a]),n+=s,0!=(1&i)){i++;for(var o=-s;o<0;o++)e[n+o]*=1.2968395546510096,e[n+o]>t.xrpow_max&&(t.xrpow_max=e[n+o])}t.scalefac[a]=i>>1}t.preflag=0,t.scalefac_scale=1}(e,s),_=!1):e.block_type==Y.SHORT_TYPE&&l.subblock_gain>0&&(_=function(t,e,n){var a,s=e.scalefac;for(a=0;a<e.sfb_lmax;a++)if(s[a]>=16)return!0;for(var i=0;i<3;i++){var o=0,l=0;for(a=e.sfb_lmax+i;a<e.sfbdivide;a+=3)o<s[a]&&(o=s[a]);for(;a<e.sfbmax;a+=3)l<s[a]&&(l=s[a]);if(!(o<16&&l<8)){if(e.subblock_gain[i]>=7)return!0;e.subblock_gain[i]++;var f=t.scalefac_band.l[e.sfb_lmax];for(a=e.sfb_lmax+i;a<e.sfbmax;a+=3){var _=e.width[a],u=s[a];if((u-=4>>e.scalefac_scale)>=0)s[a]=u,f+=3*_;else{s[a]=0;var h=210+(u<<e.scalefac_scale+1);p=r.IPOW20(h),f+=_*(i+1);for(var c=-_;c<0;c++)n[f+c]*=p,n[f+c]>e.xrpow_max&&(e.xrpow_max=n[f+c]);f+=_*(3-i-1)}}var p=r.IPOW20(202);for(f+=e.width[a]*(i+1),c=-e.width[a];c<0;c++)n[f+c]*=p,n[f+c]>e.xrpow_max&&(e.xrpow_max=n[f+c])}}return!1}(l,e,s)||o(e))),_||(_=2==l.mode_gr?n.scale_bitcount(e):n.scale_bitcount_lsf(l,e)),_))}this.setModules=function(a,i,o,l){t=a,e=i,this.rv=i,r=o,this.qupvt=o,n=l,s.setModules(r,n)},this.ms_convert=function(t,e){for(var r=0;r<576;++r){var n=t.tt[e][0].xr[r],a=t.tt[e][1].xr[r];t.tt[e][0].xr[r]=(n+a)*(.5*u.SQRT2),t.tt[e][1].xr[r]=(n-a)*(.5*u.SQRT2)}},this.init_xrpow=function(t,e,r){var n=0,a=0|e.max_nonzero_coeff;if(e.xrpow_max=0,f.fill(r,a,576,0),(n=function(t,e,r,n){n=0;for(var a=0;a<=r;++a){var s=Math.abs(t.xr[a]);n+=s,e[a]=Math.sqrt(s*Math.sqrt(s)),e[a]>t.xrpow_max&&(t.xrpow_max=e[a])}return n}(e,r,a,n))>1e-20){var s=0;0!=(2&t.substep_shaping)&&(s=1);for(var i=0;i<e.psymax;i++)t.pseudohalf[i]=s;return!0}return f.fill(e.l3_enc,0,576,0),!1},this.init_outer_loop=function(t,e){e.part2_3_length=0,e.big_values=0,e.count1=0,e.global_gain=210,e.scalefac_compress=0,e.table_select[0]=0,e.table_select[1]=0,e.table_select[2]=0,e.subblock_gain[0]=0,e.subblock_gain[1]=0,e.subblock_gain[2]=0,e.subblock_gain[3]=0,e.region0_count=0,e.region1_count=0,e.preflag=0,e.scalefac_scale=0,e.count1table_select=0,e.part2_length=0,e.sfb_lmax=Y.SBPSY_l,e.sfb_smin=Y.SBPSY_s,e.psy_lmax=t.sfb21_extra?Y.SBMAX_l:Y.SBPSY_l,e.psymax=e.psy_lmax,e.sfbmax=e.sfb_lmax,e.sfbdivide=11;for(var n=0;n<Y.SBMAX_l;n++)e.width[n]=t.scalefac_band.l[n+1]-t.scalefac_band.l[n],e.window[n]=3;if(e.block_type==Y.SHORT_TYPE){var s=a(576);e.sfb_smin=0,e.sfb_lmax=0,0!=e.mixed_block_flag&&(e.sfb_smin=3,e.sfb_lmax=2*t.mode_gr+4),e.psymax=e.sfb_lmax+3*((t.sfb21_extra?Y.SBMAX_s:Y.SBPSY_s)-e.sfb_smin),e.sfbmax=e.sfb_lmax+3*(Y.SBPSY_s-e.sfb_smin),e.sfbdivide=e.sfbmax-18,e.psy_lmax=e.sfb_lmax;var i=t.scalefac_band.l[e.sfb_lmax];for(_.arraycopy(e.xr,0,s,0,576),n=e.sfb_smin;n<Y.SBMAX_s;n++)for(var o=t.scalefac_band.s[n],l=t.scalefac_band.s[n+1],u=0;u<3;u++)for(var h=o;h<l;h++)e.xr[i++]=s[3*h+u];var c=e.sfb_lmax;for(n=e.sfb_smin;n<Y.SBMAX_s;n++)e.width[c]=e.width[c+1]=e.width[c+2]=t.scalefac_band.s[n+1]-t.scalefac_band.s[n],e.window[c]=0,e.window[c+1]=1,e.window[c+2]=2,c+=3}e.count1bits=0,e.sfb_partition_table=r.nr_of_sfb_block[0][0],e.slen[0]=0,e.slen[1]=0,e.slen[2]=0,e.slen[3]=0,e.max_nonzero_coeff=575,f.fill(e.scalefac,0),function(t,e){var n=t.ATH,a=e.xr;if(e.block_type!=Y.SHORT_TYPE)for(var s=!1,i=Y.PSFB21-1;i>=0&&!s;i--){var o=t.scalefac_band.psfb21[i],l=t.scalefac_band.psfb21[i+1],f=r.athAdjust(n.adjust,n.psfb21[i],n.floor);t.nsPsy.longfact[21]>1e-12&&(f*=t.nsPsy.longfact[21]);for(var _=l-1;_>=o;_--){if(!(Math.abs(a[_])<f)){s=!0;break}a[_]=0}}else for(var u=0;u<3;u++)for(s=!1,i=Y.PSFB12-1;i>=0&&!s;i--){l=(o=3*t.scalefac_band.s[12]+(t.scalefac_band.s[13]-t.scalefac_band.s[12])*u+(t.scalefac_band.psfb12[i]-t.scalefac_band.psfb12[0]))+(t.scalefac_band.psfb12[i+1]-t.scalefac_band.psfb12[i]);var h=r.athAdjust(n.adjust,n.psfb12[i],n.floor);for(t.nsPsy.shortfact[12]>1e-12&&(h*=t.nsPsy.shortfact[12]),_=l-1;_>=o;_--){if(!(Math.abs(a[_])<h)){s=!0;break}a[_]=0}}}(t,e)},i.BINSEARCH_NONE=new i(0),i.BINSEARCH_UP=new i(1),i.BINSEARCH_DOWN=new i(2),this.trancate_smallspectrums=function(t,e,s,i){var o=a(N.SFBMAX);if((0!=(4&t.substep_shaping)||e.block_type!=Y.SHORT_TYPE)&&0==(128&t.substep_shaping)){r.calc_noise(e,s,o,new R,null);for(var l=0;l<576;l++){var _=0;0!=e.l3_enc[l]&&(_=Math.abs(e.xr[l])),i[l]=_}l=0;var u=8;e.block_type==Y.SHORT_TYPE&&(u=6);do{var h,c,p,m,b=e.width[u];if(l+=b,!(o[u]>=1||(f.sort(i,l-b,b),S.EQ(i[l-1],0)))){h=(1-o[u])*s[u],c=0,m=0;do{var d;for(p=1;m+p<b&&!S.NEQ(i[m+l-b],i[m+l+p-b]);p++);if(h<(d=i[m+l-b]*i[m+l-b]*p)){0!=m&&(c=i[m+l-b-1]);break}h-=d,m+=p}while(m<b);if(!S.EQ(c,0))do{Math.abs(e.xr[l-b])<=c&&(e.l3_enc[l-b]=0)}while(--b>0)}}while(++u<e.psymax);e.part2_3_length=n.noquant_count_bits(t,e,null)}},this.outer_loop=function(t,e,s,o,f,u){var c=t.internal_flags,m=new C,b=a(576),d=a(N.SFBMAX),v=new R,g=new H,w=9999999,y=!1,S=!1,A=0;if(function(t,e,r,a,s){var o,l=t.CurrentStep[a],f=!1,_=t.OldValue[a],u=i.BINSEARCH_NONE;for(e.global_gain=_,r-=e.part2_length;;){var h;if(o=n.count_bits(t,s,e,null),1==l||o==r)break;o>r?(u==i.BINSEARCH_DOWN&&(f=!0),f&&(l/=2),u=i.BINSEARCH_UP,h=l):(u==i.BINSEARCH_UP&&(f=!0),f&&(l/=2),u=i.BINSEARCH_DOWN,h=-l),e.global_gain+=h,e.global_gain<0&&(e.global_gain=0,f=!0),e.global_gain>255&&(e.global_gain=255,f=!0)}for(;o>r&&e.global_gain<255;)e.global_gain++,o=n.count_bits(t,s,e,null);t.CurrentStep[a]=_-e.global_gain>=4?4:2,t.OldValue[a]=e.global_gain,e.part2_3_length=o}(c,e,u,f,o),0==c.noise_shaping)return 100;r.calc_noise(e,s,d,v,g),v.bits=e.part2_3_length,m.assign(e);var B=0;for(_.arraycopy(o,0,b,0,576);!y;){do{var M,E=new R,T=255;if(M=0!=(2&c.substep_shaping)?20:3,c.sfb21_extra){if(d[m.sfbmax]>1)break;if(m.block_type==Y.SHORT_TYPE&&(d[m.sfbmax+1]>1||d[m.sfbmax+2]>1))break}if(!h(t,m,d,o,S))break;0!=m.scalefac_scale&&(T=254);var x=u-m.part2_length;if(x<=0)break;for(;(m.part2_3_length=n.count_bits(c,o,m,g))>x&&m.global_gain<=T;)m.global_gain++;if(m.global_gain>T)break;if(0==v.over_count){for(;(m.part2_3_length=n.count_bits(c,o,m,g))>w&&m.global_gain<=T;)m.global_gain++;if(m.global_gain>T)break}if(r.calc_noise(m,s,d,E,g),E.bits=m.part2_3_length,0!=(l(e.block_type!=Y.SHORT_TYPE?t.quant_comp:t.quant_comp_short,v,E,m,d)?1:0))w=e.part2_3_length,v=E,e.assign(m),B=0,_.arraycopy(o,0,b,0,576);else if(0==c.full_outer_loop){if(++B>M&&0==v.over_count)break;if(3==c.noise_shaping_amp&&S&&B>30)break;if(3==c.noise_shaping_amp&&S&&m.global_gain-A>15)break}}while(m.global_gain+m.scalefac_scale<255);3==c.noise_shaping_amp?S?y=!0:(m.assign(e),_.arraycopy(b,0,o,0,576),B=0,A=m.global_gain,S=!0):y=!0}return t.VBR==p.vbr_rh||t.VBR==p.vbr_mtrh?_.arraycopy(b,0,o,0,576):0!=(1&c.substep_shaping)&&trancate_smallspectrums(c,e,s,o),v.over_count},this.iteration_finish_one=function(t,r,a){var s=t.l3_side,i=s.tt[r][a];n.best_scalefac_store(t,r,a,s),1==t.use_best_huffman&&n.best_huffman_divide(t,i),e.ResvAdjust(t,i)},this.VBR_encode_granule=function(t,e,r,n,s,i,o){var l,u=t.internal_flags,h=new C,c=a(576),p=o,m=o+1,b=(o+i)/2,d=0,v=u.sfb21_extra;f.fill(h.l3_enc,0);do{u.sfb21_extra=!(b>p-42)&&v,outer_loop(t,e,r,n,s,b)<=0?(d=1,m=e.part2_3_length,h.assign(e),_.arraycopy(n,0,c,0,576),l=(o=m-32)-i,b=(o+i)/2):(l=o-(i=b+32),b=(o+i)/2,0!=d&&(d=2,e.assign(h),_.arraycopy(c,0,n,0,576)))}while(l>12);u.sfb21_extra=v,2==d&&_.arraycopy(h.l3_enc,0,e.l3_enc,0,576)},this.get_framebits=function(r,n){var a=r.internal_flags;a.bitrate_index=a.VBR_min_bitrate;var s=t.getframebits(r);a.bitrate_index=1,s=t.getframebits(r);for(var i=1;i<=a.VBR_max_bitrate;i++){a.bitrate_index=i;var o=new M(s);n[i]=e.ResvFrameBegin(r,o),s=o.bits}},this.VBR_old_prepare=function(t,n,a,s,i,o,l,f,_){var u,h=t.internal_flags,c=0,p=1,m=0;h.bitrate_index=h.VBR_max_bitrate;var b=e.ResvFrameBegin(t,new M(0))/h.mode_gr;get_framebits(t,o);for(var d=0;d<h.mode_gr;d++){var v=r.on_pe(t,n,f[d],b,d,0);h.mode_ext==Y.MPG_MD_MS_LR&&(ms_convert(h.l3_side,d),r.reduce_side(f[d],a[d],b,v));for(var g=0;g<h.channels_out;++g){var w=h.l3_side.tt[d][g];w.block_type!=Y.SHORT_TYPE?(c=1.28/(1+Math.exp(3.5-n[d][g]/300))-.05,u=h.PSY.mask_adjust-c):(c=2.56/(1+Math.exp(3.5-n[d][g]/300))-.14,u=h.PSY.mask_adjust_short-c),h.masking_lower=Math.pow(10,.1*u),init_outer_loop(h,w),_[d][g]=r.calc_xmin(t,s[d][g],w,i[d][g]),0!=_[d][g]&&(p=0),l[d][g]=126,m+=f[d][g]}}for(d=0;d<h.mode_gr;d++)for(g=0;g<h.channels_out;g++)m>o[h.VBR_max_bitrate]&&(f[d][g]*=o[h.VBR_max_bitrate],f[d][g]/=m),l[d][g]>f[d][g]&&(l[d][g]=f[d][g]);return p},this.bitpressure_strategy=function(t,e,r,n){for(var a=0;a<t.mode_gr;a++)for(var s=0;s<t.channels_out;s++){for(var i=t.l3_side.tt[a][s],o=e[a][s],l=0,f=0;f<i.psy_lmax;f++)o[l++]*=1+.029*f*f/Y.SBMAX_l/Y.SBMAX_l;if(i.block_type==Y.SHORT_TYPE)for(f=i.sfb_smin;f<Y.SBMAX_s;f++)o[l++]*=1+.029*f*f/Y.SBMAX_s/Y.SBMAX_s,o[l++]*=1+.029*f*f/Y.SBMAX_s/Y.SBMAX_s,o[l++]*=1+.029*f*f/Y.SBMAX_s/Y.SBMAX_s;n[a][s]=0|Math.max(r[a][s],.9*n[a][s])}},this.VBR_new_prepare=function(t,n,a,s,i,o){var l,f=t.internal_flags,_=1,u=0,h=0;if(t.free_format)f.bitrate_index=0,c=new M(u),l=e.ResvFrameBegin(t,c),u=c.bits,i[0]=l;else{f.bitrate_index=f.VBR_max_bitrate;var c=new M(u);e.ResvFrameBegin(t,c),u=c.bits,get_framebits(t,i),l=i[f.VBR_max_bitrate]}for(var p=0;p<f.mode_gr;p++){r.on_pe(t,n,o[p],u,p,0),f.mode_ext==Y.MPG_MD_MS_LR&&ms_convert(f.l3_side,p);for(var m=0;m<f.channels_out;++m){var b=f.l3_side.tt[p][m];f.masking_lower=Math.pow(10,.1*f.PSY.mask_adjust),init_outer_loop(f,b),0!=r.calc_xmin(t,a[p][m],b,s[p][m])&&(_=0),h+=o[p][m]}}for(p=0;p<f.mode_gr;p++)for(m=0;m<f.channels_out;m++)h>l&&(o[p][m]*=l,o[p][m]/=h);return _},this.calc_target_bits=function(n,a,s,i,o,l){var f,_,u,h,c=n.internal_flags,p=c.l3_side,m=0;c.bitrate_index=c.VBR_max_bitrate;var b=new M(m);for(l[0]=e.ResvFrameBegin(n,b),m=b.bits,c.bitrate_index=1,m=t.getframebits(n)-8*c.sideinfo_len,o[0]=m/(c.mode_gr*c.channels_out),m=n.VBR_mean_bitrate_kbps*n.framesize*1e3,0!=(1&c.substep_shaping)&&(m*=1.09),m/=n.out_samplerate,m-=8*c.sideinfo_len,m/=c.mode_gr*c.channels_out,(f=.93+.07*(11-n.compression_ratio)/5.5)<.9&&(f=.9),f>1&&(f=1),_=0;_<c.mode_gr;_++){var d=0;for(u=0;u<c.channels_out;u++){if(i[_][u]=int(f*m),a[_][u]>700){var v=int((a[_][u]-700)/1.4),g=p.tt[_][u];i[_][u]=int(f*m),g.block_type==Y.SHORT_TYPE&&v<m/2&&(v=m/2),v>3*m/2?v=3*m/2:v<0&&(v=0),i[_][u]+=v}i[_][u]>X.MAX_BITS_PER_CHANNEL&&(i[_][u]=X.MAX_BITS_PER_CHANNEL),d+=i[_][u]}if(d>X.MAX_BITS_PER_GRANULE)for(u=0;u<c.channels_out;++u)i[_][u]*=X.MAX_BITS_PER_GRANULE,i[_][u]/=d}if(c.mode_ext==Y.MPG_MD_MS_LR)for(_=0;_<c.mode_gr;_++)r.reduce_side(i[_],s[_],m*c.channels_out,X.MAX_BITS_PER_GRANULE);for(h=0,_=0;_<c.mode_gr;_++)for(u=0;u<c.channels_out;u++)i[_][u]>X.MAX_BITS_PER_CHANNEL&&(i[_][u]=X.MAX_BITS_PER_CHANNEL),h+=i[_][u];if(h>l[0])for(_=0;_<c.mode_gr;_++)for(u=0;u<c.channels_out;u++)i[_][u]*=l[0],i[_][u]/=h}}function V(){var t=[-.1482523854003001,32.308141959636465,296.40344946382766,883.1344870032432,11113.947376231741,1057.2713659324597,305.7402417275812,30.825928907280012,3.8533188138216365,59.42900443849514,709.5899960123345,5281.91112291017,-5829.66483675846,-817.6293103748613,-76.91656988279972,-4.594269939176596,.9063471690191471,.1960342806591213,-.15466694054279598,34.324387823855965,301.8067566458425,817.599602898885,11573.795901679885,1181.2520595540152,321.59731579894424,31.232021761053772,3.7107095756221318,53.650946155329365,684.167428119626,5224.56624370173,-6366.391851890084,-908.9766368219582,-89.83068876699639,-5.411397422890401,.8206787908286602,.3901806440322567,-.16070888947830023,36.147034243915876,304.11815768187864,732.7429163887613,11989.60988270091,1300.012278487897,335.28490093152146,31.48816102859945,3.373875931311736,47.232241542899175,652.7371796173471,5132.414255594984,-6909.087078780055,-1001.9990371107289,-103.62185754286375,-6.104916304710272,.7416505462720353,.5805693545089249,-.16636367662261495,37.751650073343995,303.01103387567713,627.9747488785183,12358.763425278165,1412.2779918482834,346.7496836825721,31.598286663170416,3.1598635433980946,40.57878626349686,616.1671130880391,5007.833007176154,-7454.040671756168,-1095.7960341867115,-118.24411666465777,-6.818469345853504,.6681786379192989,.7653668647301797,-.1716176790982088,39.11551877123304,298.3413246578966,503.5259106886539,12679.589408408976,1516.5821921214542,355.9850766329023,31.395241710249053,2.9164211881972335,33.79716964664243,574.8943997801362,4853.234992253242,-7997.57021486075,-1189.7624067269965,-133.6444792601766,-7.7202770609839915,.5993769336819237,.9427934736519954,-.17645823955292173,40.21879108166477,289.9982036694474,359.3226160751053,12950.259102786438,1612.1013903507662,362.85067106591504,31.045922092242872,2.822222032597987,26.988862316190684,529.8996541764288,4671.371946949588,-8535.899136645805,-1282.5898586244496,-149.58553632943463,-8.643494270763135,.5345111359507916,1.111140466039205,-.36174739330527045,41.04429910497807,277.5463268268618,195.6386023135583,13169.43812144731,1697.6433561479398,367.40983966190305,30.557037410382826,2.531473372857427,20.070154905927314,481.50208566532336,4464.970341588308,-9065.36882077239,-1373.62841526722,-166.1660487028118,-9.58289321133207,.4729647758913199,1.268786568327291,-.36970682634889585,41.393213350082036,261.2935935556502,12.935476055240873,13336.131683328815,1772.508612059496,369.76534388639965,29.751323653701338,2.4023193045459172,13.304795348228817,430.5615775526625,4237.0568611071185,-9581.931701634761,-1461.6913552409758,-183.12733958476446,-10.718010163869403,.41421356237309503,1.414213562373095,-.37677560326535325,41.619486213528496,241.05423794991074,-187.94665032361226,13450.063605744153,1836.153896465782,369.4908799925761,29.001847876923147,2.0714759319987186,6.779591200894186,377.7767837205709,3990.386575512536,-10081.709459700915,-1545.947424837898,-200.3762958015653,-11.864482073055006,.3578057213145241,1.546020906725474,-.3829366947518991,41.1516456456653,216.47684307105183,-406.1569483347166,13511.136535077321,1887.8076599260432,367.3025214564151,28.136213436723654,1.913880671464418,.3829366947518991,323.85365704338597,3728.1472257487526,-10561.233882199509,-1625.2025997821418,-217.62525175416,-13.015432208941645,.3033466836073424,1.66293922460509,-.5822628872992417,40.35639251440489,188.20071124269245,-640.2706748618148,13519.21490106562,1927.6022433578062,362.8197642637487,26.968821921868447,1.7463817695935329,-5.62650678237171,269.3016715297017,3453.386536448852,-11016.145278780888,-1698.6569643425091,-234.7658734267683,-14.16351421663124,.2504869601913055,1.76384252869671,-.5887180101749253,39.23429103868072,155.76096234403798,-889.2492977967378,13475.470561874661,1955.0535223723712,356.4450994756727,25.894952980042156,1.5695032905781554,-11.181939564328772,214.80884394039484,3169.1640829158237,-11443.321309975563,-1765.1588461316153,-251.68908574481912,-15.49755935939164,.198912367379658,1.847759065022573,-.7912582233652842,37.39369355329111,119.699486012458,-1151.0956593239027,13380.446257078214,1970.3952110853447,348.01959814116185,24.731487364283044,1.3850130831637748,-16.421408865300393,161.05030052864092,2878.3322807850063,-11838.991423510031,-1823.985884688674,-268.2854986386903,-16.81724543849939,.1483359875383474,1.913880671464418,-.7960642926861912,35.2322109610459,80.01928065061526,-1424.0212633405113,13235.794061869668,1973.804052543835,337.9908651258184,23.289159354463873,1.3934255946442087,-21.099669467133474,108.48348407242611,2583.700758091299,-12199.726194855148,-1874.2780658979746,-284.2467154529415,-18.11369784385905,.09849140335716425,1.961570560806461,-.998795456205172,32.56307803611191,36.958364584370486,-1706.075448829146,13043.287458812016,1965.3831106103316,326.43182772364605,22.175018750622293,1.198638339011324,-25.371248002043963,57.53505923036915,2288.41886619975,-12522.674544337233,-1914.8400385312243,-299.26241273417224,-19.37805630698734,.04912684976946725,1.990369453344394,.035780907*u.SQRT2*.5/2384e-9,.017876148*u.SQRT2*.5/2384e-9,.003134727*u.SQRT2*.5/2384e-9,.002457142*u.SQRT2*.5/2384e-9,971317e-9*u.SQRT2*.5/2384e-9,218868e-9*u.SQRT2*.5/2384e-9,101566e-9*u.SQRT2*.5/2384e-9,13828e-9*u.SQRT2*.5/2384e-9,12804.797818791945,1945.5515939597317,313.4244966442953,20.801593959731544,1995.1556208053692,9.000838926174497,-29.20218120805369],e=[[2382191739347913e-28,6423305872147834e-28,9400849094049688e-28,1122435026096556e-27,1183840321267481e-27,1122435026096556e-27,940084909404969e-27,6423305872147839e-28,2382191739347918e-28,5456116108943412e-27,4878985199565852e-27,4240448995017367e-27,3559909094758252e-27,2858043359288075e-27,2156177623817898e-27,1475637723558783e-27,8371015190102974e-28,2599706096327376e-28,-5456116108943412e-27,-4878985199565852e-27,-4240448995017367e-27,-3559909094758252e-27,-2858043359288076e-27,-2156177623817898e-27,-1475637723558783e-27,-8371015190102975e-28,-2599706096327376e-28,-2382191739347923e-28,-6423305872147843e-28,-9400849094049696e-28,-1122435026096556e-27,-1183840321267481e-27,-1122435026096556e-27,-9400849094049694e-28,-642330587214784e-27,-2382191739347918e-28],[2382191739347913e-28,6423305872147834e-28,9400849094049688e-28,1122435026096556e-27,1183840321267481e-27,1122435026096556e-27,9400849094049688e-28,6423305872147841e-28,2382191739347918e-28,5456116108943413e-27,4878985199565852e-27,4240448995017367e-27,3559909094758253e-27,2858043359288075e-27,2156177623817898e-27,1475637723558782e-27,8371015190102975e-28,2599706096327376e-28,-5461314069809755e-27,-4921085770524055e-27,-4343405037091838e-27,-3732668368707687e-27,-3093523840190885e-27,-2430835727329465e-27,-1734679010007751e-27,-974825365660928e-27,-2797435120168326e-28,0,0,0,0,0,0,-2283748241799531e-28,-4037858874020686e-28,-2146547464825323e-28],[.1316524975873958,.414213562373095,.7673269879789602,1.091308501069271,1.303225372841206,1.56968557711749,1.920982126971166,2.414213562373094,3.171594802363212,4.510708503662055,7.595754112725146,22.90376554843115,.984807753012208,.6427876096865394,.3420201433256688,.9396926207859084,-.1736481776669303,-.7660444431189779,.8660254037844387,.5,-.5144957554275265,-.4717319685649723,-.3133774542039019,-.1819131996109812,-.09457419252642064,-.04096558288530405,-.01419856857247115,-.003699974673760037,.8574929257125442,.8817419973177052,.9496286491027329,.9833145924917901,.9955178160675857,.9991605581781475,.999899195244447,.9999931550702802],[0,0,0,0,0,0,2283748241799531e-28,4037858874020686e-28,2146547464825323e-28,5461314069809755e-27,4921085770524055e-27,4343405037091838e-27,3732668368707687e-27,3093523840190885e-27,2430835727329466e-27,1734679010007751e-27,974825365660928e-27,2797435120168326e-28,-5456116108943413e-27,-4878985199565852e-27,-4240448995017367e-27,-3559909094758253e-27,-2858043359288075e-27,-2156177623817898e-27,-1475637723558782e-27,-8371015190102975e-28,-2599706096327376e-28,-2382191739347913e-28,-6423305872147834e-28,-9400849094049688e-28,-1122435026096556e-27,-1183840321267481e-27,-1122435026096556e-27,-9400849094049688e-28,-6423305872147841e-28,-2382191739347918e-28]],r=e[Y.SHORT_TYPE],n=e[Y.SHORT_TYPE],s=e[Y.SHORT_TYPE],i=e[Y.SHORT_TYPE],o=[0,1,16,17,8,9,24,25,4,5,20,21,12,13,28,29,2,3,18,19,10,11,26,27,6,7,22,23,14,15,30,31];function l(e,r,n){for(var a,s,i,o=10,l=r+238-14-286,f=-15;f<0;f++){var _,h,c;_=t[o+-10],h=e[l+-224]*_,c=e[r+224]*_,_=t[o+-9],h+=e[l+-160]*_,c+=e[r+160]*_,_=t[o+-8],h+=e[l+-96]*_,c+=e[r+96]*_,_=t[o+-7],h+=e[l+-32]*_,c+=e[r+32]*_,_=t[o+-6],h+=e[l+32]*_,c+=e[r+-32]*_,_=t[o+-5],h+=e[l+96]*_,c+=e[r+-96]*_,_=t[o+-4],h+=e[l+160]*_,c+=e[r+-160]*_,_=t[o+-3],h+=e[l+224]*_,c+=e[r+-224]*_,_=t[o+-2],h+=e[r+-256]*_,c-=e[l+256]*_,_=t[o+-1],h+=e[r+-192]*_,c-=e[l+192]*_,_=t[o+0],h+=e[r+-128]*_,c-=e[l+128]*_,_=t[o+1],h+=e[r+-64]*_,c-=e[l+64]*_,_=t[o+2],h+=e[r+0]*_,c-=e[l+0]*_,_=t[o+3],h+=e[r+64]*_,c-=e[l+-64]*_,_=t[o+4],h+=e[r+128]*_,c-=e[l+-128]*_,_=t[o+5],h+=e[r+192]*_,_=(c-=e[l+-192]*_)-(h*=t[o+6]),n[30+2*f]=c+h,n[31+2*f]=t[o+7]*_,o+=18,r--,l++}c=e[r+-16]*t[o+-10],h=e[r+-32]*t[o+-2],c+=(e[r+-48]-e[r+16])*t[o+-9],h+=e[r+-96]*t[o+-1],c+=(e[r+-80]+e[r+48])*t[o+-8],h+=e[r+-160]*t[o+0],c+=(e[r+-112]-e[r+80])*t[o+-7],h+=e[r+-224]*t[o+1],c+=(e[r+-144]+e[r+112])*t[o+-6],h-=e[r+32]*t[o+2],c+=(e[r+-176]-e[r+144])*t[o+-5],h-=e[r+96]*t[o+3],c+=(e[r+-208]+e[r+176])*t[o+-4],h-=e[r+160]*t[o+4],c+=(e[r+-240]-e[r+208])*t[o+-3],a=(h-=e[r+224])-c,s=h+c,c=n[14],h=n[15]-c,n[31]=s+c,n[30]=a+h,n[15]=a-h,n[14]=s-c,i=n[28]-n[0],n[0]+=n[28],n[28]=i*t[o+-36+7],i=n[29]-n[1],n[1]+=n[29],n[29]=i*t[o+-36+7],i=n[26]-n[2],n[2]+=n[26],n[26]=i*t[o+-72+7],i=n[27]-n[3],n[3]+=n[27],n[27]=i*t[o+-72+7],i=n[24]-n[4],n[4]+=n[24],n[24]=i*t[o+-108+7],i=n[25]-n[5],n[5]+=n[25],n[25]=i*t[o+-108+7],i=n[22]-n[6],n[6]+=n[22],n[22]=i*u.SQRT2,i=n[23]-n[7],n[7]+=n[23],n[23]=i*u.SQRT2-n[7],n[7]-=n[6],n[22]-=n[7],n[23]-=n[22],i=n[6],n[6]=n[31]-i,n[31]=n[31]+i,i=n[7],n[7]=n[30]-i,n[30]=n[30]+i,i=n[22],n[22]=n[15]-i,n[15]=n[15]+i,i=n[23],n[23]=n[14]-i,n[14]=n[14]+i,i=n[20]-n[8],n[8]+=n[20],n[20]=i*t[o+-180+7],i=n[21]-n[9],n[9]+=n[21],n[21]=i*t[o+-180+7],i=n[18]-n[10],n[10]+=n[18],n[18]=i*t[o+-216+7],i=n[19]-n[11],n[11]+=n[19],n[19]=i*t[o+-216+7],i=n[16]-n[12],n[12]+=n[16],n[16]=i*t[o+-252+7],i=n[17]-n[13],n[13]+=n[17],n[17]=i*t[o+-252+7],i=-n[20]+n[24],n[20]+=n[24],n[24]=i*t[o+-216+7],i=-n[21]+n[25],n[21]+=n[25],n[25]=i*t[o+-216+7],i=n[4]-n[8],n[4]+=n[8],n[8]=i*t[o+-216+7],i=n[5]-n[9],n[5]+=n[9],n[9]=i*t[o+-216+7],i=n[0]-n[12],n[0]+=n[12],n[12]=i*t[o+-72+7],i=n[1]-n[13],n[1]+=n[13],n[13]=i*t[o+-72+7],i=n[16]-n[28],n[16]+=n[28],n[28]=i*t[o+-72+7],i=-n[17]+n[29],n[17]+=n[29],n[29]=i*t[o+-72+7],i=u.SQRT2*(n[2]-n[10]),n[2]+=n[10],n[10]=i,i=u.SQRT2*(n[3]-n[11]),n[3]+=n[11],n[11]=i,i=u.SQRT2*(-n[18]+n[26]),n[18]+=n[26],n[26]=i-n[18],i=u.SQRT2*(-n[19]+n[27]),n[19]+=n[27],n[27]=i-n[19],i=n[2],n[19]-=n[3],n[3]-=i,n[2]=n[31]-i,n[31]+=i,i=n[3],n[11]-=n[19],n[18]-=i,n[3]=n[30]-i,n[30]+=i,i=n[18],n[27]-=n[11],n[19]-=i,n[18]=n[15]-i,n[15]+=i,i=n[19],n[10]-=i,n[19]=n[14]-i,n[14]+=i,i=n[10],n[11]-=i,n[10]=n[23]-i,n[23]+=i,i=n[11],n[26]-=i,n[11]=n[22]-i,n[22]+=i,i=n[26],n[27]-=i,n[26]=n[7]-i,n[7]+=i,i=n[27],n[27]=n[6]-i,n[6]+=i,i=u.SQRT2*(n[0]-n[4]),n[0]+=n[4],n[4]=i,i=u.SQRT2*(n[1]-n[5]),n[1]+=n[5],n[5]=i,i=u.SQRT2*(n[16]-n[20]),n[16]+=n[20],n[20]=i,i=u.SQRT2*(n[17]-n[21]),n[17]+=n[21],n[21]=i,i=-u.SQRT2*(n[8]-n[12]),n[8]+=n[12],n[12]=i-n[8],i=-u.SQRT2*(n[9]-n[13]),n[9]+=n[13],n[13]=i-n[9],i=-u.SQRT2*(n[25]-n[29]),n[25]+=n[29],n[29]=i-n[25],i=-u.SQRT2*(n[24]+n[28]),n[24]-=n[28],n[28]=i-n[24],i=n[24]-n[16],n[24]=i,i=n[20]-i,n[20]=i,i=n[28]-i,n[28]=i,i=n[25]-n[17],n[25]=i,i=n[21]-i,n[21]=i,i=n[29]-i,n[29]=i,i=n[17]-n[1],n[17]=i,i=n[9]-i,n[9]=i,i=n[25]-i,n[25]=i,i=n[5]-i,n[5]=i,i=n[21]-i,n[21]=i,i=n[13]-i,n[13]=i,i=n[29]-i,n[29]=i,i=n[1]-n[0],n[1]=i,i=n[16]-i,n[16]=i,i=n[17]-i,n[17]=i,i=n[8]-i,n[8]=i,i=n[9]-i,n[9]=i,i=n[24]-i,n[24]=i,i=n[25]-i,n[25]=i,i=n[4]-i,n[4]=i,i=n[5]-i,n[5]=i,i=n[20]-i,n[20]=i,i=n[21]-i,n[21]=i,i=n[12]-i,n[12]=i,i=n[13]-i,n[13]=i,i=n[28]-i,n[28]=i,i=n[29]-i,n[29]=i,i=n[0],n[0]+=n[31],n[31]-=i,i=n[1],n[1]+=n[30],n[30]-=i,i=n[16],n[16]+=n[15],n[15]-=i,i=n[17],n[17]+=n[14],n[14]-=i,i=n[8],n[8]+=n[23],n[23]-=i,i=n[9],n[9]+=n[22],n[22]-=i,i=n[24],n[24]+=n[7],n[7]-=i,i=n[25],n[25]+=n[6],n[6]-=i,i=n[4],n[4]+=n[27],n[27]-=i,i=n[5],n[5]+=n[26],n[26]-=i,i=n[20],n[20]+=n[11],n[11]-=i,i=n[21],n[21]+=n[10],n[10]-=i,i=n[12],n[12]+=n[19],n[19]-=i,i=n[13],n[13]+=n[18],n[18]-=i,i=n[28],n[28]+=n[3],n[3]-=i,i=n[29],n[29]+=n[2],n[2]-=i}function h(t,r){for(var n=0;n<3;n++){var a,s,i,o,l,f;s=(o=t[r+6]*e[Y.SHORT_TYPE][0]-t[r+15])+(a=t[r+0]*e[Y.SHORT_TYPE][2]-t[r+9]),i=o-a,l=(o=t[r+15]*e[Y.SHORT_TYPE][0]+t[r+6])+(a=t[r+9]*e[Y.SHORT_TYPE][2]+t[r+0]),f=-o+a,a=2069978111953089e-26*(t[r+3]*e[Y.SHORT_TYPE][1]-t[r+12]),o=2069978111953089e-26*(t[r+12]*e[Y.SHORT_TYPE][1]+t[r+3]),t[r+0]=190752519173728e-25*s+a,t[r+15]=190752519173728e-25*-l+o,i=.8660254037844387*i*1907525191737281e-26,l=.5*l*1907525191737281e-26+o,t[r+3]=i-l,t[r+6]=i+l,s=.5*s*1907525191737281e-26-a,f=.8660254037844387*f*1907525191737281e-26,t[r+9]=s+f,t[r+12]=s-f,r++}}this.mdct_sub48=function(t,u,c){for(var p,m,b,d,v,g,w,y,S,A,B,M,R,E,T,x,k,P,I,L,H,C=u,N=286,O=0;O<t.channels_out;O++){for(var V=0;V<t.mode_gr;V++){for(var D,U=t.l3_side.tt[V][O],F=U.xr,j=0,q=t.sb_sample[O][1-V],X=0,z=0;z<9;z++)for(l(C,N,q[X]),l(C,N+32,q[X+1]),X+=2,N+=64,D=1;D<32;D+=2)q[X-1][D]*=-1;for(D=0;D<32;D++,j+=18){var K=U.block_type,Z=t.sb_sample[O][V],Q=t.sb_sample[O][1-V];if(0!=U.mixed_block_flag&&D<2&&(K=0),t.amp_filter[D]<1e-12)f.fill(F,j+0,j+18,0);else{if(t.amp_filter[D]<1)for(z=0;z<18;z++)Q[z][o[D]]*=t.amp_filter[D];if(K==Y.SHORT_TYPE){for(z=-3;z<0;z++){var G=e[Y.SHORT_TYPE][z+3];F[j+3*z+9]=Z[9+z][o[D]]*G-Z[8-z][o[D]],F[j+3*z+18]=Z[14-z][o[D]]*G+Z[15+z][o[D]],F[j+3*z+10]=Z[15+z][o[D]]*G-Z[14-z][o[D]],F[j+3*z+19]=Q[2-z][o[D]]*G+Q[3+z][o[D]],F[j+3*z+11]=Q[3+z][o[D]]*G-Q[2-z][o[D]],F[j+3*z+20]=Q[8-z][o[D]]*G+Q[9+z][o[D]]}h(F,j)}else{var W=a(18);for(z=-9;z<0;z++){var J,$;J=e[K][z+27]*Q[z+9][o[D]]+e[K][z+36]*Q[8-z][o[D]],$=e[K][z+9]*Z[z+9][o[D]]-e[K][z+18]*Z[8-z][o[D]],W[z+9]=J-$*r[3+z+9],W[z+18]=J*r[3+z+9]+$}p=F,m=j,d=void 0,v=void 0,void 0,void 0,void 0,void 0,void 0,B=void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,I=void 0,void 0,void 0,g=(b=W)[17]-b[9],y=b[15]-b[11],S=b[14]-b[12],A=b[0]+b[8],B=b[1]+b[7],M=b[2]+b[6],R=b[3]+b[5],p[m+17]=A+M-R-(B-b[4]),v=(A+M-R)*n[19]+(B-b[4]),d=(g-y-S)*n[18],p[m+5]=d+v,p[m+6]=d-v,w=(b[16]-b[10])*n[18],B=B*n[19]+b[4],d=g*n[12]+w+y*n[13]+S*n[14],v=-A*n[16]+B-M*n[17]+R*n[15],p[m+1]=d+v,p[m+2]=d-v,d=g*n[13]-w-y*n[14]+S*n[12],v=-A*n[17]+B-M*n[15]+R*n[16],p[m+9]=d+v,p[m+10]=d-v,d=g*n[14]-w+y*n[12]-S*n[13],v=A*n[15]-B+M*n[16]-R*n[17],p[m+13]=d+v,p[m+14]=d-v,E=b[8]-b[0],x=b[6]-b[2],k=b[5]-b[3],P=b[17]+b[9],I=b[16]+b[10],L=b[15]+b[11],H=b[14]+b[12],p[m+0]=P+L+H+(I+b[13]),d=(P+L+H)*n[19]-(I+b[13]),v=(E-x+k)*n[18],p[m+11]=d+v,p[m+12]=d-v,T=(b[7]-b[1])*n[18],I=b[13]-I*n[19],d=P*n[15]-I+L*n[16]+H*n[17],v=E*n[14]+T+x*n[12]+k*n[13],p[m+3]=d+v,p[m+4]=d-v,d=-P*n[17]+I-L*n[15]-H*n[16],v=E*n[13]+T-x*n[14]-k*n[12],p[m+7]=d+v,p[m+8]=d-v,d=-P*n[16]+I-L*n[17]-H*n[15],v=E*n[12]-T+x*n[13]-k*n[14],p[m+15]=d+v,p[m+16]=d-v}}if(K!=Y.SHORT_TYPE&&0!=D)for(z=7;z>=0;--z){var tt,et;tt=F[j+z]*s[20+z]+F[j+-1-z]*i[28+z],et=F[j+z]*i[28+z]-F[j+-1-z]*s[20+z],F[j+-1-z]=tt,F[j+z]=et}}}if(C=c,N=286,1==t.mode_gr)for(var rt=0;rt<18;rt++)_.arraycopy(t.sb_sample[O][1][rt],0,t.sb_sample[O][0][rt],0,32)}}}function D(){this.thm=new j,this.en=new j}function Y(){var t=Y.FFTOFFSET,e=Y.MPG_MD_MS_LR,r=null;this.psy=null;var i=null,o=null,f=null;this.setModules=function(t,e,n,a){r=t,this.psy=e,i=e,o=a,f=n};var u=new V;this.lame_encode_mp3_frame=function(h,c,b,d,v,g){var w,y=l([2,2]);y[0][0]=new D,y[0][1]=new D,y[1][0]=new D,y[1][1]=new D;var S,A=l([2,2]);A[0][0]=new D,A[0][1]=new D,A[1][0]=new D,A[1][1]=new D;var B,M,R,E=[null,null],T=h.internal_flags,x=s([2,4]),k=[.5,.5],P=[[0,0],[0,0]],I=[[0,0],[0,0]];if(E[0]=c,E[1]=b,0==T.lame_encode_frame_init&&function(t,e){var r,n,s=t.internal_flags;if(0==s.lame_encode_frame_init){var i,o,l=a(2014),f=a(2014);for(s.lame_encode_frame_init=1,i=0,o=0;i<286+576*(1+s.mode_gr);++i)i<576*s.mode_gr?(l[i]=0,2==s.channels_out&&(f[i]=0)):(l[i]=e[0][o],2==s.channels_out&&(f[i]=e[1][o]),++o);for(n=0;n<s.mode_gr;n++)for(r=0;r<s.channels_out;r++)s.l3_side.tt[n][r].block_type=Y.SHORT_TYPE;u.mdct_sub48(s,l,f)}}(h,E),T.padding=0,(T.slot_lag-=T.frac_SpF)<0&&(T.slot_lag+=h.out_samplerate,T.padding=1),0!=T.psymodel){var L=[null,null],H=0,C=n(2);for(R=0;R<T.mode_gr;R++){for(M=0;M<T.channels_out;M++)L[M]=E[M],H=576+576*R-Y.FFTOFFSET;if(0!=(h.VBR==p.vbr_mtrh||h.VBR==p.vbr_mt?i.L3psycho_anal_vbr(h,L,H,R,y,A,P[R],I[R],x[R],C):i.L3psycho_anal_ns(h,L,H,R,y,A,P[R],I[R],x[R],C)))return-4;for(h.mode==m.JOINT_STEREO&&(k[R]=x[R][2]+x[R][3],k[R]>0&&(k[R]=x[R][3]/k[R])),M=0;M<T.channels_out;M++){var N=T.l3_side.tt[R][M];N.block_type=C[M],N.mixed_block_flag=0}}}else for(R=0;R<T.mode_gr;R++)for(M=0;M<T.channels_out;M++)T.l3_side.tt[R][M].block_type=Y.NORM_TYPE,T.l3_side.tt[R][M].mixed_block_flag=0,I[R][M]=P[R][M]=700;if(function(t){var e,r;if(0!=t.ATH.useAdjust)if(r=t.loudness_sq[0][0],e=t.loudness_sq[1][0],2==t.channels_out?(r+=t.loudness_sq[0][1],e+=t.loudness_sq[1][1]):(r+=r,e+=e),2==t.mode_gr&&(r=Math.max(r,e)),r*=.5,(r*=t.ATH.aaSensitivityP)>.03125)t.ATH.adjust>=1?t.ATH.adjust=1:t.ATH.adjust<t.ATH.adjustLimit&&(t.ATH.adjust=t.ATH.adjustLimit),t.ATH.adjustLimit=1;else{var n=31.98*r+625e-6;t.ATH.adjust>=n?(t.ATH.adjust*=.075*n+.925,t.ATH.adjust<n&&(t.ATH.adjust=n)):t.ATH.adjustLimit>=n?t.ATH.adjust=n:t.ATH.adjust<t.ATH.adjustLimit&&(t.ATH.adjust=t.ATH.adjustLimit),t.ATH.adjustLimit=n}else t.ATH.adjust=1}(T),u.mdct_sub48(T,E[0],E[1]),T.mode_ext=Y.MPG_MD_LR_LR,h.force_ms)T.mode_ext=Y.MPG_MD_MS_LR;else if(h.mode==m.JOINT_STEREO){var O=0,V=0;for(R=0;R<T.mode_gr;R++)for(M=0;M<T.channels_out;M++)O+=I[R][M],V+=P[R][M];if(O<=1*V){var U=T.l3_side.tt[0],F=T.l3_side.tt[T.mode_gr-1];U[0].block_type==U[1].block_type&&F[0].block_type==F[1].block_type&&(T.mode_ext=Y.MPG_MD_MS_LR)}}if(T.mode_ext==e?(S=A,B=I):(S=y,B=P),h.analysis&&null!=T.pinfo)for(R=0;R<T.mode_gr;R++)for(M=0;M<T.channels_out;M++)T.pinfo.ms_ratio[R]=T.ms_ratio[R],T.pinfo.ms_ener_ratio[R]=k[R],T.pinfo.blocktype[R][M]=T.l3_side.tt[R][M].block_type,T.pinfo.pe[R][M]=B[R][M],_.arraycopy(T.l3_side.tt[R][M].xr,0,T.pinfo.xr[R][M],0,576),T.mode_ext==e&&(T.pinfo.ers[R][M]=T.pinfo.ers[R][M+2],_.arraycopy(T.pinfo.energy[R][M+2],0,T.pinfo.energy[R][M],0,T.pinfo.energy[R][M].length));if(h.VBR==p.vbr_off||h.VBR==p.vbr_abr){var j,q;for(j=0;j<18;j++)T.nsPsy.pefirbuf[j]=T.nsPsy.pefirbuf[j+1];for(q=0,R=0;R<T.mode_gr;R++)for(M=0;M<T.channels_out;M++)q+=B[R][M];for(T.nsPsy.pefirbuf[18]=q,q=T.nsPsy.pefirbuf[9],j=0;j<9;j++)q+=(T.nsPsy.pefirbuf[j]+T.nsPsy.pefirbuf[18-j])*Y.fircoef[j];for(q=3350*T.mode_gr*T.channels_out/q,R=0;R<T.mode_gr;R++)for(M=0;M<T.channels_out;M++)B[R][M]*=q}if(T.iteration_loop.iteration_loop(h,B,k,S),r.format_bitstream(h),w=r.copy_buffer(T,d,v,g,1),h.bWriteVbrTag&&o.addVbrFrame(h),h.analysis&&null!=T.pinfo){for(M=0;M<T.channels_out;M++){var X;for(X=0;X<t;X++)T.pinfo.pcmdata[M][X]=T.pinfo.pcmdata[M][X+h.framesize];for(X=t;X<1600;X++)T.pinfo.pcmdata[M][X]=E[M][X-t]}f.set_frame_pinfo(h,S)}return function(t){var e,r;for(t.bitrate_stereoMode_Hist[t.bitrate_index][4]++,t.bitrate_stereoMode_Hist[15][4]++,2==t.channels_out&&(t.bitrate_stereoMode_Hist[t.bitrate_index][t.mode_ext]++,t.bitrate_stereoMode_Hist[15][t.mode_ext]++),e=0;e<t.mode_gr;++e)for(r=0;r<t.channels_out;++r){var n=0|t.l3_side.tt[e][r].block_type;0!=t.l3_side.tt[e][r].mixed_block_flag&&(n=4),t.bitrate_blockType_Hist[t.bitrate_index][n]++,t.bitrate_blockType_Hist[t.bitrate_index][5]++,t.bitrate_blockType_Hist[15][n]++,t.bitrate_blockType_Hist[15][5]++}}(T),w}}function U(){this.sum=0,this.seen=0,this.want=0,this.pos=0,this.size=0,this.bag=null,this.nVbrNumFrames=0,this.nBytesWritten=0,this.TotalFrameSize=0}function F(){this.tt=[[null,null],[null,null]],this.main_data_begin=0,this.private_bits=0,this.resvDrain_pre=0,this.resvDrain_post=0,this.scfsi=[n(4),n(4)];for(var t=0;t<2;t++)for(var e=0;e<2;e++)this.tt[t][e]=new C}function j(){this.l=a(Y.SBMAX_l),this.s=s([Y.SBMAX_s,3]);var t=this;this.assign=function(e){_.arraycopy(e.l,0,t.l,0,Y.SBMAX_l);for(var r=0;r<Y.SBMAX_s;r++)for(var n=0;n<3;n++)t.s[r][n]=e.s[r][n]}}function q(){this.last_en_subshort=s([4,9]),this.lastAttacks=n(4),this.pefirbuf=a(19),this.longfact=a(Y.SBMAX_l),this.shortfact=a(Y.SBMAX_s),this.attackthre=0,this.attackthre_s=0}function X(){function t(){this.write_timing=0,this.ptr=0,this.buf=r(40)}this.Class_ID=0,this.lame_encode_frame_init=0,this.iteration_init_init=0,this.fill_buffer_resample_init=0,this.mfbuf=s([2,X.MFSIZE]),this.mode_gr=0,this.channels_in=0,this.channels_out=0,this.resample_ratio=0,this.mf_samples_to_encode=0,this.mf_size=0,this.VBR_min_bitrate=0,this.VBR_max_bitrate=0,this.bitrate_index=0,this.samplerate_index=0,this.mode_ext=0,this.lowpass1=0,this.lowpass2=0,this.highpass1=0,this.highpass2=0,this.noise_shaping=0,this.noise_shaping_amp=0,this.substep_shaping=0,this.psymodel=0,this.noise_shaping_stop=0,this.subblock_gain=0,this.use_best_huffman=0,this.full_outer_loop=0,this.l3_side=new F,this.ms_ratio=a(2),this.padding=0,this.frac_SpF=0,this.slot_lag=0,this.tag_spec=null,this.nMusicCRC=0,this.OldValue=n(2),this.CurrentStep=n(2),this.masking_lower=0,this.bv_scf=n(576),this.pseudohalf=n(N.SFBMAX),this.sfb21_extra=!1,this.inbuf_old=new Array(2),this.blackfilt=new Array(2*X.BPC+1),this.itime=new Float64Array(2),this.sideinfo_len=0,this.sb_sample=s([2,2,18,Y.SBLIMIT]),this.amp_filter=a(32),this.header=new Array(X.MAX_HEADER_BUF),this.h_ptr=0,this.w_ptr=0,this.ancillary_flag=0,this.ResvSize=0,this.ResvMax=0,this.scalefac_band=new I,this.minval_l=a(Y.CBANDS),this.minval_s=a(Y.CBANDS),this.nb_1=s([4,Y.CBANDS]),this.nb_2=s([4,Y.CBANDS]),this.nb_s1=s([4,Y.CBANDS]),this.nb_s2=s([4,Y.CBANDS]),this.s3_ss=null,this.s3_ll=null,this.decay=0,this.thm=new Array(4),this.en=new Array(4),this.tot_ener=a(4),this.loudness_sq=s([2,2]),this.loudness_sq_save=a(2),this.mld_l=a(Y.SBMAX_l),this.mld_s=a(Y.SBMAX_s),this.bm_l=n(Y.SBMAX_l),this.bo_l=n(Y.SBMAX_l),this.bm_s=n(Y.SBMAX_s),this.bo_s=n(Y.SBMAX_s),this.npart_l=0,this.npart_s=0,this.s3ind=i([Y.CBANDS,2]),this.s3ind_s=i([Y.CBANDS,2]),this.numlines_s=n(Y.CBANDS),this.numlines_l=n(Y.CBANDS),this.rnumlines_l=a(Y.CBANDS),this.mld_cb_l=a(Y.CBANDS),this.mld_cb_s=a(Y.CBANDS),this.numlines_s_num1=0,this.numlines_l_num1=0,this.pe=a(4),this.ms_ratio_s_old=0,this.ms_ratio_l_old=0,this.ms_ener_ratio_old=0,this.blocktype_old=n(2),this.nsPsy=new q,this.VBR_seek_table=new U,this.ATH=null,this.PSY=null,this.nogap_total=0,this.nogap_current=0,this.decode_on_the_fly=!0,this.findReplayGain=!0,this.findPeakSample=!0,this.PeakSample=0,this.RadioGain=0,this.AudiophileGain=0,this.rgdata=null,this.noclipGainChange=0,this.noclipScale=0,this.bitrate_stereoMode_Hist=i([16,5]),this.bitrate_blockType_Hist=i([16,6]),this.pinfo=null,this.hip=null,this.in_buffer_nsamples=0,this.in_buffer_0=null,this.in_buffer_1=null,this.iteration_loop=null;for(var e=0;e<this.en.length;e++)this.en[e]=new j;for(e=0;e<this.thm.length;e++)this.thm[e]=new j;for(e=0;e<this.header.length;e++)this.header[e]=new t}function z(){var t=a(Y.BLKSIZE),e=a(Y.BLKSIZE_s/2),r=[.9238795325112867,.3826834323650898,.9951847266721969,.0980171403295606,.9996988186962042,.02454122852291229,.9999811752826011,.006135884649154475];function n(t,e,n){var a,s,i,o=0,l=e+(n<<=1);a=4;do{var f,_,h,c,p,m,b;b=a>>1,m=(p=a<<1)+(c=a),a=p<<1,i=(s=e)+b;do{A=t[s+0]-t[s+c],S=t[s+0]+t[s+c],E=t[s+p]-t[s+m],M=t[s+p]+t[s+m],t[s+p]=S-M,t[s+0]=S+M,t[s+m]=A-E,t[s+c]=A+E,A=t[i+0]-t[i+c],S=t[i+0]+t[i+c],E=u.SQRT2*t[i+m],M=u.SQRT2*t[i+p],t[i+p]=S-M,t[i+0]=S+M,t[i+m]=A-E,t[i+c]=A+E,i+=a,s+=a}while(s<l);for(_=r[o+0],f=r[o+1],h=1;h<b;h++){var d,v;d=1-2*f*f,v=2*f*_,s=e+h,i=e+c-h;do{var g,w,y,S,A,B,M,R,E,T;w=v*t[s+c]-d*t[i+c],g=d*t[s+c]+v*t[i+c],A=t[s+0]-g,S=t[s+0]+g,B=t[i+0]-w,y=t[i+0]+w,w=v*t[s+m]-d*t[i+m],g=d*t[s+m]+v*t[i+m],E=t[s+p]-g,M=t[s+p]+g,T=t[i+p]-w,R=t[i+p]+w,w=f*M-_*T,g=_*M+f*T,t[s+p]=S-g,t[s+0]=S+g,t[i+m]=B-w,t[i+c]=B+w,w=_*R-f*E,g=f*R+_*E,t[i+p]=y-g,t[i+0]=y+g,t[s+m]=A-w,t[s+c]=A+w,i+=a,s+=a}while(s<l);_=(d=_)*r[o+0]-f*r[o+1],f=d*r[o+1]+f*r[o+0]}o+=2}while(a<n)}var s=[0,128,64,192,32,160,96,224,16,144,80,208,48,176,112,240,8,136,72,200,40,168,104,232,24,152,88,216,56,184,120,248,4,132,68,196,36,164,100,228,20,148,84,212,52,180,116,244,12,140,76,204,44,172,108,236,28,156,92,220,60,188,124,252,2,130,66,194,34,162,98,226,18,146,82,210,50,178,114,242,10,138,74,202,42,170,106,234,26,154,90,218,58,186,122,250,6,134,70,198,38,166,102,230,22,150,86,214,54,182,118,246,14,142,78,206,46,174,110,238,30,158,94,222,62,190,126,254];this.fft_short=function(t,r,a,i,o){for(var l=0;l<3;l++){var f=Y.BLKSIZE_s/2,_=65535&192*(l+1),u=Y.BLKSIZE_s/8-1;do{var h,c,p,m,b,d=255&s[u<<2];c=(h=e[d]*i[a][o+d+_])-(b=e[127-d]*i[a][o+d+_+128]),h+=b,m=(p=e[d+64]*i[a][o+d+_+64])-(b=e[63-d]*i[a][o+d+_+192]),p+=b,f-=4,r[l][f+0]=h+p,r[l][f+2]=h-p,r[l][f+1]=c+m,r[l][f+3]=c-m,c=(h=e[d+1]*i[a][o+d+_+1])-(b=e[126-d]*i[a][o+d+_+129]),h+=b,m=(p=e[d+65]*i[a][o+d+_+65])-(b=e[62-d]*i[a][o+d+_+193]),p+=b,r[l][f+Y.BLKSIZE_s/2+0]=h+p,r[l][f+Y.BLKSIZE_s/2+2]=h-p,r[l][f+Y.BLKSIZE_s/2+1]=c+m,r[l][f+Y.BLKSIZE_s/2+3]=c-m}while(--u>=0);n(r[l],f,Y.BLKSIZE_s/2)}},this.fft_long=function(e,r,a,i,o){var l=Y.BLKSIZE/8-1,f=Y.BLKSIZE/2;do{var _,u,h,c,p,m=255&s[l];u=(_=t[m]*i[a][o+m])-(p=t[m+512]*i[a][o+m+512]),_+=p,c=(h=t[m+256]*i[a][o+m+256])-(p=t[m+768]*i[a][o+m+768]),h+=p,r[0+(f-=4)]=_+h,r[f+2]=_-h,r[f+1]=u+c,r[f+3]=u-c,u=(_=t[m+1]*i[a][o+m+1])-(p=t[m+513]*i[a][o+m+513]),_+=p,c=(h=t[m+257]*i[a][o+m+257])-(p=t[m+769]*i[a][o+m+769]),h+=p,r[f+Y.BLKSIZE/2+0]=_+h,r[f+Y.BLKSIZE/2+2]=_-h,r[f+Y.BLKSIZE/2+1]=u+c,r[f+Y.BLKSIZE/2+3]=u-c}while(--l>=0);n(r,f,Y.BLKSIZE/2)},this.init_fft=function(r){for(var n=0;n<Y.BLKSIZE;n++)t[n]=.42-.5*Math.cos(2*Math.PI*(n+.5)/Y.BLKSIZE)+.08*Math.cos(4*Math.PI*(n+.5)/Y.BLKSIZE);for(n=0;n<Y.BLKSIZE_s/2;n++)e[n]=.5*(1-Math.cos(2*Math.PI*(n+.5)/Y.BLKSIZE_s))}}function K(){var t=new z,e=2.302585092994046,r=1/217621504/(Y.BLKSIZE/2),i=21,o=.2302585093;function l(t,e){for(var n=0,a=0;a<Y.BLKSIZE/2;++a)n+=t[a]*e.ATH.eql_w[a];return n*r}function _(e,r,n,a,s,i,o,f,_,h,c){var p=e.internal_flags;if(_<2)t.fft_long(p,a[s],_,h,c),t.fft_short(p,i[o],_,h,c);else if(2==_){for(var m=Y.BLKSIZE-1;m>=0;--m){var b=a[s+0][m],d=a[s+1][m];a[s+0][m]=(b+d)*u.SQRT2*.5,a[s+1][m]=(b-d)*u.SQRT2*.5}for(var v=2;v>=0;--v)for(m=Y.BLKSIZE_s-1;m>=0;--m)b=i[o+0][v][m],d=i[o+1][v][m],i[o+0][v][m]=(b+d)*u.SQRT2*.5,i[o+1][v][m]=(b-d)*u.SQRT2*.5}for(r[0]=a[s+0][0],r[0]*=r[0],m=Y.BLKSIZE/2-1;m>=0;--m){var g=a[s+0][Y.BLKSIZE/2-m],w=a[s+0][Y.BLKSIZE/2+m];r[Y.BLKSIZE/2-m]=.5*(g*g+w*w)}for(v=2;v>=0;--v)for(n[v][0]=i[o+0][v][0],n[v][0]*=n[v][0],m=Y.BLKSIZE_s/2-1;m>=0;--m)g=i[o+0][v][Y.BLKSIZE_s/2-m],w=i[o+0][v][Y.BLKSIZE_s/2+m],n[v][Y.BLKSIZE_s/2-m]=.5*(g*g+w*w);var y=0;for(m=11;m<Y.HBLKSIZE;m++)y+=r[m];if(p.tot_ener[_]=y,e.analysis){for(m=0;m<Y.HBLKSIZE;m++)p.pinfo.energy[f][_][m]=p.pinfo.energy_save[_][m],p.pinfo.energy_save[_][m]=r[m];p.pinfo.pe[f][_]=p.pe[_]}2==e.athaa_loudapprox&&_<2&&(p.loudness_sq[f][_]=p.loudness_sq_save[_],p.loudness_sq_save[_]=l(r,p))}var b,d,v,g=[1,.79433,.63096,.63096,.63096,.63096,.63096,.25119,.11749],w=[3.3246*3.3246,3.23837*3.23837,9.9500500969,9.0247369744,8.1854926609,7.0440875649,2.46209*2.46209,2.284*2.284,4.4892710641,1.96552*1.96552,1.82335*1.82335,1.69146*1.69146,2.4621061921,2.1508568964,1.37074*1.37074,1.31036*1.31036,1.5691069696,1.4555939904,1.16203*1.16203,1.2715945225,1.09428*1.09428,1.0659*1.0659,1.0779838276,1.0382591025,1],y=[1.7782755904,1.35879*1.35879,1.38454*1.38454,1.39497*1.39497,1.40548*1.40548,1.3537*1.3537,1.6999465924,1.22321*1.22321,1.3169398564,1],S=[5.5396212496,2.29259*2.29259,4.9868695969,2.12675*2.12675,2.02545*2.02545,1.87894*1.87894,1.74303*1.74303,1.61695*1.61695,2.2499700001,1.39148*1.39148,1.29083*1.29083,1.19746*1.19746,1.2339655056,1.0779838276];function A(t,e,r,n,a,s){var i,o,l;if(e>t){if(!(e<t*d))return t+e;i=e/t}else{if(t>=e*d)return t+e;i=t/e}if(t+=e,n+3<=6){if(i>=b)return t;var f=0|u.FAST_LOG10_X(i,16);return t*y[f]}return f=0|u.FAST_LOG10_X(i,16),e=0!=s?a.ATH.cb_s[r]*a.ATH.adjust:a.ATH.cb_l[r]*a.ATH.adjust,t<v*e?t>e?(o=1,f<=13&&(o=S[f]),l=u.FAST_LOG10_X(t/e,10/15),t*((w[f]-o)*l+o)):f>13?t:t*S[f]:t*w[f]}var B=[1.7782755904,1.35879*1.35879,1.38454*1.38454,1.39497*1.39497,1.40548*1.40548,1.3537*1.3537,1.6999465924,1.22321*1.22321,1.3169398564,1];function M(t,e,r){var n;if(t<0&&(t=0),e<0&&(e=0),t<=0)return e;if(e<=0)return t;if(n=e>t?e/t:t/e,-2<=r&&r<=2){if(n>=b)return t+e;var a=0|u.FAST_LOG10_X(n,16);return(t+e)*B[a]}return n<d?t+e:(t<e&&(t=e),t)}function R(t,e,r,n,a){var s,i,o=0,l=0;for(s=i=0;s<Y.SBMAX_s;++i,++s){for(var f=t.bo_s[s],_=t.npart_s,u=f<_?f:_;i<u;)o+=e[i],l+=r[i],i++;if(t.en[n].s[s][a]=o,t.thm[n].s[s][a]=l,i>=_){++s;break}var h=t.PSY.bo_s_weight[s],c=1-h;o=h*e[i],l=h*r[i],t.en[n].s[s][a]+=o,t.thm[n].s[s][a]+=l,o=c*e[i],l=c*r[i]}for(;s<Y.SBMAX_s;++s)t.en[n].s[s][a]=0,t.thm[n].s[s][a]=0}function E(t,e,r,n){var a,s,i=0,o=0;for(a=s=0;a<Y.SBMAX_l;++s,++a){for(var l=t.bo_l[a],f=t.npart_l,_=l<f?l:f;s<_;)i+=e[s],o+=r[s],s++;if(t.en[n].l[a]=i,t.thm[n].l[a]=o,s>=f){++a;break}var u=t.PSY.bo_l_weight[a],h=1-u;i=u*e[s],o=u*r[s],t.en[n].l[a]+=i,t.thm[n].l[a]+=o,i=h*e[s],o=h*r[s]}for(;a<Y.SBMAX_l;++a)t.en[n].l[a]=0,t.thm[n].l[a]=0}function T(t,e,r,n,a,s){var i,o,l=t.internal_flags;for(o=i=0;o<l.npart_s;++o){for(var f=0,_=0,u=l.numlines_s[o],h=0;h<u;++h,++i){var c=e[s][i];f+=c,_<c&&(_=c)}r[o]=f}for(i=o=0;o<l.npart_s;o++){var p=l.s3ind_s[o][0],m=l.s3_ss[i++]*r[p];for(++p;p<=l.s3ind_s[o][1];)m+=l.s3_ss[i]*r[p],++i,++p;var b=2*l.nb_s1[a][o];if(n[o]=Math.min(m,b),l.blocktype_old[1&a]==Y.SHORT_TYPE){b=16*l.nb_s2[a][o];var d=n[o];n[o]=Math.min(b,d)}l.nb_s2[a][o]=l.nb_s1[a][o],l.nb_s1[a][o]=m}for(;o<=Y.CBANDS;++o)r[o]=0,n[o]=0}function x(t,e,r){return r>=1?t:r<=0?e:e>0?Math.pow(t/e,r)*e:0}var k=[11.8,13.6,17.2,32,46.5,51.3,57.5,67.1,71.5,84.6,97.6,130];function P(t,r){for(var n=309.07,a=0;a<Y.SBMAX_s-1;a++)for(var s=0;s<3;s++){var i=t.thm.s[a][s];if(i>0){var o=i*r,l=t.en.s[a][s];l>o&&(n+=l>1e10*o?k[a]*(10*e):k[a]*u.FAST_LOG10(l/o))}}return n}var I=[6.8,5.8,5.8,6.4,6.5,9.9,12.1,14.4,15,18.9,21.6,26.9,34.2,40.2,46.8,56.5,60.7,73.9,85.7,93.4,126.1];function L(t,r){for(var n=281.0575,a=0;a<Y.SBMAX_l-1;a++){var s=t.thm.l[a];if(s>0){var i=s*r,o=t.en.l[a];o>i&&(n+=o>1e10*i?I[a]*(10*e):I[a]*u.FAST_LOG10(o/i))}}return n}function H(t,e,r,n,a){var s,i;for(s=i=0;s<t.npart_l;++s){var o,l=0,f=0;for(o=0;o<t.numlines_l[s];++o,++i){var _=e[i];l+=_,f<_&&(f=_)}r[s]=l,n[s]=f,a[s]=l*t.rnumlines_l[s]}}function C(t,e,r,n){var a=g.length-1,s=0,i=r[s]+r[s+1];for(i>0?((o=e[s])<e[s+1]&&(o=e[s+1]),(l=0|(i=20*(2*o-i)/(i*(t.numlines_l[s]+t.numlines_l[s+1]-1))))>a&&(l=a),n[s]=l):n[s]=0,s=1;s<t.npart_l-1;s++){var o,l;(i=r[s-1]+r[s]+r[s+1])>0?((o=e[s-1])<e[s]&&(o=e[s]),o<e[s+1]&&(o=e[s+1]),(l=0|(i=20*(3*o-i)/(i*(t.numlines_l[s-1]+t.numlines_l[s]+t.numlines_l[s+1]-1))))>a&&(l=a),n[s]=l):n[s]=0}(i=r[s-1]+r[s])>0?((o=e[s-1])<e[s]&&(o=e[s]),(l=0|(i=20*(2*o-i)/(i*(t.numlines_l[s-1]+t.numlines_l[s]-1))))>a&&(l=a),n[s]=l):n[s]=0}var N=[-1730326e-23,-.01703172,-1349528e-23,.0418072,-673278e-22,-.0876324,-30835e-21,.1863476,-1104424e-22,-.627638];function O(e,r,n,a,s,i,o,l){var f=e.internal_flags;if(a<2)t.fft_long(f,o[l],a,r,n);else if(2==a)for(var _=Y.BLKSIZE-1;_>=0;--_){var h=o[l+0][_],c=o[l+1][_];o[l+0][_]=(h+c)*u.SQRT2*.5,o[l+1][_]=(h-c)*u.SQRT2*.5}for(i[0]=o[l+0][0],i[0]*=i[0],_=Y.BLKSIZE/2-1;_>=0;--_){var p=o[l+0][Y.BLKSIZE/2-_],m=o[l+0][Y.BLKSIZE/2+_];i[Y.BLKSIZE/2-_]=.5*(p*p+m*m)}var b=0;for(_=11;_<Y.HBLKSIZE;_++)b+=i[_];if(f.tot_ener[a]=b,e.analysis){for(_=0;_<Y.HBLKSIZE;_++)f.pinfo.energy[s][a][_]=f.pinfo.energy_save[a][_],f.pinfo.energy_save[a][_]=i[_];f.pinfo.pe[s][a]=f.pe[a]}}function V(e,r,n,a,s,i,o,l){var f=e.internal_flags;if(0==s&&a<2&&t.fft_short(f,o[l],a,r,n),2==a)for(var _=Y.BLKSIZE_s-1;_>=0;--_){var h=o[l+0][s][_],c=o[l+1][s][_];o[l+0][s][_]=(h+c)*u.SQRT2*.5,o[l+1][s][_]=(h-c)*u.SQRT2*.5}for(i[s][0]=o[l+0][s][0],i[s][0]*=i[s][0],_=Y.BLKSIZE_s/2-1;_>=0;--_){var p=o[l+0][s][Y.BLKSIZE_s/2-_],m=o[l+0][s][Y.BLKSIZE_s/2+_];i[s][Y.BLKSIZE_s/2-_]=.5*(p*p+m*m)}}function D(t,e,r,n){var a=t.internal_flags;2==t.athaa_loudapprox&&r<2&&(a.loudness_sq[e][r]=a.loudness_sq_save[r],a.loudness_sq_save[r]=l(n,a))}this.L3psycho_anal_ns=function(t,e,r,o,l,u,c,b,d,v){var w,y,S,B,M,k,I,O,V,D,U=t.internal_flags,F=s([2,Y.BLKSIZE]),j=s([2,3,Y.BLKSIZE_s]),q=a(Y.CBANDS+1),X=a(Y.CBANDS+1),z=a(Y.CBANDS+2),K=n(2),Z=n(2),Q=s([2,576]),G=n(Y.CBANDS+2),W=n(Y.CBANDS+2);for(f.fill(W,0),w=U.channels_out,t.mode==m.JOINT_STEREO&&(w=4),V=t.VBR==p.vbr_off?0==U.ResvMax?0:U.ResvSize/U.ResvMax*.5:t.VBR==p.vbr_rh||t.VBR==p.vbr_mtrh||t.VBR==p.vbr_mt?.6:1,y=0;y<U.channels_out;y++){var J=e[y],$=r+576-350-i+192;for(B=0;B<576;B++){var tt,et;for(tt=J[$+B+10],et=0,M=0;M<9;M+=2)tt+=N[M]*(J[$+B+M]+J[$+B+i-M]),et+=N[M+1]*(J[$+B+M+1]+J[$+B+i-M-1]);Q[y][B]=tt+et}l[o][y].en.assign(U.en[y]),l[o][y].thm.assign(U.thm[y]),w>2&&(u[o][y].en.assign(U.en[y+2]),u[o][y].thm.assign(U.thm[y+2]))}for(y=0;y<w;y++){var rt,nt=a(12),at=[0,0,0,0],st=a(12),it=1,ot=a(Y.CBANDS),lt=a(Y.CBANDS),ft=[0,0,0,0],_t=a(Y.HBLKSIZE),ut=s([3,Y.HBLKSIZE_s]);for(B=0;B<3;B++)nt[B]=U.nsPsy.last_en_subshort[y][B+6],st[B]=nt[B]/U.nsPsy.last_en_subshort[y][B+4],at[0]+=nt[B];if(2==y)for(B=0;B<576;B++){var ht,ct;ht=Q[0][B],ct=Q[1][B],Q[0][B]=ht+ct,Q[1][B]=ht-ct}var pt=Q[1&y],mt=0;for(B=0;B<9;B++){for(var bt=mt+64,dt=1;mt<bt;mt++)dt<Math.abs(pt[mt])&&(dt=Math.abs(pt[mt]));U.nsPsy.last_en_subshort[y][B]=nt[B+3]=dt,at[1+B/3]+=dt,dt>nt[B+3-2]?dt/=nt[B+3-2]:dt=nt[B+3-2]>10*dt?nt[B+3-2]/(10*dt):0,st[B+3]=dt}if(t.analysis){var vt=st[0];for(B=1;B<12;B++)vt<st[B]&&(vt=st[B]);U.pinfo.ers[o][y]=U.pinfo.ers_save[y],U.pinfo.ers_save[y]=vt}for(rt=3==y?U.nsPsy.attackthre_s:U.nsPsy.attackthre,B=0;B<12;B++)0==ft[B/3]&&st[B]>rt&&(ft[B/3]=B%3+1);for(B=1;B<4;B++)(at[B-1]>at[B]?at[B-1]/at[B]:at[B]/at[B-1])<1.7&&(ft[B]=0,1==B&&(ft[0]=0));for(0!=ft[0]&&0!=U.nsPsy.lastAttacks[y]&&(ft[0]=0),3!=U.nsPsy.lastAttacks[y]&&ft[0]+ft[1]+ft[2]+ft[3]==0||(it=0,0!=ft[1]&&0!=ft[0]&&(ft[1]=0),0!=ft[2]&&0!=ft[1]&&(ft[2]=0),0!=ft[3]&&0!=ft[2]&&(ft[3]=0)),y<2?Z[y]=it:0==it&&(Z[0]=Z[1]=0),d[y]=U.tot_ener[y],_(t,_t,ut,F,1&y,j,1&y,o,y,e,r),H(U,_t,q,ot,lt),C(U,ot,lt,G),O=0;O<3;O++){var gt,wt;for(T(t,ut,X,z,y,O),R(U,X,z,y,O),I=0;I<Y.SBMAX_s;I++){if(wt=U.thm[y].s[I][O],wt*=.8,ft[O]>=2||1==ft[O+1]){var yt=0!=O?O-1:2;dt=x(U.thm[y].s[I][yt],wt,.6*V),wt=Math.min(wt,dt)}1==ft[O]?(yt=0!=O?O-1:2,dt=x(U.thm[y].s[I][yt],wt,.3*V),wt=Math.min(wt,dt)):(0!=O&&3==ft[O-1]||0==O&&3==U.nsPsy.lastAttacks[y])&&(yt=2!=O?O+1:0,dt=x(U.thm[y].s[I][yt],wt,.3*V),wt=Math.min(wt,dt)),gt=nt[3*O+3]+nt[3*O+4]+nt[3*O+5],6*nt[3*O+5]<gt&&(wt*=.5,6*nt[3*O+4]<gt&&(wt*=.5)),U.thm[y].s[I][O]=wt}}for(U.nsPsy.lastAttacks[y]=ft[2],k=0,S=0;S<U.npart_l;S++){for(var St=U.s3ind[S][0],At=q[St]*g[G[St]],Bt=U.s3_ll[k++]*At;++St<=U.s3ind[S][1];)At=q[St]*g[G[St]],Bt=A(Bt,U.s3_ll[k++]*At,St,St-S,U,0);Bt*=.158489319246111,U.blocktype_old[1&y]==Y.SHORT_TYPE?z[S]=Bt:z[S]=x(Math.min(Bt,Math.min(2*U.nb_1[y][S],16*U.nb_2[y][S])),Bt,V),U.nb_2[y][S]=U.nb_1[y][S],U.nb_1[y][S]=Bt}for(;S<=Y.CBANDS;++S)q[S]=0,z[S]=0;E(U,q,z,y)}for(t.mode!=m.STEREO&&t.mode!=m.JOINT_STEREO||t.interChRatio>0&&function(t,e){var r=t.internal_flags;if(r.channels_out>1){for(var n=0;n<Y.SBMAX_l;n++){var a=r.thm[0].l[n],s=r.thm[1].l[n];r.thm[0].l[n]+=s*e,r.thm[1].l[n]+=a*e}for(n=0;n<Y.SBMAX_s;n++)for(var i=0;i<3;i++)a=r.thm[0].s[n][i],s=r.thm[1].s[n][i],r.thm[0].s[n][i]+=s*e,r.thm[1].s[n][i]+=a*e}}(t,t.interChRatio),t.mode==m.JOINT_STEREO&&(function(t){for(var e=0;e<Y.SBMAX_l;e++)if(!(t.thm[0].l[e]>1.58*t.thm[1].l[e]||t.thm[1].l[e]>1.58*t.thm[0].l[e])){var r=t.mld_l[e]*t.en[3].l[e],n=Math.max(t.thm[2].l[e],Math.min(t.thm[3].l[e],r));r=t.mld_l[e]*t.en[2].l[e];var a=Math.max(t.thm[3].l[e],Math.min(t.thm[2].l[e],r));t.thm[2].l[e]=n,t.thm[3].l[e]=a}for(e=0;e<Y.SBMAX_s;e++)for(var s=0;s<3;s++)t.thm[0].s[e][s]>1.58*t.thm[1].s[e][s]||t.thm[1].s[e][s]>1.58*t.thm[0].s[e][s]||(r=t.mld_s[e]*t.en[3].s[e][s],n=Math.max(t.thm[2].s[e][s],Math.min(t.thm[3].s[e][s],r)),r=t.mld_s[e]*t.en[2].s[e][s],a=Math.max(t.thm[3].s[e][s],Math.min(t.thm[2].s[e][s],r)),t.thm[2].s[e][s]=n,t.thm[3].s[e][s]=a)}(U),D=t.msfix,Math.abs(D)>0&&function(t,e,r){var n=e,a=Math.pow(10,r);e*=2,n*=2;for(var s=0;s<Y.SBMAX_l;s++)_=t.ATH.cb_l[t.bm_l[s]]*a,(o=Math.min(Math.max(t.thm[0].l[s],_),Math.max(t.thm[1].l[s],_)))*e<(l=Math.max(t.thm[2].l[s],_))+(f=Math.max(t.thm[3].l[s],_))&&(l*=u=o*n/(l+f),f*=u),t.thm[2].l[s]=Math.min(l,t.thm[2].l[s]),t.thm[3].l[s]=Math.min(f,t.thm[3].l[s]);for(a*=Y.BLKSIZE_s/Y.BLKSIZE,s=0;s<Y.SBMAX_s;s++)for(var i=0;i<3;i++){var o,l,f,_,u;_=t.ATH.cb_s[t.bm_s[s]]*a,(o=Math.min(Math.max(t.thm[0].s[s][i],_),Math.max(t.thm[1].s[s][i],_)))*e<(l=Math.max(t.thm[2].s[s][i],_))+(f=Math.max(t.thm[3].s[s][i],_))&&(l*=u=o*e/(l+f),f*=u),t.thm[2].s[s][i]=Math.min(t.thm[2].s[s][i],l),t.thm[3].s[s][i]=Math.min(t.thm[3].s[s][i],f)}}(U,D,t.ATHlower*U.ATH.adjust)),function(t,e,r,n){var a=t.internal_flags;t.short_blocks!=h.short_block_coupled||0!=e[0]&&0!=e[1]||(e[0]=e[1]=0);for(var s=0;s<a.channels_out;s++)n[s]=Y.NORM_TYPE,t.short_blocks==h.short_block_dispensed&&(e[s]=1),t.short_blocks==h.short_block_forced&&(e[s]=0),0!=e[s]?a.blocktype_old[s]==Y.SHORT_TYPE&&(n[s]=Y.STOP_TYPE):(n[s]=Y.SHORT_TYPE,a.blocktype_old[s]==Y.NORM_TYPE&&(a.blocktype_old[s]=Y.START_TYPE),a.blocktype_old[s]==Y.STOP_TYPE&&(a.blocktype_old[s]=Y.SHORT_TYPE)),r[s]=a.blocktype_old[s],a.blocktype_old[s]=n[s]}(t,Z,v,K),y=0;y<w;y++){var Mt,Rt,Et,Tt=0;y>1?(Mt=b,Tt=-2,Rt=Y.NORM_TYPE,v[0]!=Y.SHORT_TYPE&&v[1]!=Y.SHORT_TYPE||(Rt=Y.SHORT_TYPE),Et=u[o][y-2]):(Mt=c,Tt=0,Rt=v[y],Et=l[o][y]),Rt==Y.SHORT_TYPE?Mt[Tt+y]=P(Et,U.masking_lower):Mt[Tt+y]=L(Et,U.masking_lower),t.analysis&&(U.pinfo.pe[o][y]=Mt[Tt+y])}return 0};var U=[-1730326e-23,-.01703172,-1349528e-23,.0418072,-673278e-22,-.0876324,-30835e-21,.1863476,-1104424e-22,-.627638];function F(t,e,r){if(0==r)for(var n=0;n<t.npart_s;n++)t.nb_s2[e][n]=t.nb_s1[e][n],t.nb_s1[e][n]=0}function j(t,e){for(var r=0;r<t.npart_l;r++)t.nb_2[e][r]=t.nb_1[e][r],t.nb_1[e][r]=0}function q(t,e,r,n,s,i){var o,l,f,_=t.internal_flags,u=new float[Y.CBANDS],h=a(Y.CBANDS),c=new int[Y.CBANDS];for(f=l=0;f<_.npart_s;++f){var p=0,m=0,b=_.numlines_s[f];for(o=0;o<b;++o,++l){var d=e[i][l];p+=d,m<d&&(m=d)}r[f]=p,u[f]=m,h[f]=p/b}for(;f<Y.CBANDS;++f)u[f]=0,h[f]=0;for(function(t,e,r,n){var a=g.length-1,s=0,i=r[s]+r[s+1];for(i>0?((o=e[s])<e[s+1]&&(o=e[s+1]),(l=0|(i=20*(2*o-i)/(i*(t.numlines_s[s]+t.numlines_s[s+1]-1))))>a&&(l=a),n[s]=l):n[s]=0,s=1;s<t.npart_s-1;s++){var o,l;(i=r[s-1]+r[s]+r[s+1])>0?((o=e[s-1])<e[s]&&(o=e[s]),o<e[s+1]&&(o=e[s+1]),(l=0|(i=20*(3*o-i)/(i*(t.numlines_s[s-1]+t.numlines_s[s]+t.numlines_s[s+1]-1))))>a&&(l=a),n[s]=l):n[s]=0}(i=r[s-1]+r[s])>0?((o=e[s-1])<e[s]&&(o=e[s]),(l=0|(i=20*(2*o-i)/(i*(t.numlines_s[s-1]+t.numlines_s[s]-1))))>a&&(l=a),n[s]=l):n[s]=0}(_,u,h,c),l=f=0;f<_.npart_s;f++){var v,w,y,S,A,B=_.s3ind_s[f][0],R=_.s3ind_s[f][1];for(v=c[B],w=1,S=_.s3_ss[l]*r[B]*g[c[B]],++l,++B;B<=R;)v+=c[B],w+=1,S=M(S,y=_.s3_ss[l]*r[B]*g[c[B]],B-f),++l,++B;S*=A=.5*g[v=(1+2*v)/(2*w)],n[f]=S,_.nb_s2[s][f]=_.nb_s1[s][f],_.nb_s1[s][f]=S,y=u[f],y*=_.minval_s[f],y*=A,n[f]>y&&(n[f]=y),_.masking_lower>1&&(n[f]*=_.masking_lower),n[f]>r[f]&&(n[f]=r[f]),_.masking_lower<1&&(n[f]*=_.masking_lower)}for(;f<Y.CBANDS;++f)r[f]=0,n[f]=0}function X(t,e,r,s,i){var o,l=a(Y.CBANDS),f=a(Y.CBANDS),_=n(Y.CBANDS+2);H(t,e,r,l,f),C(t,l,f,_);var u=0;for(o=0;o<t.npart_l;o++){var h,c,p,m=t.s3ind[o][0],b=t.s3ind[o][1],d=0,v=0;for(d=_[m],v+=1,c=t.s3_ll[u]*r[m]*g[_[m]],++u,++m;m<=b;)d+=_[m],v+=1,c=M(c,h=t.s3_ll[u]*r[m]*g[_[m]],m-o),++u,++m;if(c*=p=.5*g[d=(1+2*d)/(2*v)],t.blocktype_old[1&i]==Y.SHORT_TYPE){var w=2*t.nb_1[i][o];s[o]=w>0?Math.min(c,w):Math.min(c,.3*r[o])}else{var y=16*t.nb_2[i][o],S=2*t.nb_1[i][o];y<=0&&(y=c),S<=0&&(S=c),w=t.blocktype_old[1&i]==Y.NORM_TYPE?Math.min(S,y):S,s[o]=Math.min(c,w)}t.nb_2[i][o]=t.nb_1[i][o],t.nb_1[i][o]=c,h=l[o],h*=t.minval_l[o],h*=p,s[o]>h&&(s[o]=h),t.masking_lower>1&&(s[o]*=t.masking_lower),s[o]>r[o]&&(s[o]=r[o]),t.masking_lower<1&&(s[o]*=t.masking_lower)}for(;o<Y.CBANDS;++o)r[o]=0,s[o]=0}function K(t,e,r,n,a,s,i){for(var o,l,f=2*s,_=s>0?Math.pow(10,a):1,u=0;u<i;++u){var h=t[2][u],c=t[3][u],p=e[0][u],m=e[1][u],b=e[2][u],d=e[3][u];if(p<=1.58*m&&m<=1.58*p){var v=r[u]*c,g=r[u]*h;l=Math.max(b,Math.min(d,v)),o=Math.max(d,Math.min(b,g))}else l=b,o=d;if(s>0){var w,y,S=n[u]*_;if(w=Math.min(Math.max(p,S),Math.max(m,S)),(y=(b=Math.max(l,S))+(d=Math.max(o,S)))>0&&w*f<y){var A=w*f/y;b*=A,d*=A}l=Math.min(b,l),o=Math.min(d,o)}l>h&&(l=h),o>c&&(o=c),e[2][u]=l,e[3][u]=o}}function Z(t,e){var r;return(r=t>=0?27*-t:t*e)<=-72?0:Math.exp(r*o)}function Q(t){var e,r,n,a,s=0;for(s=0;Z(s,t)>1e-20;s-=1);for(n=s,a=0;Math.abs(a-n)>1e-12;)Z(s=(a+n)/2,t)>0?a=s:n=s;for(e=n,s=0,s=0;Z(s,t)>1e-20;s+=1);for(n=0,a=s;Math.abs(a-n)>1e-12;)Z(s=(a+n)/2,t)>0?n=s:a=s;r=a;var i,o=0,l=1e3;for(i=0;i<=l;++i)o+=Z(s=e+i*(r-e)/l,t);return(l+1)/(o*(r-e))}function G(t){return t<0&&(t=0),t*=.001,13*Math.atan(.76*t)+3.5*Math.atan(t*t/56.25)}function W(t,e,r,s,i,o,l,f,_,u,h,c){var p,m=a(Y.CBANDS+1),b=f/(c>15?1152:384),d=n(Y.HBLKSIZE);f/=_;var v=0,g=0;for(p=0;p<Y.CBANDS;p++){var w;for(x=G(f*v),m[p]=f*v,w=v;G(f*w)-x<.34&&w<=_/2;w++);for(t[p]=w-v,g=p+1;v<w;)d[v++]=p;if(v>_/2){v=_/2,++p;break}}m[p]=f*v;for(var y=0;y<c;y++){var S,A,B,M,R;B=u[y],M=u[y+1],(S=0|Math.floor(.5+h*(B-.5)))<0&&(S=0),(A=0|Math.floor(.5+h*(M-.5)))>_/2&&(A=_/2),r[y]=(d[S]+d[A])/2,e[y]=d[A];var E=b*M;l[y]=(E-m[e[y]])/(m[e[y]+1]-m[e[y]]),l[y]<0?l[y]=0:l[y]>1&&(l[y]=1),R=G(f*u[y]*h),R=Math.min(R,15.5)/15.5,o[y]=Math.pow(10,1.25*(1-Math.cos(Math.PI*R))-2.5)}v=0;for(var T=0;T<g;T++){var x,k,P=t[T];x=G(f*v),k=G(f*(v+P-1)),s[T]=.5*(x+k),x=G(f*(v-.5)),k=G(f*(v+P-.5)),i[T]=k-x,v+=P}return g}function J(t,e,r,n,i,l){var f,_,u,h,c,p=s([Y.CBANDS,Y.CBANDS]),m=0;if(l)for(var b=0;b<e;b++)for(f=0;f<e;f++){var d=(_=void 0,void 0,void 0,c=void 0,_=r[b]-r[f],u=(_*=_>=0?3:1.5)>=.5&&_<=2.5?8*((c=_-.5)*c-2*c):0,((h=15.811389+7.5*(_+=.474)-17.5*Math.sqrt(1+_*_))<=-60?0:(_=Math.exp((u+h)*o),_/=.6609193))*n[f]);p[b][f]=d*i[b]}else for(f=0;f<e;f++){var v=15+Math.min(21/r[f],12),g=Q(v);for(b=0;b<e;b++)d=g*Z(r[b]-r[f],v)*n[f],p[b][f]=d*i[b]}for(b=0;b<e;b++){for(f=0;f<e&&!(p[b][f]>0);f++);for(t[b][0]=f,f=e-1;f>0&&!(p[b][f]>0);f--);t[b][1]=f,m+=t[b][1]-t[b][0]+1}var w=a(m),y=0;for(b=0;b<e;b++)for(f=t[b][0];f<=t[b][1];f++)w[y++]=p[b][f];return w}function $(t){var e=G(t);return e=Math.min(e,15.5)/15.5,Math.pow(10,1.25*(1-Math.cos(Math.PI*e))-2.5)}function tt(t,e){return t<-.3&&(t=3410),t/=1e3,t=Math.max(.1,t),3.64*Math.pow(t,-.8)-6.8*Math.exp(-.6*Math.pow(t-3.4,2))+6*Math.exp(-.15*Math.pow(t-8.7,2))+.001*(.6+.04*e)*Math.pow(t,4)}this.L3psycho_anal_vbr=function(t,e,r,o,l,f,_,u,c,p){var b=t.internal_flags,d=a(Y.HBLKSIZE),v=s([3,Y.HBLKSIZE_s]),g=s([2,Y.BLKSIZE]),w=s([2,3,Y.BLKSIZE_s]),y=s([4,Y.CBANDS]),S=s([4,Y.CBANDS]),A=s([4,3]),B=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],M=n(2),T=t.mode==m.JOINT_STEREO?4:b.channels_out;!function(t,e,r,n,o,l,f,_,u,h){for(var c=s([2,576]),p=t.internal_flags,b=p.channels_out,d=t.mode==m.JOINT_STEREO?4:b,v=0;v<b;v++){firbuf=e[v];for(var g=r+576-350-i+192,w=0;w<576;w++){var y,S;y=firbuf[g+w+10],S=0;for(var A=0;A<9;A+=2)y+=U[A]*(firbuf[g+w+A]+firbuf[g+w+i-A]),S+=U[A+1]*(firbuf[g+w+A+1]+firbuf[g+w+i-A-1]);c[v][w]=y+S}o[n][v].en.assign(p.en[v]),o[n][v].thm.assign(p.thm[v]),d>2&&(l[n][v].en.assign(p.en[v+2]),l[n][v].thm.assign(p.thm[v+2]))}for(v=0;v<d;v++){var B=a(12),M=a(12),R=[0,0,0,0],E=c[1&v],T=0,x=3==v?p.nsPsy.attackthre_s:p.nsPsy.attackthre,k=1;if(2==v)for(w=0,A=576;A>0;++w,--A){var P=c[0][w],I=c[1][w];c[0][w]=P+I,c[1][w]=P-I}for(w=0;w<3;w++)M[w]=p.nsPsy.last_en_subshort[v][w+6],B[w]=M[w]/p.nsPsy.last_en_subshort[v][w+4],R[0]+=M[w];for(w=0;w<9;w++){for(var L=T+64,H=1;T<L;T++)H<Math.abs(E[T])&&(H=Math.abs(E[T]));p.nsPsy.last_en_subshort[v][w]=M[w+3]=H,R[1+w/3]+=H,H>M[w+3-2]?H/=M[w+3-2]:H=M[w+3-2]>10*H?M[w+3-2]/(10*H):0,B[w+3]=H}for(w=0;w<3;++w){var C=M[3*w+3]+M[3*w+4]+M[3*w+5],N=1;6*M[3*w+5]<C&&(N*=.5,6*M[3*w+4]<C&&(N*=.5)),_[v][w]=N}if(t.analysis){var O=B[0];for(w=1;w<12;w++)O<B[w]&&(O=B[w]);p.pinfo.ers[n][v]=p.pinfo.ers_save[v],p.pinfo.ers_save[v]=O}for(w=0;w<12;w++)0==u[v][w/3]&&B[w]>x&&(u[v][w/3]=w%3+1);for(w=1;w<4;w++){var V=R[w-1],D=R[w];Math.max(V,D)<4e4&&V<1.7*D&&D<1.7*V&&(1==w&&u[v][0]<=u[v][w]&&(u[v][0]=0),u[v][w]=0)}u[v][0]<=p.nsPsy.lastAttacks[v]&&(u[v][0]=0),3!=p.nsPsy.lastAttacks[v]&&u[v][0]+u[v][1]+u[v][2]+u[v][3]==0||(k=0,0!=u[v][1]&&0!=u[v][0]&&(u[v][1]=0),0!=u[v][2]&&0!=u[v][1]&&(u[v][2]=0),0!=u[v][3]&&0!=u[v][2]&&(u[v][3]=0)),v<2?h[v]=k:0==k&&(h[0]=h[1]=0),f[v]=p.tot_ener[v]}}(t,e,r,o,l,f,c,A,B,M),function(t,e){var r=t.internal_flags;t.short_blocks!=h.short_block_coupled||0!=e[0]&&0!=e[1]||(e[0]=e[1]=0);for(var n=0;n<r.channels_out;n++)t.short_blocks==h.short_block_dispensed&&(e[n]=1),t.short_blocks==h.short_block_forced&&(e[n]=0)}(t,M);for(var k=0;k<T;k++)O(t,e,r,k,o,d,g,H=1&k),D(t,o,k,d),0!=M[H]?X(b,d,y[k],S[k],k):j(b,k);for(M[0]+M[1]==2&&t.mode==m.JOINT_STEREO&&K(y,S,b.mld_cb_l,b.ATH.cb_l,t.ATHlower*b.ATH.adjust,t.msfix,b.npart_l),k=0;k<T;k++)0!=M[H=1&k]&&E(b,y[k],S[k],k);for(var I=0;I<3;I++){for(k=0;k<T;++k)0!=M[H=1&k]?F(b,k,I):(V(t,e,r,k,I,v,w,H),q(t,v,y[k],S[k],k,I));for(M[0]+M[1]==0&&t.mode==m.JOINT_STEREO&&K(y,S,b.mld_cb_s,b.ATH.cb_s,t.ATHlower*b.ATH.adjust,t.msfix,b.npart_s),k=0;k<T;++k)0==M[H=1&k]&&R(b,y[k],S[k],k,I)}for(k=0;k<T;k++){var H;if(0==M[H=1&k])for(var C=0;C<Y.SBMAX_s;C++){var N=a(3);for(I=0;I<3;I++){var z=b.thm[k].s[C][I];if(z*=.8,B[k][I]>=2||1==B[k][I+1]){var Z=0!=I?I-1:2,Q=x(b.thm[k].s[C][Z],z,.36);z=Math.min(z,Q)}else 1==B[k][I]?(Z=0!=I?I-1:2,Q=x(b.thm[k].s[C][Z],z,.18),z=Math.min(z,Q)):(0!=I&&3==B[k][I-1]||0==I&&3==b.nsPsy.lastAttacks[k])&&(Z=2!=I?I+1:0,Q=x(b.thm[k].s[C][Z],z,.18),z=Math.min(z,Q));z*=A[k][I],N[I]=z}for(I=0;I<3;I++)b.thm[k].s[C][I]=N[I]}}for(k=0;k<T;k++)b.nsPsy.lastAttacks[k]=B[k][2];for(function(t,e,r){for(var n=t.internal_flags,a=0;a<n.channels_out;a++){var s=Y.NORM_TYPE;0!=e[a]?n.blocktype_old[a]==Y.SHORT_TYPE&&(s=Y.STOP_TYPE):(s=Y.SHORT_TYPE,n.blocktype_old[a]==Y.NORM_TYPE&&(n.blocktype_old[a]=Y.START_TYPE),n.blocktype_old[a]==Y.STOP_TYPE&&(n.blocktype_old[a]=Y.SHORT_TYPE)),r[a]=n.blocktype_old[a],n.blocktype_old[a]=s}}(t,M,p),k=0;k<T;k++){var G,W,J,$;k>1?(G=u,W=-2,J=Y.NORM_TYPE,p[0]!=Y.SHORT_TYPE&&p[1]!=Y.SHORT_TYPE||(J=Y.SHORT_TYPE),$=f[o][k-2]):(G=_,W=0,J=p[k],$=l[o][k]),J==Y.SHORT_TYPE?G[W+k]=P($,b.masking_lower):G[W+k]=L($,b.masking_lower),t.analysis&&(b.pinfo.pe[o][k]=G[W+k])}return 0},this.psymodel_init=function(r){var n,s,i=r.internal_flags,o=!0,l=13,f=24,_=0,u=0,h=-8.25,m=-4.5,g=a(Y.CBANDS),w=a(Y.CBANDS),y=a(Y.CBANDS),S=r.out_samplerate;switch(r.experimentalZ){default:case 0:o=!0;break;case 1:o=r.VBR!=p.vbr_mtrh&&r.VBR!=p.vbr_mt;break;case 2:o=!1;break;case 3:l=8,_=-1.75,u=-.0125,h=-8.25,m=-2.25}for(i.ms_ener_ratio_old=.25,i.blocktype_old[0]=i.blocktype_old[1]=Y.NORM_TYPE,n=0;n<4;++n){for(var A=0;A<Y.CBANDS;++A)i.nb_1[n][A]=1e20,i.nb_2[n][A]=1e20,i.nb_s1[n][A]=i.nb_s2[n][A]=1;for(var B=0;B<Y.SBMAX_l;B++)i.en[n].l[B]=1e20,i.thm[n].l[B]=1e20;for(A=0;A<3;++A){for(B=0;B<Y.SBMAX_s;B++)i.en[n].s[B][A]=1e20,i.thm[n].s[B][A]=1e20;i.nsPsy.lastAttacks[n]=0}for(A=0;A<9;A++)i.nsPsy.last_en_subshort[n][A]=10}for(i.loudness_sq_save[0]=i.loudness_sq_save[1]=0,i.npart_l=W(i.numlines_l,i.bo_l,i.bm_l,g,w,i.mld_l,i.PSY.bo_l_weight,S,Y.BLKSIZE,i.scalefac_band.l,Y.BLKSIZE/1152,Y.SBMAX_l),n=0;n<i.npart_l;n++){var M=_;g[n]>=l&&(M=u*(g[n]-l)/(f-l)+_*(f-g[n])/(f-l)),y[n]=Math.pow(10,M/10),i.numlines_l[n]>0?i.rnumlines_l[n]=1/i.numlines_l[n]:i.rnumlines_l[n]=0}for(i.s3_ll=J(i.s3ind,i.npart_l,g,w,y,o),A=0,n=0;n<i.npart_l;n++){T=c.MAX_VALUE;for(var R=0;R<i.numlines_l[n];R++,A++){var E=S*A/(1e3*Y.BLKSIZE);x=this.ATHformula(1e3*E,r)-20,x=Math.pow(10,.1*x),T>(x*=i.numlines_l[n])&&(T=x)}i.ATH.cb_l[n]=T,(T=20*g[n]/10-20)>6&&(T=100),T<-15&&(T=-15),T-=8,i.minval_l[n]=Math.pow(10,T/10)*i.numlines_l[n]}for(i.npart_s=W(i.numlines_s,i.bo_s,i.bm_s,g,w,i.mld_s,i.PSY.bo_s_weight,S,Y.BLKSIZE_s,i.scalefac_band.s,Y.BLKSIZE_s/384,Y.SBMAX_s),A=0,n=0;n<i.npart_s;n++){var T;for(M=h,g[n]>=l&&(M=m*(g[n]-l)/(f-l)+h*(f-g[n])/(f-l)),y[n]=Math.pow(10,M/10),T=c.MAX_VALUE,R=0;R<i.numlines_s[n];R++,A++){var x;E=S*A/(1e3*Y.BLKSIZE_s),x=this.ATHformula(1e3*E,r)-20,x=Math.pow(10,.1*x),T>(x*=i.numlines_s[n])&&(T=x)}i.ATH.cb_s[n]=T,T=7*g[n]/12-7,g[n]>12&&(T*=1+3.1*Math.log(1+T)),g[n]<12&&(T*=1+2.3*Math.log(1-T)),T<-15&&(T=-15),T-=8,i.minval_s[n]=Math.pow(10,T/10)*i.numlines_s[n]}i.s3_ss=J(i.s3ind_s,i.npart_s,g,w,y,o),b=Math.pow(10,9/16),d=Math.pow(10,1.5),v=Math.pow(10,1.5),t.init_fft(i),i.decay=Math.exp(-1*e/(.01*S/192)),s=3.5,0!=(2&r.exp_nspsytune)&&(s=1),Math.abs(r.msfix)>0&&(s=r.msfix),r.msfix=s;for(var k=0;k<i.npart_l;k++)i.s3ind[k][1]>i.npart_l-1&&(i.s3ind[k][1]=i.npart_l-1);var P=576*i.mode_gr/S;if(i.ATH.decay=Math.pow(10,-1.2*P),i.ATH.adjust=.01,i.ATH.adjustLimit=1,-1!=r.ATHtype){var I=r.out_samplerate/Y.BLKSIZE,L=0;for(E=0,n=0;n<Y.BLKSIZE/2;++n)E+=I,i.ATH.eql_w[n]=1/Math.pow(10,this.ATHformula(E,r)/10),L+=i.ATH.eql_w[n];for(L=1/L,n=Y.BLKSIZE/2;--n>=0;)i.ATH.eql_w[n]*=L}for(k=A=0;k<i.npart_s;++k)for(n=0;n<i.numlines_s[k];++n)++A;for(k=A=0;k<i.npart_l;++k)for(n=0;n<i.numlines_l[k];++n)++A;for(A=0,n=0;n<i.npart_l;n++)E=S*(A+i.numlines_l[n]/2)/(1*Y.BLKSIZE),i.mld_cb_l[n]=$(E),A+=i.numlines_l[n];for(;n<Y.CBANDS;++n)i.mld_cb_l[n]=1;for(A=0,n=0;n<i.npart_s;n++)E=S*(A+i.numlines_s[n]/2)/(1*Y.BLKSIZE_s),i.mld_cb_s[n]=$(E),A+=i.numlines_s[n];for(;n<Y.CBANDS;++n)i.mld_cb_s[n]=1;return 0},this.ATHformula=function(t,e){var r;switch(e.ATHtype){case 0:r=tt(t,9);break;case 1:r=tt(t,-1);break;case 2:r=tt(t,0);break;case 3:r=tt(t,1)+6;break;case 4:r=tt(t,e.ATHcurve);break;default:r=tt(t,0)}return r}}function Z(){var t,e,r,n,s,l=this;Z.V9=410,Z.V8=420,Z.V7=430,Z.V6=440,Z.V5=450,Z.V4=460,Z.V3=470,Z.V2=480,Z.V1=490,Z.V0=500,Z.R3MIX=1e3,Z.STANDARD=1001,Z.EXTREME=1002,Z.INSANE=1003,Z.STANDARD_FAST=1004,Z.EXTREME_FAST=1005,Z.MEDIUM=1006,Z.MEDIUM_FAST=1007,Z.LAME_MAXMP3BUFFER=147456;var f,u,c,b=new K;function d(){this.mask_adjust=0,this.mask_adjust_short=0,this.bo_l_weight=a(Y.SBMAX_l),this.bo_s_weight=a(Y.SBMAX_s)}function g(){this.lowerlimit=0}function w(t,e){this.lowpass=e}this.enc=new Y,this.setModules=function(a,i,o,l,_,h,p,m,d){t=a,e=i,r=o,n=l,s=_,f=h,u=m,c=d,this.enc.setModules(e,b,n,f)};var y=4294479419;function A(t){return t>1?0:t<=0?1:Math.cos(Math.PI/2*t)}function M(t,e){switch(t){case 44100:return e.version=1,0;case 48e3:return e.version=1,1;case 32e3:return e.version=1,2;case 22050:return e.version=0,0;case 24e3:return e.version=0,1;case 16e3:return e.version=0,2;case 11025:return e.version=0,0;case 12e3:return e.version=0,1;case 8e3:return e.version=0,2;default:return e.version=0,-1}}function R(t,e,r){r<16e3&&(e=2);for(var n=B.bitrate_table[e][1],a=2;a<=14;a++)B.bitrate_table[e][a]>0&&Math.abs(B.bitrate_table[e][a]-t)<Math.abs(n-t)&&(n=B.bitrate_table[e][a]);return n}function E(t,e,r){r<16e3&&(e=2);for(var n=0;n<=14;n++)if(B.bitrate_table[e][n]>0&&B.bitrate_table[e][n]==t)return n;return-1}function I(t,e){var r=[new w(8,2e3),new w(16,3700),new w(24,3900),new w(32,5500),new w(40,7e3),new w(48,7500),new w(56,1e4),new w(64,11e3),new w(80,13500),new w(96,15100),new w(112,15600),new w(128,17e3),new w(160,17500),new w(192,18600),new w(224,19400),new w(256,19700),new w(320,20500)],n=l.nearestBitrateFullIndex(e);t.lowerlimit=r[n].lowpass}function L(t){var e=Y.BLKSIZE+t.framesize-Y.FFTOFFSET;return Math.max(e,512+t.framesize-32)}function H(t,e,r,n,a,s){var i=l.enc.lame_encode_mp3_frame(t,e,r,n,a,s);return t.frameNum++,i}function C(){this.n_in=0,this.n_out=0}function N(){this.num_used=0}function O(t,e){return 0!=e?O(e,t%e):t}function V(t,e,r){var n=Math.PI*e;(t/=r)<0&&(t=0),t>1&&(t=1);var a=t-.5,s=.42-.5*Math.cos(2*t*Math.PI)+.08*Math.cos(4*t*Math.PI);return Math.abs(a)<1e-9?n/Math.PI:s*Math.sin(r*n*a)/(Math.PI*r*a)}function D(t,e,r,n,s,i,o,l,f){var _,u,h=t.internal_flags,c=0,p=t.out_samplerate/O(t.out_samplerate,t.in_samplerate);p>X.BPC&&(p=X.BPC);var m=Math.abs(h.resample_ratio-Math.floor(.5+h.resample_ratio))<1e-4?1:0,b=1/h.resample_ratio;b>1&&(b=1);var d=31;0==d%2&&--d;var v=(d+=m)+1;if(0==h.fill_buffer_resample_init){for(h.inbuf_old[0]=a(v),h.inbuf_old[1]=a(v),_=0;_<=2*p;++_)h.blackfilt[_]=a(v);for(h.itime[0]=0,h.itime[1]=0,c=0;c<=2*p;c++){var g=0,w=(c-p)/(2*p);for(_=0;_<=d;_++)g+=h.blackfilt[c][_]=V(_-w,b,d);for(_=0;_<=d;_++)h.blackfilt[c][_]/=g}h.fill_buffer_resample_init=1}var y=h.inbuf_old[f];for(u=0;u<n;u++){var S,A;if(S=u*h.resample_ratio,d+(c=0|Math.floor(S-h.itime[f]))-d/2>=o)break;w=S-h.itime[f]-(c+d%2*.5),A=0|Math.floor(2*w*p+p+.5);var B=0;for(_=0;_<=d;++_){var M=_+c-d/2;B+=(M<0?y[v+M]:s[i+M])*h.blackfilt[A][_]}e[r+u]=B}if(l.num_used=Math.min(o,d+c-d/2),h.itime[f]+=l.num_used-u*h.resample_ratio,l.num_used>=v)for(_=0;_<v;_++)y[_]=s[i+l.num_used+_-v];else{var R=v-l.num_used;for(_=0;_<R;++_)y[_]=y[_+l.num_used];for(c=0;_<v;++_,++c)y[_]=s[i+c]}return u}function U(t,e,r,n,a,s){var i=t.internal_flags;if(i.resample_ratio<.9999||i.resample_ratio>1.0001)for(var o=0;o<i.channels_out;o++){var l=new N;s.n_out=D(t,e[o],i.mf_size,t.framesize,r[o],n,a,l,o),s.n_in=l.num_used}else{s.n_out=Math.min(t.framesize,a),s.n_in=s.n_out;for(var f=0;f<s.n_out;++f)e[0][i.mf_size+f]=r[0][n+f],2==i.channels_out&&(e[1][i.mf_size+f]=r[1][n+f])}}this.lame_init=function(){var t=new x;return 0!=function(t){var e;return t.class_id=y,e=t.internal_flags=new X,t.mode=m.NOT_SET,t.original=1,t.in_samplerate=44100,t.num_channels=2,t.num_samples=-1,t.bWriteVbrTag=!0,t.quality=-1,t.short_blocks=null,e.subblock_gain=-1,t.lowpassfreq=0,t.highpassfreq=0,t.lowpasswidth=-1,t.highpasswidth=-1,t.VBR=p.vbr_off,t.VBR_q=4,t.ATHcurve=-1,t.VBR_mean_bitrate_kbps=128,t.VBR_min_bitrate_kbps=0,t.VBR_max_bitrate_kbps=0,t.VBR_hard_min=0,e.VBR_min_bitrate=1,e.VBR_max_bitrate=13,t.quant_comp=-1,t.quant_comp_short=-1,t.msfix=-1,e.resample_ratio=1,e.OldValue[0]=180,e.OldValue[1]=180,e.CurrentStep[0]=4,e.CurrentStep[1]=4,e.masking_lower=1,e.nsPsy.attackthre=-1,e.nsPsy.attackthre_s=-1,t.scale=-1,t.athaa_type=-1,t.ATHtype=-1,t.athaa_loudapprox=-1,t.athaa_sensitivity=0,t.useTemporal=null,t.interChRatio=-1,e.mf_samples_to_encode=Y.ENCDELAY+Y.POSTDELAY,t.encoder_padding=0,e.mf_size=Y.ENCDELAY-Y.MDCTDELAY,t.findReplayGain=!1,t.decode_on_the_fly=!1,e.decode_on_the_fly=!1,e.findReplayGain=!1,e.findPeakSample=!1,e.RadioGain=0,e.AudiophileGain=0,e.noclipGainChange=0,e.noclipScale=-1,t.preset=0,t.write_id3tag_automatic=!0,0}(t)?null:(t.lame_allocated_gfp=1,t)},this.nearestBitrateFullIndex=function(t){var e=[8,16,24,32,40,48,56,64,80,96,112,128,160,192,224,256,320],r=0,n=0,a=0,s=0;s=e[16],a=16,n=e[16],r=16;for(var i=0;i<16;i++)if(Math.max(t,e[i+1])!=t){s=e[i+1],a=i+1,n=e[i],r=i;break}return s-t>t-n?r:a},this.lame_init_params=function(a){var o,l,w,x=a.internal_flags;if(x.Class_ID=0,null==x.ATH&&(x.ATH=new T),null==x.PSY&&(x.PSY=new d),null==x.rgdata&&(x.rgdata=new P),x.channels_in=a.num_channels,1==x.channels_in&&(a.mode=m.MONO),x.channels_out=a.mode==m.MONO?1:2,x.mode_ext=Y.MPG_MD_MS_LR,a.mode==m.MONO&&(a.force_ms=!1),a.VBR==p.vbr_off&&128!=a.VBR_mean_bitrate_kbps&&0==a.brate&&(a.brate=a.VBR_mean_bitrate_kbps),a.VBR==p.vbr_off||a.VBR==p.vbr_mtrh||a.VBR==p.vbr_mt||(a.free_format=!1),a.VBR==p.vbr_off&&0==a.brate&&S.EQ(a.compression_ratio,0)&&(a.compression_ratio=11.025),a.VBR==p.vbr_off&&a.compression_ratio>0&&(0==a.out_samplerate&&(a.out_samplerate=map2MP3Frequency(int(.97*a.in_samplerate))),a.brate=0|16*a.out_samplerate*x.channels_out/(1e3*a.compression_ratio),x.samplerate_index=M(a.out_samplerate,a),a.free_format||(a.brate=R(a.brate,a.version,a.out_samplerate))),0!=a.out_samplerate&&(a.out_samplerate<16e3?(a.VBR_mean_bitrate_kbps=Math.max(a.VBR_mean_bitrate_kbps,8),a.VBR_mean_bitrate_kbps=Math.min(a.VBR_mean_bitrate_kbps,64)):a.out_samplerate<32e3?(a.VBR_mean_bitrate_kbps=Math.max(a.VBR_mean_bitrate_kbps,8),a.VBR_mean_bitrate_kbps=Math.min(a.VBR_mean_bitrate_kbps,160)):(a.VBR_mean_bitrate_kbps=Math.max(a.VBR_mean_bitrate_kbps,32),a.VBR_mean_bitrate_kbps=Math.min(a.VBR_mean_bitrate_kbps,320))),0==a.lowpassfreq){var L=16e3;switch(a.VBR){case p.vbr_off:I(H=new g,a.brate),L=H.lowerlimit;break;case p.vbr_abr:var H;I(H=new g,a.VBR_mean_bitrate_kbps),L=H.lowerlimit;break;case p.vbr_rh:var C=[19500,19e3,18600,18e3,17500,16e3,15600,14900,12500,1e4,3950];if(0<=a.VBR_q&&a.VBR_q<=9){var N=C[a.VBR_q],O=C[a.VBR_q+1],V=a.VBR_q_frac;L=linear_int(N,O,V)}else L=19500;break;default:C=[19500,19e3,18500,18e3,17500,16500,15500,14500,12500,9500,3950],0<=a.VBR_q&&a.VBR_q<=9?(N=C[a.VBR_q],O=C[a.VBR_q+1],V=a.VBR_q_frac,L=linear_int(N,O,V)):L=19500}a.mode!=m.MONO||a.VBR!=p.vbr_off&&a.VBR!=p.vbr_abr||(L*=1.5),a.lowpassfreq=0|L}if(0==a.out_samplerate&&(2*a.lowpassfreq>a.in_samplerate&&(a.lowpassfreq=a.in_samplerate/2),a.out_samplerate=(o=0|a.lowpassfreq,w=44100,(l=a.in_samplerate)>=48e3?w=48e3:l>=44100?w=44100:l>=32e3?w=32e3:l>=24e3?w=24e3:l>=22050?w=22050:l>=16e3?w=16e3:l>=12e3?w=12e3:l>=11025?w=11025:l>=8e3&&(w=8e3),-1==o?w:(o<=15960&&(w=44100),o<=15250&&(w=32e3),o<=11220&&(w=24e3),o<=9970&&(w=22050),o<=7230&&(w=16e3),o<=5420&&(w=12e3),o<=4510&&(w=11025),o<=3970&&(w=8e3),l<w?l>44100?48e3:l>32e3?44100:l>24e3?32e3:l>22050?24e3:l>16e3?22050:l>12e3?16e3:l>11025?12e3:l>8e3?11025:8e3:w))),a.lowpassfreq=Math.min(20500,a.lowpassfreq),a.lowpassfreq=Math.min(a.out_samplerate/2,a.lowpassfreq),a.VBR==p.vbr_off&&(a.compression_ratio=16*a.out_samplerate*x.channels_out/(1e3*a.brate)),a.VBR==p.vbr_abr&&(a.compression_ratio=16*a.out_samplerate*x.channels_out/(1e3*a.VBR_mean_bitrate_kbps)),a.bWriteVbrTag||(a.findReplayGain=!1,a.decode_on_the_fly=!1,x.findPeakSample=!1),x.findReplayGain=a.findReplayGain,x.decode_on_the_fly=a.decode_on_the_fly,x.decode_on_the_fly&&(x.findPeakSample=!0),x.findReplayGain&&t.InitGainAnalysis(x.rgdata,a.out_samplerate)==v.INIT_GAIN_ANALYSIS_ERROR)return a.internal_flags=null,-6;switch(x.decode_on_the_fly&&!a.decode_only&&(null!=x.hip&&c.hip_decode_exit(x.hip),x.hip=c.hip_decode_init()),x.mode_gr=a.out_samplerate<=24e3?1:2,a.framesize=576*x.mode_gr,a.encoder_delay=Y.ENCDELAY,x.resample_ratio=a.in_samplerate/a.out_samplerate,a.VBR){case p.vbr_mt:case p.vbr_rh:case p.vbr_mtrh:a.compression_ratio=[5.7,6.5,7.3,8.2,10,11.9,13,14,15,16.5][a.VBR_q];break;case p.vbr_abr:a.compression_ratio=16*a.out_samplerate*x.channels_out/(1e3*a.VBR_mean_bitrate_kbps);break;default:a.compression_ratio=16*a.out_samplerate*x.channels_out/(1e3*a.brate)}if(a.mode==m.NOT_SET&&(a.mode=m.JOINT_STEREO),a.highpassfreq>0?(x.highpass1=2*a.highpassfreq,a.highpasswidth>=0?x.highpass2=2*(a.highpassfreq+a.highpasswidth):x.highpass2=2*a.highpassfreq,x.highpass1/=a.out_samplerate,x.highpass2/=a.out_samplerate):(x.highpass1=0,x.highpass2=0),a.lowpassfreq>0?(x.lowpass2=2*a.lowpassfreq,a.lowpasswidth>=0?(x.lowpass1=2*(a.lowpassfreq-a.lowpasswidth),x.lowpass1<0&&(x.lowpass1=0)):x.lowpass1=2*a.lowpassfreq,x.lowpass1/=a.out_samplerate,x.lowpass2/=a.out_samplerate):(x.lowpass1=0,x.lowpass2=0),function(t){var e=t.internal_flags,r=32,n=-1;if(e.lowpass1>0){for(var a=999,s=0;s<=31;s++)(f=s/31)>=e.lowpass2&&(r=Math.min(r,s)),e.lowpass1<f&&f<e.lowpass2&&(a=Math.min(a,s));e.lowpass1=999==a?(r-.75)/31:(a-.75)/31,e.lowpass2=r/31}if(e.highpass2>0&&e.highpass2<.75/31*.9&&(e.highpass1=0,e.highpass2=0,_.err.println("Warning: highpass filter disabled.  highpass frequency too small\n")),e.highpass2>0){var i=-1;for(s=0;s<=31;s++)(f=s/31)<=e.highpass1&&(n=Math.max(n,s)),e.highpass1<f&&f<e.highpass2&&(i=Math.max(i,s));e.highpass1=n/31,e.highpass2=-1==i?(n+.75)/31:(i+.75)/31}for(s=0;s<32;s++){var o,l,f=s/31;o=e.highpass2>e.highpass1?A((e.highpass2-f)/(e.highpass2-e.highpass1+1e-20)):1,l=e.lowpass2>e.lowpass1?A((f-e.lowpass1)/(e.lowpass2-e.lowpass1+1e-20)):1,e.amp_filter[s]=o*l}}(a),x.samplerate_index=M(a.out_samplerate,a),x.samplerate_index<0)return a.internal_flags=null,-1;if(a.VBR==p.vbr_off){if(a.free_format)x.bitrate_index=0;else if(a.brate=R(a.brate,a.version,a.out_samplerate),x.bitrate_index=E(a.brate,a.version,a.out_samplerate),x.bitrate_index<=0)return a.internal_flags=null,-1}else x.bitrate_index=1;a.analysis&&(a.bWriteVbrTag=!1),null!=x.pinfo&&(a.bWriteVbrTag=!1),e.init_bit_stream_w(x);for(var D,U=x.samplerate_index+3*a.version+6*(a.out_samplerate<16e3?1:0),F=0;F<Y.SBMAX_l+1;F++)x.scalefac_band.l[F]=n.sfBandIndex[U].l[F];for(F=0;F<Y.PSFB21+1;F++){var j=(x.scalefac_band.l[22]-x.scalefac_band.l[21])/Y.PSFB21,q=x.scalefac_band.l[21]+F*j;x.scalefac_band.psfb21[F]=q}for(x.scalefac_band.psfb21[Y.PSFB21]=576,F=0;F<Y.SBMAX_s+1;F++)x.scalefac_band.s[F]=n.sfBandIndex[U].s[F];for(F=0;F<Y.PSFB12+1;F++)j=(x.scalefac_band.s[13]-x.scalefac_band.s[12])/Y.PSFB12,q=x.scalefac_band.s[12]+F*j,x.scalefac_band.psfb12[F]=q;for(x.scalefac_band.psfb12[Y.PSFB12]=192,1==a.version?x.sideinfo_len=1==x.channels_out?21:36:x.sideinfo_len=1==x.channels_out?13:21,a.error_protection&&(x.sideinfo_len+=2),function(t){var e=t.internal_flags;t.frameNum=0,t.write_id3tag_automatic&&u.id3tag_write_v2(t),e.bitrate_stereoMode_Hist=i([16,5]),e.bitrate_blockType_Hist=i([16,6]),e.PeakSample=0,t.bWriteVbrTag&&f.InitVbrTag(t)}(a),x.Class_ID=y,D=0;D<19;D++)x.nsPsy.pefirbuf[D]=700*x.mode_gr*x.channels_out;switch(-1==a.ATHtype&&(a.ATHtype=4),a.VBR){case p.vbr_mt:a.VBR=p.vbr_mtrh;case p.vbr_mtrh:null==a.useTemporal&&(a.useTemporal=!1),r.apply_preset(a,500-10*a.VBR_q,0),a.quality<0&&(a.quality=LAME_DEFAULT_QUALITY),a.quality<5&&(a.quality=0),a.quality>5&&(a.quality=5),x.PSY.mask_adjust=a.maskingadjust,x.PSY.mask_adjust_short=a.maskingadjust_short,a.experimentalY?x.sfb21_extra=!1:x.sfb21_extra=a.out_samplerate>44e3,x.iteration_loop=new VBRNewIterationLoop(s);break;case p.vbr_rh:r.apply_preset(a,500-10*a.VBR_q,0),x.PSY.mask_adjust=a.maskingadjust,x.PSY.mask_adjust_short=a.maskingadjust_short,a.experimentalY?x.sfb21_extra=!1:x.sfb21_extra=a.out_samplerate>44e3,a.quality>6&&(a.quality=6),a.quality<0&&(a.quality=LAME_DEFAULT_QUALITY),x.iteration_loop=new VBROldIterationLoop(s);break;default:var X;x.sfb21_extra=!1,a.quality<0&&(a.quality=LAME_DEFAULT_QUALITY),(X=a.VBR)==p.vbr_off&&(a.VBR_mean_bitrate_kbps=a.brate),r.apply_preset(a,a.VBR_mean_bitrate_kbps,0),a.VBR=X,x.PSY.mask_adjust=a.maskingadjust,x.PSY.mask_adjust_short=a.maskingadjust_short,X==p.vbr_off?x.iteration_loop=new k(s):x.iteration_loop=new ABRIterationLoop(s)}if(a.VBR!=p.vbr_off){if(x.VBR_min_bitrate=1,x.VBR_max_bitrate=14,a.out_samplerate<16e3&&(x.VBR_max_bitrate=8),0!=a.VBR_min_bitrate_kbps&&(a.VBR_min_bitrate_kbps=R(a.VBR_min_bitrate_kbps,a.version,a.out_samplerate),x.VBR_min_bitrate=E(a.VBR_min_bitrate_kbps,a.version,a.out_samplerate),x.VBR_min_bitrate<0))return-1;if(0!=a.VBR_max_bitrate_kbps&&(a.VBR_max_bitrate_kbps=R(a.VBR_max_bitrate_kbps,a.version,a.out_samplerate),x.VBR_max_bitrate=E(a.VBR_max_bitrate_kbps,a.version,a.out_samplerate),x.VBR_max_bitrate<0))return-1;a.VBR_min_bitrate_kbps=B.bitrate_table[a.version][x.VBR_min_bitrate],a.VBR_max_bitrate_kbps=B.bitrate_table[a.version][x.VBR_max_bitrate],a.VBR_mean_bitrate_kbps=Math.min(B.bitrate_table[a.version][x.VBR_max_bitrate],a.VBR_mean_bitrate_kbps),a.VBR_mean_bitrate_kbps=Math.max(B.bitrate_table[a.version][x.VBR_min_bitrate],a.VBR_mean_bitrate_kbps)}return a.tune&&(x.PSY.mask_adjust+=a.tune_value_a,x.PSY.mask_adjust_short+=a.tune_value_a),function(t){var e=t.internal_flags;switch(t.quality){default:case 9:e.psymodel=0,e.noise_shaping=0,e.noise_shaping_amp=0,e.noise_shaping_stop=0,e.use_best_huffman=0,e.full_outer_loop=0;break;case 8:t.quality=7;case 7:e.psymodel=1,e.noise_shaping=0,e.noise_shaping_amp=0,e.noise_shaping_stop=0,e.use_best_huffman=0,e.full_outer_loop=0;break;case 6:case 5:e.psymodel=1,0==e.noise_shaping&&(e.noise_shaping=1),e.noise_shaping_amp=0,e.noise_shaping_stop=0,-1==e.subblock_gain&&(e.subblock_gain=1),e.use_best_huffman=0,e.full_outer_loop=0;break;case 4:e.psymodel=1,0==e.noise_shaping&&(e.noise_shaping=1),e.noise_shaping_amp=0,e.noise_shaping_stop=0,-1==e.subblock_gain&&(e.subblock_gain=1),e.use_best_huffman=1,e.full_outer_loop=0;break;case 3:e.psymodel=1,0==e.noise_shaping&&(e.noise_shaping=1),e.noise_shaping_amp=1,e.noise_shaping_stop=1,-1==e.subblock_gain&&(e.subblock_gain=1),e.use_best_huffman=1,e.full_outer_loop=0;break;case 2:e.psymodel=1,0==e.noise_shaping&&(e.noise_shaping=1),0==e.substep_shaping&&(e.substep_shaping=2),e.noise_shaping_amp=1,e.noise_shaping_stop=1,-1==e.subblock_gain&&(e.subblock_gain=1),e.use_best_huffman=1,e.full_outer_loop=0;break;case 1:case 0:e.psymodel=1,0==e.noise_shaping&&(e.noise_shaping=1),0==e.substep_shaping&&(e.substep_shaping=2),e.noise_shaping_amp=2,e.noise_shaping_stop=1,-1==e.subblock_gain&&(e.subblock_gain=1),e.use_best_huffman=1,e.full_outer_loop=0}}(a),a.athaa_type<0?x.ATH.useAdjust=3:x.ATH.useAdjust=a.athaa_type,x.ATH.aaSensitivityP=Math.pow(10,a.athaa_sensitivity/-10),null==a.short_blocks&&(a.short_blocks=h.short_block_allowed),a.short_blocks!=h.short_block_allowed||a.mode!=m.JOINT_STEREO&&a.mode!=m.STEREO||(a.short_blocks=h.short_block_coupled),a.quant_comp<0&&(a.quant_comp=1),a.quant_comp_short<0&&(a.quant_comp_short=0),a.msfix<0&&(a.msfix=0),a.exp_nspsytune=1|a.exp_nspsytune,a.internal_flags.nsPsy.attackthre<0&&(a.internal_flags.nsPsy.attackthre=K.NSATTACKTHRE),a.internal_flags.nsPsy.attackthre_s<0&&(a.internal_flags.nsPsy.attackthre_s=K.NSATTACKTHRE_S),a.scale<0&&(a.scale=1),a.ATHtype<0&&(a.ATHtype=4),a.ATHcurve<0&&(a.ATHcurve=4),a.athaa_loudapprox<0&&(a.athaa_loudapprox=2),a.interChRatio<0&&(a.interChRatio=0),null==a.useTemporal&&(a.useTemporal=!0),x.slot_lag=x.frac_SpF=0,a.VBR==p.vbr_off&&(x.slot_lag=x.frac_SpF=72e3*(a.version+1)*a.brate%a.out_samplerate|0),n.iteration_init(a),b.psymodel_init(a),0},this.lame_encode_flush=function(t,r,n,a){var s,i,l,f,_=t.internal_flags,h=o([2,1152]),c=0,p=_.mf_samples_to_encode-Y.POSTDELAY,m=L(t);if(_.mf_samples_to_encode<1)return 0;for(s=0,t.in_samplerate!=t.out_samplerate&&(p+=16*t.out_samplerate/t.in_samplerate),(l=t.framesize-p%t.framesize)<576&&(l+=t.framesize),t.encoder_padding=l,f=(p+l)/t.framesize;f>0&&c>=0;){var b=m-_.mf_size,d=t.frameNum;b*=t.in_samplerate,(b/=t.out_samplerate)>1152&&(b=1152),b<1&&(b=1),i=a-s,0==a&&(i=0),n+=c=this.lame_encode_buffer(t,h[0],h[1],b,r,n,i),s+=c,f-=d!=t.frameNum?1:0}if(_.mf_samples_to_encode=0,c<0)return c;if(i=a-s,0==a&&(i=0),e.flush_bitstream(t),(c=e.copy_buffer(_,r,n,i,1))<0)return c;if(n+=c,i=a-(s+=c),0==a&&(i=0),t.write_id3tag_automatic){if(u.id3tag_write_v1(t),(c=e.copy_buffer(_,r,n,i,0))<0)return c;s+=c}return s},this.lame_encode_buffer=function(r,n,s,i,o,l,f){var _=r.internal_flags,u=[null,null];if(_.Class_ID!=y)return-3;if(0==i)return 0;!function(t,e){(null==t.in_buffer_0||t.in_buffer_nsamples<e)&&(t.in_buffer_0=a(e),t.in_buffer_1=a(e),t.in_buffer_nsamples=e)}(_,i),u[0]=_.in_buffer_0,u[1]=_.in_buffer_1;for(var h=0;h<i;h++)u[0][h]=n[h],_.channels_in>1&&(u[1][h]=s[h]);return function(r,n,a,s,i,o,l){var f,_,u,h,c,p=r.internal_flags,m=0,b=[null,null],d=[null,null];if(p.Class_ID!=y)return-3;if(0==s)return 0;if((c=e.copy_buffer(p,i,o,l,0))<0)return c;if(o+=c,m+=c,d[0]=n,d[1]=a,S.NEQ(r.scale,0)&&S.NEQ(r.scale,1))for(_=0;_<s;++_)d[0][_]*=r.scale,2==p.channels_out&&(d[1][_]*=r.scale);if(S.NEQ(r.scale_left,0)&&S.NEQ(r.scale_left,1))for(_=0;_<s;++_)d[0][_]*=r.scale_left;if(S.NEQ(r.scale_right,0)&&S.NEQ(r.scale_right,1))for(_=0;_<s;++_)d[1][_]*=r.scale_right;if(2==r.num_channels&&1==p.channels_out)for(_=0;_<s;++_)d[0][_]=.5*(d[0][_]+d[1][_]),d[1][_]=0;h=L(r),b[0]=p.mfbuf[0],b[1]=p.mfbuf[1];for(var g=0;s>0;){var w,A,B=[null,null];B[0]=d[0],B[1]=d[1];var M=new C;if(U(r,b,B,g,s,M),w=M.n_in,A=M.n_out,p.findReplayGain&&!p.decode_on_the_fly&&t.AnalyzeSamples(p.rgdata,b[0],p.mf_size,b[1],p.mf_size,A,p.channels_out)==v.GAIN_ANALYSIS_ERROR)return-6;if(s-=w,g+=w,p.channels_out,p.mf_size+=A,p.mf_samples_to_encode<1&&(p.mf_samples_to_encode=Y.ENCDELAY+Y.POSTDELAY),p.mf_samples_to_encode+=A,p.mf_size>=h){var R=l-m;if(0==l&&(R=0),(f=H(r,b[0],b[1],i,o,R))<0)return f;for(o+=f,m+=f,p.mf_size-=r.framesize,p.mf_samples_to_encode-=r.framesize,u=0;u<p.channels_out;u++)for(_=0;_<p.mf_size;_++)b[u][_]=b[u][_+r.framesize]}}return m}(r,u[0],u[1],i,o,l,f)}}function Q(){this.setModules=function(t,e){}}function G(){this.setModules=function(t,e,r){}}function W(){}function J(){this.setModules=function(t,e){}}N.SFBMAX=3*Y.SBMAX_s,Y.ENCDELAY=576,Y.POSTDELAY=1152,Y.MDCTDELAY=48,Y.FFTOFFSET=224+Y.MDCTDELAY,Y.DECDELAY=528,Y.SBLIMIT=32,Y.CBANDS=64,Y.SBPSY_l=21,Y.SBPSY_s=12,Y.SBMAX_l=22,Y.SBMAX_s=13,Y.PSFB21=6,Y.PSFB12=6,Y.BLKSIZE=1024,Y.HBLKSIZE=Y.BLKSIZE/2+1,Y.BLKSIZE_s=256,Y.HBLKSIZE_s=Y.BLKSIZE_s/2+1,Y.NORM_TYPE=0,Y.START_TYPE=1,Y.SHORT_TYPE=2,Y.STOP_TYPE=3,Y.MPG_MD_LR_LR=0,Y.MPG_MD_LR_I=1,Y.MPG_MD_MS_LR=2,Y.MPG_MD_MS_I=3,Y.fircoef=[-.1039435,-.1892065,5*-.0432472,-.155915,3898045e-23,.0467745*5,.50455,.756825,.187098*5],X.MFSIZE=3456+Y.ENCDELAY-Y.MDCTDELAY,X.MAX_HEADER_BUF=256,X.MAX_BITS_PER_CHANNEL=4095,X.MAX_BITS_PER_GRANULE=7680,X.BPC=320,N.SFBMAX=3*Y.SBMAX_s,t.Mp3Encoder=function(t,e,n){3!=arguments.length&&(console.error("WARN: Mp3Encoder(channels, samplerate, kbps) not specified"),t=1,e=44100,n=128);var a=new Z,s=new Q,i=new v,o=new S,l=new g,f=new L,_=new O,u=new y,h=new b,c=new J,p=new w,A=new d,B=new G,M=new W;a.setModules(i,o,l,f,_,u,h,c,M),o.setModules(i,M,h,u),c.setModules(o,h),l.setModules(a),_.setModules(o,p,f,A),f.setModules(A,p,a.enc.psy),p.setModules(o),A.setModules(f),u.setModules(a,o,h),s.setModules(B,M),B.setModules(h,c,l);var R=a.lame_init();R.num_channels=t,R.in_samplerate=e,R.out_samplerate=e,R.brate=n,R.mode=m.STEREO,R.quality=3,R.bWriteVbrTag=!1,R.disable_reservoir=!0,R.write_id3tag_automatic=!1,a.lame_init_params(R);var E=1152,T=0|1.25*E+7200,x=r(T);this.encodeBuffer=function(e,n){1==t&&(n=e),e.length>E&&(E=e.length,x=r(T=0|1.25*E+7200));var s=a.lame_encode_buffer(R,e,n,e.length,x,0,T);return new Int8Array(x.subarray(0,s))},this.flush=function(){var t=a.lame_encode_flush(R,x,0,T);return new Int8Array(x.subarray(0,t))}}}t(),Recorder.lamejs=t}()},74:()=>{!function(){"use strict";var t;Recorder.prototype.enc_mp3={stable:!0,testmsg:"采样率范围48000, 44100, 32000, 24000, 22050, 16000, 12000, 11025, 8000"},Recorder.prototype.mp3=function(t,e,r){var s=this,i=s.set,o=t.length,l=s.mp3_start(i);if(l)return s.mp3_encode(l,t),void s.mp3_complete(l,e,r,1);var f=new Recorder.lamejs.Mp3Encoder(1,i.sampleRate,i.bitRate),_=[],u=0,h=0,c=function(){if(u<o)(r=f.encodeBuffer(t.subarray(u,u+57600))).length>0&&(h+=r.buffer.byteLength,_.push(r.buffer)),u+=57600,setTimeout(c);else{var r;(r=f.flush()).length>0&&(h+=r.buffer.byteLength,_.push(r.buffer));var s=n.fn(_,h,o,i.sampleRate);a(s,i),e(new Blob(_,{type:"audio/mp3"}))}};c()},Recorder.BindDestroy("mp3Worker",(function(){console.log("mp3Worker Destroy"),t&&t.terminate(),t=null})),Recorder.prototype.mp3_envCheck=function(t,e){var n="";return e.takeoffEncodeChunk&&(t.canProcess?r()||(n="当前浏览器版本太低，无法实时处理"):n=t.envName+"环境不支持实时处理"),n},Recorder.prototype.mp3_start=function(t){return r(t)};var e={id:0},r=function(r){var a=t;try{if(!a){var s=");wk_lame();var wk_ctxs={};self.onmessage="+function(t){var e=t.data,r=wk_ctxs[e.id];if("init"==e.action)wk_ctxs[e.id]={sampleRate:e.sampleRate,bitRate:e.bitRate,takeoff:e.takeoff,mp3Size:0,pcmSize:0,encArr:[],encObj:new wk_lame.Mp3Encoder(1,e.sampleRate,e.bitRate)};else if(!r)return;switch(e.action){case"stop":r.encObj=null,delete wk_ctxs[e.id];break;case"encode":r.pcmSize+=e.pcm.length,(n=r.encObj.encodeBuffer(e.pcm)).length>0&&(r.takeoff?self.postMessage({action:"takeoff",id:e.id,chunk:n}):(r.mp3Size+=n.buffer.byteLength,r.encArr.push(n.buffer)));break;case"complete":var n;(n=r.encObj.flush()).length>0&&(r.takeoff?self.postMessage({action:"takeoff",id:e.id,chunk:n}):(r.mp3Size+=n.buffer.byteLength,r.encArr.push(n.buffer)));var a=wk_mp3TrimFix.fn(r.encArr,r.mp3Size,r.pcmSize,r.sampleRate);self.postMessage({action:e.action,id:e.id,blob:new Blob(r.encArr,{type:"audio/mp3"}),meta:a})}};s+=";var wk_mp3TrimFix={rm:"+n.rm+",fn:"+n.fn+"}";var i=Recorder.lamejs.toString(),o=(window.URL||webkitURL).createObjectURL(new Blob(["var wk_lame=(",i,s],{type:"text/javascript"}));a=new Worker(o),setTimeout((function(){(window.URL||webkitURL).revokeObjectURL(o)}),1e4),a.onmessage=function(t){var r=t.data,n=e[r.id];n&&("takeoff"==r.action?n.set.takeoffEncodeChunk(new Uint8Array(r.chunk.buffer)):(n.call&&n.call(r),n.call=null))}}var l={worker:a,set:r,takeoffQueue:[]};return r?(l.id=++e.id,e[l.id]=l,a.postMessage({action:"init",id:l.id,sampleRate:r.sampleRate,bitRate:r.bitRate,takeoff:!!r.takeoffEncodeChunk,x:new Int16Array(5)})):a.postMessage({x:new Int16Array(5)}),t=a,l}catch(t){return a&&a.terminate(),console.error(t),null}};Recorder.prototype.mp3_stop=function(t){if(t&&t.worker){t.worker.postMessage({action:"stop",id:t.id}),t.worker=null,delete e[t.id];var r=-1;for(var n in e)r++;r&&console.warn("mp3 worker剩"+r+"个在串行等待")}},Recorder.prototype.mp3_encode=function(t,e){t&&t.worker&&t.worker.postMessage({action:"encode",id:t.id,pcm:e})},Recorder.prototype.mp3_complete=function(t,e,r,n){var s=this;t&&t.worker?(t.call=function(r){a(r.meta,t.set),e(r.blob),n&&s.mp3_stop(t)},t.worker.postMessage({action:"complete",id:t.id})):r("mp3编码器未打开")},Recorder.mp3ReadMeta=function(t,e){var r="object"==typeof window?window.parseInt:self.parseInt,n=new Uint8Array(t[0]||[]);if(n.length<4)return null;var a=function(t,e){return("0000000"+((e||n)[t]||0).toString(2)).substr(-8)},s=a(0)+a(1),i=a(2)+a(3);if(!/^1{11}/.test(s))return null;var o={"00":2.5,10:2,11:1}[s.substr(11,2)],l={"01":3}[s.substr(13,2)],f={1:[44100,48e3,32e3],2:[22050,24e3,16e3],2.5:[11025,12e3,8e3]}[o];f&&(f=f[r(i.substr(4,2),2)]);var _=[[0,8,16,24,32,40,48,56,64,80,96,112,128,144,160],[0,32,40,48,56,64,80,96,112,128,160,192,224,256,320]][1==o?1:0][r(i.substr(0,4),2)];if(!(o&&l&&_&&f))return null;for(var u=Math.round(8*e/_),h=1==l?384:2==l||1==o?1152:576,c=h/f*1e3,p=Math.floor(h*_/8/f*1e3),m=0,b=0,d=0;d<t.length;d++){var v=t[d];if((b+=v.byteLength)>=p+3){var g=new Uint8Array(v);m="1"==a(v.byteLength-(b-(p+3)+1),g).charAt(6);break}}return m&&p++,{version:o,layer:l,sampleRate:f,bitRate:_,duration:u,size:e,hasPadding:m,frameSize:p,frameDurationFloat:c}};var n={rm:Recorder.mp3ReadMeta,fn:function(t,e,r,n){var a=this.rm(t,e);if(!a)return{err:"mp3非预定格式"};var s=Math.round(r/n*1e3),i=Math.floor((a.duration-s)/a.frameDurationFloat);if(i>0){var o=i*a.frameSize-(a.hasPadding?1:0);e-=o;for(var l=0,f=[],_=0;_<t.length;_++){var u=t[_];if(o<=0)break;o>=u.byteLength?(o-=u.byteLength,f.push(u),t.splice(_,1),_--):(t[_]=u.slice(o),l=u,o=0)}if(!this.rm(t,e)){for(l&&(t[0]=l),_=0;_<f.length;_++)t.splice(_,0,f[_]);a.err="fix后数据错误，已还原，错误原因不明"}var h=a.trimFix={};h.remove=i,h.removeDuration=Math.round(i*a.frameDurationFloat),h.duration=Math.round(8*e/a.bitRate)}return a}},a=function(t,e){var r="MP3信息 ";(t.sampleRate&&t.sampleRate!=e.sampleRate||t.bitRate&&t.bitRate!=e.bitRate)&&(console.warn(r+"和设置的不匹配set:"+e.bitRate+"kbps "+e.sampleRate+"hz，已更新set:"+t.bitRate+"kbps "+t.sampleRate+"hz",e),e.sampleRate=t.sampleRate,e.bitRate=t.bitRate);var n=t.trimFix;n?(r+="Fix移除"+n.remove+"帧"+n.removeDuration+"ms -> "+n.duration+"ms",n.remove>2&&(t.err=(t.err?t.err+", ":"")+"移除帧数过多")):r+=(t.duration||"-")+"ms",t.err?console.error(r,t.err,t):console.log(r,t)}}()},584:(t,e,r)=>{var n;!function(t){"use strict";var e=function(){},r=function(t){return new i(t)};r.IsOpen=function(){var t=r.Stream;if(t){var e=(t.getTracks&&t.getTracks()||t.audioTracks||[])[0];if(e){var n=e.readyState;return"live"==n||n==e.LIVE}}return!1},r.BufferSize=4096,r.Destroy=function(){for(var t in a("Recorder Destroy"),n)n[t]()};var n={};r.BindDestroy=function(t,e){n[t]=e},r.Support=function(){var e=t.AudioContext;if(e||(e=t.webkitAudioContext),!e)return!1;var n=navigator.mediaDevices||{};return n.getUserMedia||(n=navigator).getUserMedia||(n.getUserMedia=n.webkitGetUserMedia||n.mozGetUserMedia||n.msGetUserMedia),!!n.getUserMedia&&(r.Scope=n,r.Ctx&&"closed"!=r.Ctx.state||(r.Ctx=new e,r.BindDestroy("Ctx",(function(){var t=r.Ctx;t&&t.close&&t.close()}))),!0)};r.SampleData=function(t,e,r,n,a){n||(n={});var s=n.index||0,i=n.offset||0,o=n.frameNext||[];a||(a={});var l=a.frameSize||1;a.frameType&&(l="mp3"==a.frameType?1152:1);for(var f=0,_=s;_<t.length;_++)f+=t[_].length;f=Math.max(0,f-Math.floor(i));var u=e/r;u>1?f=Math.floor(f/u):(u=1,r=e),f+=o.length;var h=new Int16Array(f),c=0;for(_=0;_<o.length;_++)h[c]=o[_],c++;for(var p=t.length;s<p;s++){for(var m=t[s],b=(_=i,m.length);_<b;){var d=Math.floor(_),v=Math.ceil(_),g=_-d,w=m[d],y=v<b?m[v]:(t[s+1]||[w])[0]||0;h[c]=w+(y-w)*g,c++,_+=u}i=_-b}o=null;var S=h.length%l;if(S>0){var A=2*(h.length-S);o=new Int16Array(h.buffer.slice(A)),h=new Int16Array(h.buffer.slice(0,A))}return{index:s,offset:i,frameNext:o,sampleRate:r,data:h}},r.PowerLevel=function(t,e){var r=t/e||0;return r<1251?Math.round(r/1250*10):Math.round(Math.min(100,Math.max(0,100*(1+Math.log(r/1e4)/Math.log(10)))))};var a=function(t,e){var r=new Date,n=["["+("0"+r.getMinutes()).substr(-2)+":"+("0"+r.getSeconds()).substr(-2)+"."+("00"+r.getMilliseconds()).substr(-3)+" Recorder]"+t],a=arguments,s=2,i=console.log;for("number"==typeof e?i=1==e?console.error:3==e?console.warn:i:s=1;s<a.length;s++)n.push(a[s]);i.apply(console,n)};r.CLog=a;var s=0;function i(t){this.id=++s,r.Traffic&&r.Traffic();var n={type:"mp3",bitRate:16,sampleRate:16e3,onProcess:e};for(var a in t)n[a]=t[a];this.set=n,this._S=9}r.Sync={O:9,C:9},r.prototype=i.prototype={open:function(n,s){var i=this;n=n||e;var o=function(t,e){a("录音open失败："+t+",isUserNotAllow:"+(e=!!e),1),s&&s(t,e)},l=function(){a("open成功"),n(),i._SO=0},f=function(e,r){try{t.top.a}catch(t){return void o('无权录音(跨域，请尝试给iframe添加麦克风访问策略，如allow="camera;microphone")')}/Permission|Allow/i.test(e)?o("用户拒绝了录音权限",!0):!1===t.isSecureContext?o("无权录音(需https)"):/Found/i.test(e)?o(r+"，无可用麦克风"):o(r)},_=r.Sync,u=++_.O,h=_.C;i._O=i._O_=u,i._SO=i._S;var c=function(){if(h!=_.C||!i._O){var t="open被取消";return u==_.O?i.close():t="open被中断",o(t),!0}};if(r.IsOpen())l();else if(r.Support()){var p=i.envCheck({envName:"H5",canProcess:!0});if(p)o("不能录音："+p);else{var m=function(t){r.Stream=t,t._call={},c()||setTimeout((function(){c()||(r.IsOpen()?(function(){var t=r.Ctx,e=r.Stream,n=e._m=t.createMediaStreamSource(e),a=e._p=(t.createScriptProcessor||t.createJavaScriptNode).call(t,r.BufferSize,1,1);n.connect(a),a.connect(t.destination);var s=e._call;a.onaudioprocess=function(t){for(var e in s){for(var r=t.inputBuffer.getChannelData(0),n=r.length,a=new Int16Array(n),i=0,o=0;o<n;o++){var l=Math.max(-1,Math.min(1,r[o]));l=l<0?32768*l:32767*l,a[o]=l,i+=Math.abs(l)}for(var f in s)s[f](a,i);return}}}(),l()):o("录音功能无效：无音频流"))}),100)},b=function(t){var e=t.name||t.message||t.code+":"+t;a("请求录音权限错误",1,t),f(e,"无法录音："+e)},d=r.Scope.getUserMedia({audio:!0},m,b);d&&d.then&&d.then(m)[n&&"catch"](b)}}else f("","此浏览器不支持录音")},close:function(t){t=t||e;var n=this;n._stop();var s=r.Sync;if(n._O=0,n._O_!=s.O)return a("close被忽略",3),void t();s.C++;var i=r.Stream;if(i){!function(){var t=r.Stream;t._m&&(t._m.disconnect(),t._p.disconnect(),t._p.onaudioprocess=t._p=t._m=null)}();for(var o=i.getTracks&&i.getTracks()||i.audioTracks||[],l=0;l<o.length;l++){var f=o[l];f.stop&&f.stop()}i.stop&&i.stop()}r.Stream=0,a("close"),t()},mock:function(t,e){var r=this;return r._stop(),r.isMock=1,r.mockEnvInfo=null,r.buffers=[t],r.recSize=t.length,r.srcSampleRate=e,r},envCheck:function(t){var e,r=this,n=r.set;return e||(r[n.type+"_envCheck"]?e=r[n.type+"_envCheck"](t,n):n.takeoffEncodeChunk&&(e=n.type+"类型不支持设置takeoffEncodeChunk")),e||""},envStart:function(t,e){var r=this,n=r.set;if(r.isMock=t?1:0,r.mockEnvInfo=t,r.buffers=[],r.recSize=0,r.envInLast=0,r.envInFirst=0,r.envInFix=0,r.envInFixTs=[],n.sampleRate=Math.min(e,n.sampleRate),r.srcSampleRate=e,r.engineCtx=0,r[n.type+"_start"]){var a=r.engineCtx=r[n.type+"_start"](n);a&&(a.pcmDatas=[],a.pcmSize=0)}},envResume:function(){this.envInFixTs=[]},envIn:function(t,e){var n=this,s=n.set,i=n.engineCtx,o=n.srcSampleRate,l=t.length,f=r.PowerLevel(e,l),_=n.buffers,u=_.length;_.push(t);var h=_,c=u,p=Date.now(),m=Math.round(l/o*1e3);n.envInLast=p,1==n.buffers.length&&(n.envInFirst=p-m);var b=n.envInFixTs;b.splice(0,0,{t:p,d:m});for(var d=p,v=0,g=0;g<b.length;g++){var w=b[g];if(p-w.t>3e3){b.length=g;break}d=w.t,v+=w.d}var y=b[1],S=p-d;if(S-v>S/3&&(y&&S>1e3||b.length>=6)){var A=p-y.t-m;if(A>m/5){var B=!s.disableEnvInFix;if(a("["+p+"]"+(B?"":"未")+"补偿"+A+"ms",3),n.envInFix+=A,B){var M=new Int16Array(A*o/1e3);l+=M.length,_.push(M)}}}var R=n.recSize,E=l,T=R+E;if(n.recSize=T,i){var x=r.SampleData(_,o,s.sampleRate,i.chunkInfo);i.chunkInfo=x,T=(R=i.pcmSize)+(E=x.data.length),i.pcmSize=T,_=i.pcmDatas,u=_.length,_.push(x.data),o=x.sampleRate}var k=Math.round(T/o*1e3),P=_.length,I=h.length,L=function(){for(var t=H?0:-E,e=null==_[0],r=u;r<P;r++){var a=_[r];null==a?e=1:(t+=a.length,i&&a.length&&n[s.type+"_encode"](i,a))}if(e&&i)for(r=c,h[0]&&(r=0);r<I;r++)h[r]=null;e&&(t=H?E:0,_[0]=null),i?i.pcmSize+=t:n.recSize+=t},H=s.onProcess(_,f,k,o,u,L);if(!0===H){var C=0;for(g=u;g<P;g++)null==_[g]?C=1:_[g]=new Int16Array(0);C?a("未进入异步前不能清除buffers",3):i?i.pcmSize-=E:n.recSize-=E}else L()},start:function(){if(r.IsOpen()){a("开始录音");var t=this,e=(t.set,r.Ctx);if(t._stop(),t.state=0,t.envStart(null,e.sampleRate),t._SO&&t._SO+1!=t._S)a("start被中断",3);else{t._SO=0;var n=function(){t.state=1,t.resume()};"suspended"==e.state?e.resume().then((function(){a("ctx resume"),n()})):n()}}else a("未open",1)},pause:function(){var t=this;t.state&&(t.state=2,a("pause"),delete r.Stream._call[t.id])},resume:function(){var t=this;t.state&&(t.state=1,a("resume"),t.envResume(),r.Stream._call[t.id]=function(e,r){1==t.state&&t.envIn(e,r)})},_stop:function(t){var e=this,r=e.set;e.isMock||e._S++,e.state&&(e.pause(),e.state=0),!t&&e[r.type+"_stop"]&&(e[r.type+"_stop"](e.engineCtx),e.engineCtx=0)},stop:function(t,e,n){var s,i=this,o=i.set;a("Stop "+(i.envInLast?i.envInLast-i.envInFirst+"ms 补"+i.envInFix+"ms":"-"));var l=function(){i._stop(),n&&i.close()},f=function(t){a("结束录音失败："+t,1),e&&e(t),l()},_=function(e,r){if(a("结束录音 编码"+(Date.now()-s)+"ms 音频"+r+"ms/"+e.size+"b"),o.takeoffEncodeChunk)a("启用takeoffEncodeChunk后stop返回的blob长度为0不提供音频数据",3);else if(e.size<Math.max(100,r/2))return void f("生成的"+o.type+"无效");t&&t(e,r),l()};if(!i.isMock){if(!i.state)return void f("未开始录音");i._stop(!0)}var u=i.recSize;if(u)if(i.buffers[0])if(i[o.type]){if(i.isMock){var h=i.envCheck(i.mockEnvInfo||{envName:"mock",canProcess:!1});if(h)return void f("录音错误："+h)}var c=i.engineCtx;if(i[o.type+"_complete"]&&c){var p=Math.round(c.pcmSize/o.sampleRate*1e3);return s=Date.now(),void i[o.type+"_complete"](c,(function(t){_(t,p)}),f)}s=Date.now();var m=r.SampleData(i.buffers,i.srcSampleRate,o.sampleRate);o.sampleRate=m.sampleRate;var b=m.data;p=Math.round(b.length/o.sampleRate*1e3),a("采样"+u+"->"+b.length+" 花:"+(Date.now()-s)+"ms"),setTimeout((function(){s=Date.now(),i[o.type](b,(function(t){_(t,p)}),(function(t){f(t)}))}))}else f("未加载"+o.type+"编码器");else f("音频被释放");else f("未采集到录音")}},t.Recorder&&t.Recorder.Destroy(),t.Recorder=r,r.LM="2020-11-15 21:36:11",r.TrafficImgUrl="//ia.51.la/go1?id=20469973&pvFlag=1",r.Traffic=function(){var t=r.TrafficImgUrl;if(t){var e=r.Traffic,n=location.href.replace(/#.*/,"");0==t.indexOf("//")&&(t=/^https:/i.test(n)?"https:"+t:"http:"+t),e[n]||(e[n]=1,(new Image).src=t,a("Traffic Analysis Image: Recorder.TrafficImgUrl="+r.TrafficImgUrl))}}}(window),void 0===(n=function(){return Recorder}.call(e,r,e,t))||(t.exports=n),t.exports&&(t.exports=Recorder)},970:(t,e,r)=>{"use strict";r.r(e),r.d(e,{audioRecorder:()=>s,regShakenEvent:()=>m,share:()=>l});var n=r(584),a=r.n(n);r(74),r(129);const s={_rec:null,_open(){return this._rec=new(a())({type:"mp3"}),new Promise(((t,e)=>{this._rec.open((()=>{t()}),(()=>{e(new Error("音频不可用"))}))}))},async start(){this._recording||(await this._open(),this._recording=!0,this._rec.start())},stop(){return new Promise(((t,e)=>{this._rec?this._rec.stop((e=>{this._rec.close(),this._rec=null,t(e),this._recording=!1}),(t=>{this._rec.close(),this._rec=null,e(t),this._recording=!1})):e(new Error("无录制的音频"))}))},async stopAndUpload(t,e={}){const r=await this.stop(),n=new FormData;return n.append("record",r,"record.mp3"),Object.entries(e).forEach((([t,e])=>{n.append(t,e)})),await fetch(t,{method:"POST",body:n}).then((t=>t.json()))}};var i=r(592);async function o(t,e,r,n,a,s){return new Promise((i=>{const o=new Image;o.onload=function(){t.drawImage(o,r,n,a,s),i()},o.src=e}))}const l={async createImg(t,e,r){const n=document.createElement("canvas");n.width=750,n.height=1334;const a=n.getContext("2d");var s;return a.rect(0,0,n.width,n.height),a.fillStyle="#fff",a.fill(),await o(a,t,0,0,n.width,n.height),a.shadowOffsetX=0,a.shadowOffsetY=0,a.shadowColor="rgba(0,0,0,0.5)",a.shadowBlur=10,await o(a,await(s=e,i.hz(s,{margin:2})),225,645,300,300),a.textAlign="center",a.font="30px Courier New",a.fillText(`来自「${r}」的祝福`,375,1180),a.font="60px Courier New",a.fillText("长按识别二维码",375,1260),n.toDataURL("image/png")},copyImage:async function(t){const e=await function(t){const e=t.src;return t=new Image,new Promise((r=>{t.onload=function(){var e=document.createElement("canvas");e.width=t.width,e.height=t.height,e.getContext("2d").drawImage(t,0,0,t.width,t.height);var n=e.toDataURL("image/png");r(function(t){for(var e=t.split(","),r=e[0].match(/:(.*?);/)[1],n=atob(e[1]),a=n.length,s=new Uint8Array(a);a--;)s[a]=n.charCodeAt(a);return new Blob([s],{type:r})}(n))},t.src=e}))}(t),r=new ClipboardItem({"image/png":e});await navigator.clipboard.write([r])}},f=new Event("shaken");let _=!1,u=Date.now(),h=null;function c(t){const e=_;_=t,!e&&_&&window.dispatchEvent(f)}function p(t){const e=t.acceleration;Math.abs(e.x)+Math.abs(e.y)+Math.abs(e.z)>=20?(u=Date.now(),h||(h=u),u-h>=300&&c(!0)):Date.now()-u>=50&&(c(!1),h=null)}function m(){return new Promise(((t,e)=>{DeviceMotionEvent.requestPermission?DeviceMotionEvent.requestPermission().then((function(r){"granted"===r?(window.addEventListener("devicemotion",p),t()):e(new Error("用户拒绝了权限申请"))})).catch((function(t){e(t)})):(window.addEventListener("devicemotion",p),t())}))}}},e={};function r(n){if(e[n])return e[n].exports;var a=e[n]={exports:{}};return t[n](a,a.exports,r),a.exports}return r.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return r.d(e,{a:e}),e},r.d=(t,e)=>{for(var n in e)r.o(e,n)&&!r.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},r.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),r.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r(970)})();
//# sourceMappingURL=utils.min.js.map